<div style="line-height:40px;">
	<center style="font-size:36px;font-weight:bold;">标准电子合同接口文档</center>
	<center style="font-size:18px;font-weight:bold;">版本：V4.7.0.0</center>
</div>
























| 日期       | 修订者       | 版本   | 备注2                                                        |
| ---------- | ------------ | ------ | ------------------------------------------------------------ |
| 2020-07-06 | 黄祖清       | V2.2.0 | 初始文档                                                     |
| 2020-07-20 | 韩延辉       | V2.2.0 | 修改版                                                       |
| 2020-08-14 | 黄祖清       | V2.5.0 | 修改版                                                       |
| 2020-08-26 | 黄祖清       | V3.0.0 | 修改版                                                       |
| 2020-09-10 | 黄祖清       | V3.1.0 | 1、签署接口：新增文本字体属性参数                            |
| 2020-10-19 | 黄祖清       | V3.2.0 | 1、修改用户相关接口<br>2、新增模板相关接口                   |
| 2020-11-20 | 黄祖清       | V3.2.0 | 修改文档结构序号、完善文档                                   |
| 2020-12-03 | 孟令乐、刘羽 | v3.2.2 | 1、新增 四十四 取证报告申请接口<br>2、新增 四十六 获取取证报告接口<br>3、新增 四十八 快捷签署接口<br>4、新增 四十九 快捷签署回调 |
| 2020-12-11 | 孟令乐       | v3.2.2 | 1、二十九 新增 入参                                          |
| 2020-12-28 | 黄祖清       | v3.3.0 | 1、十二、十三接口上传文件格式支持pdf、doc、docx<br>2、三十四、三十五接口上传文件格式支持pdf、doc、docx<br/>3、三十四接口新增htmlBase64入参 |
| 2021-01-06 | 黄祖清       | V3.3.0 | 1、修改 “四十获取模板详情接口” 返回参数                      |
| 2021-03-08 | 黄祖清       | v3.3.3 | 1、创建外部企业接口（六），支持实名方为天威实名认证；<br>2、合同详情查询接口（二十八），返回数据新增合同原文； |
| 2021-04-09 | 黄祖清       | v4.0.0 | 合同接口，根据业务类型策略配置，生成合同名称、<br>合同编号、合同有效期、水印开发设置等参数； |
| 2021-05-11 | 黄祖清       | v4.0.1 | 新增 五十、上传文件合同-页面签接口；                         |
| 2021-07-13 | 朴建伟       | v4.2.1 | 新增fastSign快捷签接口                                       |
| 2021-08-03 | 朴建伟       | v4.2.1 | 新增签名、印章列表查询接口                                   |
| 2021-08-13 | 朴建伟       | v4.3.2 | 新增添加子企业接口                                           |
| 2021-08-20 | 黄祖清       | v4.5.0 | 新增查询证书接口、UKey证书绑定查询接口                       |
| 2021-11-10 | 王小波       | v4.7.0 | 1.创建企业印章接口（九），增加OFD印章创建<br>2.上传文件创建合同（十二），增加OFD文件创建合同<br>3.创建合同模板（三十四），增加OFD文件创建模板<br>4.快捷签同步（五十八），增加OFD文件创建<br>5.快捷签异步（四十八），增加OFD文件创建<br>6.创建个人人名章（十），增加OFD文件创建 |

# 一、调用方法



## 1.1 文档概述

前提条件：第三方应用在天威诚信电子认证云服务平台（简称天威云）进行应用注册，获得应用标识和应用密钥。

异常相应结果参数及格式如下：

Ø  status：状态码，1表示成功； 其它表示失败；

Ø  message：对调用失败原因的描述；



## 1.2 通用约束

Ø  所有请求内容类型默认使用application/json，若类型为其它会单独做出说明；

Ø  所有涉及到编码的环节一律采用UTF-8（例如URLEncoding、String转byte[]等）；

Ø  当接口参数为二进制字节数组时，一律Base64编码后再传递；



## 1.3 安全性设计

通讯安全：

Ø  采用SSL安全连接，防止信息篡改、中间人窃听和重放攻击；

访问安全：

Ø  请求中请求方必须带Content-Signature签名值，签名的内容为请求参数，签名密钥为应用密钥，确保信息的不被篡改。



## 1.4 通用请求头

| 请求头            | 参数类型 | 必填 | 参数描述                     |
| ----------------- | -------- | ---- | ---------------------------- |
| appId             | String   | 必填 | 应用标识(对应当前内部总公司) |
| serviceCode       | String   | 必填 | 产品编码：contract003        |
| Content-Signature | String   | 必填 | 请求签名值                   |



## 1.5 通用响应码 

| 编号 | 描述                   |
| ---- | ---------------------- |
| 1    | 操作成功               |
| 201  | 操作失败               |
| 400  | 参数格式解析失败       |
| 401  | 访问权限不足           |
| 403  | 禁止访问，没有访问权限 |
| 404  | URL错误，资源找不到    |
| 405  | 请求方法不支持         |
| 500  | 系统错误               |



# 二、创建用户

## 2.1 接口地址

http://localhost:8080/apigate/contractapi/user/create

## 2.2 请求参数

### 2.2.1 请求方法

POST

### 2.2.2 请求体

| 名称           | 类型    | 约束 | 描述                                                         |
| -------------- | ------- | ---- | ------------------------------------------------------------ |
| userLable      | String  | 选填 | 用户标签(需在电子合同web页面配置)                            |
| phone          | String  | 选填 | 手机号(手机号与账号二选一)                                   |
| account        | String  | 选填 | 账号  长度1-64位(手机号与账号二选一)                         |
| type           | Integer | 选填 | 账号类型：1手机号（默认），2账号                             |
| passwd         | String  | 选填 | 用户密码                                                     |
| email          | String  | 选填 | 邮箱                                                         |
| authentication | Boolean | 必填 | 实名认证来源(客户认证true,天威认证false)<br/> (当需要天威认证时需走实名认证才会是已认证状态) |
| displayName    | String  | 选填 | 用户名称，用户名称长度需要在1-16之间<br/>当authentication为true时，为必填 |
| idCardNum      | String  | 选填 | 证件号码 <br>当authentication为true时，idCardNum为必填       |
| idCardType     | String  | 选填 | 证件类型（当输入idcardNum，此项必填）<br/>当authentication为true时支持多种证件类型，参考附录44.1<br/>当authentication 为false时只支持身份证号 |
| extendData     | String  | 选填 | 扩展数据，数据格式为json字符串（key/value形式）例如：{"name":"张三"} |

请求实例：

```json
{	
    "phone": "17649810177",
	"displayName": "张三",
    "passwd":"123456",
    "authentication": true,
	"email": "124994460@qq.com",
	"idCardNum": "3223465476576589879",
	"idCardType": "0"	
}


```



## 2.3 返回结果

### 2.3.1 正确响应

| 名称     | 类型    | 描述                                                     |
| -------- | ------- | -------------------------------------------------------- |
| userId   | String  | 平台用户id                                               |
| certId   | Long    | 证书id(需申请证书时返回)                                 |
| certCode | Integer | 证书code(需申请证书时返回，200：申请成功、1000申请失败 ) |

返回实例：

```json
{
	"status":1,
	"data":{
		"userId":"1040",
        "certId":123456789,
        "certCode":200
	},
	"message":"请求成功",
	"ok":true
}
```

### 2.3.2 错误响应

```json
{
	"status":1000,
	"data":{
		
	},
	"message":"证件类型非法，目前只支持身份证",Disconnected from the target VM, address: '127.0.0.1:54499', transport: 'socket'
	"ok":false
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述


## 2.4 响应码

| 编号 | 描述                   |
| ---- | ---------------------- |
| 1    | 成功                   |
| 500  | 系统错误，请联系管理员 |
| 1000 | 参数为空或不满足规则   |
| 1001 | 用户标签不匹配         |
| 1002 | 企业未配置用户证书RA   |
| 5000 | 非法请求               |

# 三、更新用户

## 3.1 接口地址

http://localhost:8080/apigate/contractapi/user/update

## 3.2 请求参数

### 3.2.1 请求方法

POST

### 3.2.2 请求体

| 名称        | 类型   | 约束 | 描述                                                         |
| ----------- | ------ | ---- | ------------------------------------------------------------ |
| userId      | String | 必填 | 用户id                                                       |
| userLable   | String | 选填 | 用户标签(需在电子合同web页面配置)                            |
| phone       | String | 选填 | 手机号，当authentication为false时，天威实名（修改需重新实名） |
| account     | String | 选填 | 账号 (长度1-64位)                                            |
| passwd      | String | 选填 | 用户密码                                                     |
| email       | String | 选填 | 邮箱                                                         |
| displayName | String | 选填 | 用户名称，用户名称长度需要在1-16之间<br/>当authentication为false时,天威实名（修改需重新实名,签名和证书变为无效） |
| extendData  | String | 选填 | 扩展数据，数据格式为json（key/value形式）例如：{"name":"张三"} |

请求实例：

```json
{	
    "phone": "17649810177",
	"displayName": "张三",
    "passWd":"123456",
    "authentication": true,
	"email": "124994460@qq.com",
	"idCardNum": "3223465476576589879",
	"idCardType": "0"	
}


```



## 3.3 返回结果

### 3.3.1 正确响应

| 名称   | 类型   | 描述       |
| ------ | ------ | ---------- |
| userId | String | 平台用户id |

返回实例：

```json
{
	"status":1,
	"data":{
		"userId":"1040"
	},
	"message":"请求成功",
	"ok":true
}
```

### 3.3.2 错误响应

```json
{
	"status":1000,
	"data":{
		
	},
	"message":"证件类型非法，目前只支持身份证",Disconnected from the target VM, address: '127.0.0.1:54499', transport: 'socket'
	"ok":false
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述


## 3.4 响应码

| 编号 | 描述                   |
| ---- | ---------------------- |
| 1    | 成功                   |
| 500  | 系统错误，请联系管理员 |
| 1000 | 参数为空或不满足规则   |
| 5000 | 非法请求               |



# 四、用户实名认证

## 4.1 接口地址

http://localhost:8080/apigate/contractapi/user/realName

##  4.2 请求参数

###  4.2.1 请求方法

POST

### 4.2.2 请求体

| 名称         | 类型    | 约束 | 描述                                                         |
| ------------ | ------- | ---- | ------------------------------------------------------------ |
| userId       | String  | 必填 | 用户唯一标识                                                 |
| displayName  | String  | 必填 | 用户名称，用户名称长度需要在1-16之间                         |
| idCardNum    | String  | 必填 | 证件号码                                                     |
| idCardType   | String  | 必填 | 证件类型，只支持身份证类型0                                  |
| bankCard     | String  | 选填 | 银行卡号                                                     |
| realNameType | Integer | 选填 | 实名认证类型1.手机号三要素，3.银行卡四要素<br/> 默认手机号三要素 |
| codeNumber   | String  | 必选 | 验证码流水号                                                 |
| verifyCode   | String  | 必选 | 验证码                                                       |

实例：

```json
{
    "userId":"123",
    "displayName":"温温",
    "idCardNum":"11222",
    "idCardType":"0",
    "codeNumber":"657681",
    "verifyCode": "453456"
}
```



## 4.3 返回结果

### 4.3.1 正确响应

| 名称        | 类型   | 描述           |
| ----------- | ------ | -------------- |
| orderNumber | String | 实名认证流水号 |

### 4.3.2 错误响应

```json
{
    "code": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述


## 4.4 响应码

| 编号 | 描述                         |
| ---- | ---------------------------- |
| 1    | 成功                         |
| 500  | 系统错误，请联系管理员       |
| 1000 | 参数为空或不满足规则         |
| 1003 | 该用户已实名，无需再次实名   |
| 1004 | 验证码不正确或已失效         |
| 1005 | 三要素或四要素实名配置未配置 |
| 5000 | 非法请求                     |

# 五、申请证书

## 5.1 接口地址

http://localhost:8080/apigate/contractapi/user/applyCert

## 5.2 请求参数

### 5.2.1 请求方法

POST

### 5.2.2 请求体

| 名称         | 类型   | 约束 | 描述                                                         |
| ------------ | ------ | ---- | ------------------------------------------------------------ |
| userId       | String | 必填 | 用户唯一标识<br/>（注：用户必须实名才能申请证书）            |
| certType     | String | 必填 | 证书认证类型(1:个人证书 2:企业证书)                          |
| enterpriseId | String | 选填 | 企业id<br/>   (注：当certType为企业类型，enterpriseId为空时默认本企业) |

请求实例：

```
{
    "userId": "1100",
    "certType": "2",
    "enterpriseId": "1100"
}
```

## 5.3 返回结果

### 5.3.1 正确响应

| 名称        | 类型   | 描述     |
| ----------- | ------ | -------- |
| certId      | Long   | 证书id   |
| expiredTime | String | 到期时间 |

返回实例

```
{

  "status": 1,
  "data": {
        "certId":1234567890,
		"expiredTime": "2020-12-12 12:59:59"
  },

  "message": "成功"

}
```

### 5.3.2 错误响应

```
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

## 5.4 响应码

| 编号 | 描述                   |
| ---- | ---------------------- |
| 1    | 成功                   |
| 1000 | 参数为空或不满足规则   |
| 1002 | 企业未配置用户证书RA   |
| 1006 | 未配置长期证书不可申请 |
| 1007 | 用户未实名             |
| 1008 | 企业不是已实名状态     |
| 1009 | 用户或企业已存在证书   |

# 六、创建外部企业

### 6.1 接口地址

http://localhost:8080/apigate/contractapi/enterprise/create

### 6.2 请求参数

#### 6.2.1 请求方法

POST

#### 6.2.2 请求体

| 名称            | 类型    | 约束 | 描述                                                         |
| --------------- | ------- | ---- | ------------------------------------------------------------ |
| userId          | String  | 必填 | 用户唯一标识<br>（注：创建企业必须优先创建用户且用户必须实名） |
| enterpriseLable | String  | 选填 | 企业标签(有值时校验企业标签)                                 |
| orgName         | String  | 必填 | 企业全称（1-32位字符）                                       |
| enterpriseType  | String  | 选填 | 企业类型：ET_PE:企业 (默认),  ET_SE:个体工商户,  <br/>OU:政府机构/事业单位 |
| idType          | String  | 必填 | 证件类型（"N"，社会统一信用代码（支持多种））                |
| orgCode         | String  | 必填 | 证件号（1-32）                                               |
| authentication  | Boolean | 必填 | 实名认证来源(客户认证true，天威电子合同系统认证false)        |
| legalName       | String  | 选填 | 法定代表人姓名,(1-16位长度)                                  |
| legalPhone      | String  | 选填 | 法定代表人手机号                                             |
| legalIdCard     | String  | 选填 | 法定代表人证件号（身份证号15、18位校验，其它1-64位校验）     |
| legalIdCardType | String  | 选填 | 法定代表人证件类型  (当legalIdCard有值时必传)<br/>支持多种证件类型，参考附录44.1 |
| extendData      | String  | 选填 | 扩展数据，数据格式为json（key/value形式）例如：{"name":"张三"} |



请求实例：

```json
{	
    "userId": "1100",
    "orgName": "企业全称",
    "idType":"N",
    "orgCode": "110",
    "enterpriseType": "ET_PE",
    "authentication":true
}
```

### 6.3 返回结果

#### 6.3.1 正确响应

| 名称         | 类型    | 描述                                                    |
| ------------ | ------- | ------------------------------------------------------- |
| enterpriseId | String  | 企业唯一标识                                            |
| certId       | Long    | 证书id(需申请证书时)                                    |
| certCode     | Integer | 证书code(需申请证书时返回，200：申请成功、1000申请失败) |

返回实例

```
{

  "status": 1,
  "data": {
		"enterpriseId": "1257",
		"certId":1234567890,
		"certCode":200
  },

  "message": "成功"

}
```

#### 6.3.2 错误响应

```json
{
    "status":{错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 6.4 响应码

| 编号 | 描述                   |
| ---- | ---------------------- |
| 1    | 成功                   |
| 500  | 系统错误，请联系管理员 |
| 1000 | 参数为空或不满足规则   |
| 1007 | 用户未实名             |
| 1010 | 企业标签不匹配         |
| 1011 | 企业未配置企业证书RA   |



# 七、邀请用户加入企业

### 7.1 接口地址

http://localhost:8080/apigate/contractapi/user/joinEnterprise

### 7.2 请求参数

#### 7.2.1 请求方法

POST

#### 7.2.2 请求体

| 名称          | 类型   | 约束 | 描述                                         |
| ------------- | ------ | ---- | -------------------------------------------- |
| enterpriseId  | Sting  | 选填 | 邀请加入企业唯一标识<br>（注：企业必须实名） |
| userId        | String | 必填 | 邀请人用户唯一标识<br>（注：用户必须实名）   |
| inviteUserId  | String | 必填 | 受邀人用户唯一标识                           |
| employeeEmail | String | 选填 | 企业邮箱                                     |
| employeeCode  | String | 选填 | 员工工号(0-32位字符)                         |

请求实例：

```json
{	
    "userId": "1100",
    "inviteUserId": "1011",
    "employeeEmail": "123@qq.com",
    "employeeCode": "110@qq.com"
}
```

### 7.3 返回结果

```json
{

  "status": 1,
  "data": { },
  "message": "成功"

```



#### 7.3.1 正确响应

| 名称 | 类型 | 描述 |
| ---- | ---- | ---- |
|      |      |      |

#### 7.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 7.4 响应码

| 编号 | 描述                                             |
| ---- | ------------------------------------------------ |
| 1    | 成功                                             |
| 500  | 系统错误，请联系管理员                           |
| 1000 | 参数为空或不满足规则                             |
| 1008 | 企业不是已实名状态                               |
| 1012 | 无邀请用户权限（企业ID、用户都存在，无关联关系） |
| 1013 | 该用户已经加入该企业                             |
| 5000 | 非法请求                                         |

# 八、更新外部企业

### 8.1 接口地址

http://localhost:8080/apigate/contractapi/enterprise/update

### 8.2 请求参数

#### 8.2.1 请求方法

POST

#### 8.2.2 请求体

| 名称            | 类型   | 约束 | 描述                                                         |
| --------------- | ------ | ---- | ------------------------------------------------------------ |
| enterpriseId    | String | 必填 | 企业id                                                       |
| enterpriseLable | String | 选填 | 企业标签(有值时校验企业标签)                                 |
| orgName         | String | 选填 | 企业全称（1-32位字符) <br/>修改后企业证书和印章变更为无效，当企业是天威认证是企业变更为未实名 |
| extendData      | String | 选填 | 扩展数据，数据格式为json字符串（key/value形式）例如：{"name":"张三"} |



请求实例：

```json
{	
    "enterpriseId": "1100",
    "orgName": "企业全称"
}
```

### 8.3 返回结果

#### 8.3.1 正确响应

| 名称         | 类型    | 描述                                                    |
| ------------ | ------- | ------------------------------------------------------- |
| enterpriseId | String  | 企业唯一标识                                            |
| certId       | Long    | 证书id(需申请证书时)                                    |
| certCode     | Integer | 证书code(需申请证书时返回，200：申请成功、1000申请失败) |

返回实例

```
{

  "status": 1,
  "data": {
		"enterpriseId": "1257",
		"certId":1234567890,
		"certCode":200
  },

  "message": "成功"

}
```

#### 8.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 8.4 响应码

| 编号 | 描述                   |
| ---- | ---------------------- |
| 1    | 成功                   |
| 500  | 系统错误，请联系管理员 |
| 1000 | 参数为空或不满足规则   |
| 1021 | 主企业信息不可修改     |
| 5000 | 非法请求               |



# 九、创建企业印章

### 9.1 接口地址

http://localhost:8080/apigate/contractapi/enterprise/createSeal

### 9.2 请求参数

#### 9.2.1 请求方法

POST

#### 9.2.2 请求体

注：jpg和jpeg本质上是一样的，不做区分，把jpg强转png本质依然是jpg

| 名称           | 类型    | 约束 | 描述                                                         |
| -------------- | ------- | ---- | ------------------------------------------------------------ |
| enterpriseId   | String  | 选填 | 企业唯一标识<br/>（注：企业实名后可创建印章，不填默认本企业） |
| userId         | String  | 必填 | 印章创建人                                                   |
| sealType       | Integer | 必填 | 印章类型1自定义 2图片                                        |
| sealName       | String  | 必填 | 印章名称                                                     |
| sealBase64     | String  | 选填 | 印章图片(印章为图片类型时必填)文件格式：1Jpg2png3jpeg        |
| color          | Integer | 选填 | 印章，1：红色(默认)，2：绿色 ，3：蓝色 ，4：黑色（公共参数） |
| width          | Integer | 选填 | 印章宽度(38mm-58mm)默认40（公共参数）                        |
| alpha          | Integer | 选填 | 印章透明度(0-10默认5)（公共参数）                            |
| shape          | Integer | 选填 | 印章形状：(默认)1圆章、2椭圆章、3三角章<br/>(印章类型是自定义时选填) |
| upperText      | String  | 选填 | 上弦文（1-32）（印章类型是自定义时必填)                      |
| lowerText      | String  | 选填 | 下弦文（1-16）                                               |
| horizontalText | String  | 选填 | 水平文字（1-16）                                             |
| fontType       | Integer | 选填 | 印章字体，1：微软雅黑（默认）， 2：黑体， 3：宋体，<br/>4：华文行楷， 5：方正舒体(印章类型是自定义时选填) |
| createSealType | Integer | 选填 | 印章类型：1普通电子章（默认）、2OFD印章；<span style="color:#00ff00">(v4.7.0.0新增)</span> |

请求实例：

```
{
    "enterpriseId": "1002",
    "userId": "1001",
    "sealType": 2,
    "sealName": 测试印章,
    "sealBase64": "ACUADANAKA-1NL2N...",
    "color": 1,
    "width": 40
}
```

### 9.3 返回结果

#### 9.3.1 正确响应

| 名称   | 类型 | 描述   |
| ------ | ---- | ------ |
| sealId | Long | 印章id |

返回实例

```
{
    "status": 1,
    "data":{"sealId":123456789} ,
    "message": "成功"
}
```

#### 9.3.2 错误响应

```
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

### 9.4 响应码

| 编号 | 描述                   |
| ---- | ---------------------- |
| 1    | 成功                   |
| 500  | 系统错误，请联系管理员 |
| 1000 | 参数为空或不满足规则   |
| 1008 | 企业不是已实名状态     |
| 1014 | 用户无权限             |
| 1015 | 印章名称已存在         |





# 十、创建个人人名章

### 10.1 接口地址

http://localhost:8080/apigate/contractapi/user/createAutograph

### 10.2 请求参数

#### 10.2.1 请求方法

POST

#### 10.2.2 请求体

注：jpg和jpeg本质上是一样的，不做区分，把jpg强转png本质依然是jpg

| 名称            | 类型    | 约束 | 描述                                                         |
| --------------- | ------- | ---- | ------------------------------------------------------------ |
| userId          | String  | 必填 | 用户唯一标识（注：用户实名后可创建签名）                     |
| autographType   | Integer | 必填 | 签名类型1自定义2图片                                         |
| autographName   | String  | 必填 | 签名名称（长度1-10字符）                                     |
| autographBase64 | String  | 选填 | 签名图片(签名为图片类型时必填)文件格式：1Jpg2png3jpeg        |
| color           | Integer | 选填 | 签名颜色，1：红色(默认),2：绿色,3：蓝色 ,4：黑色(公共参数)   |
| alpha           | Integer | 选填 | 签名透明度(0-10)默认5(公共参数)                              |
| width           | Integer | 选填 | 签名宽度(38mm-58mm)(默认40)(上传图片类型时选用)              |
| border          | Itenger | 选填 | 边框：1有边框（默认）、2没有边框 (自定义上传时选填)          |
| fontType        | Integer | 选填 | 签名字体，1：微软雅黑（默认）， 2：黑体， 3：宋体，<br/>4：华文行楷， 5：方正舒体(自定义上传时选填) |
| createStampType | Integer | 选填 | 印章类型：1普通电子人名章（默认）、2OFD人名章；<span style="color:#00ff00">(v4.7.0.0新增)</span> |

请求实例：

```
{
    "userId": "1002",
    "autographType": 2,
    "autographName": 测试印章,
    "autographBase64": "ACUADANAKA-1NL2N..."
}
```

### 10.3 返回结果

#### 10.3.1 正确响应

| 名称        | 类型 | 描述   |
| ----------- | ---- | ------ |
| autographId | Long | 签名id |

返回实例

```
{
    "status": 1,
    "data":{"autographId":123456789} ,
    "message": "成功"
}
```

#### 10.3.2 错误响应

```
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

### 10.4 响应码

| 编号 | 描述                   |
| ---- | ---------------------- |
| 1    | 成功                   |
| 500  | 系统错误，请联系管理员 |
| 1000 | 参数为空或不满足规则   |
| 1007 | 用户未实名             |
| 1016 | 个人签名数量已满5个    |



# 十一、印章授权用户

### 11.1 接口地址

http://localhost:8080/apigate/user/authSeal

### 11.2 请求参数

#### 11.2.1 请求方法

POST

#### 11.2.2 请求体

| 名称         | 类型   | 约束 | 描述                                                  |
| ------------ | ------ | ---- | ----------------------------------------------------- |
| enterpriseId | String | 选填 | 企业唯一标识<br/>（注：不填默认本企业）               |
| authUserId   | String | 必填 | 授权人唯一标识<br/>（注：enterpriseId填写时必填）     |
| toAuthUserId | String | 必填 | 被授权人唯一标识<br/>（注：被授权人必须已加入该企业） |
| sealId       | Long   | 必填 | 印章唯一标识                                          |

请求实例：

```
{
    "enterpriseId": ""1003",
    "authUserId": "1002",
    "toAuthUserId": "1303",
    "sealId": 1294081936519786498
}
```

### 11.3 返回结果

#### 11.3.1 正确响应

| 名称 | 类型 | 描述 |
| ---- | ---- | ---- |
|      |      |      |

返回实例

```
{
    "status": 1,
    "data":{} ,
    "message": "成功"
}
```

#### 11.3.2 错误响应

```
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

### 11.4 响应码

| 编号 | 描述                   |
| ---- | ---------------------- |
| 1    | 成功                   |
| 500  | 系统错误，请联系管理员 |
| 1000 | 参数为空或不满足规则   |
| 1007 | 企业不是已实名状态     |
| 1017 | 授权用户无权限         |
| 1018 | 被授权用户无权限       |
| 1019 | 被授权人已关联该印章   |
| 5000 | 非法请求               |



# 十二、上传文件创建合同

### 12.1 接口地址

http://localhost:8080/apigate/contractapi/contract/createByFile

### 12.2 请求参数

#### 12.2.1 请求方法

POST

#### 12.2.2 请求体

| 名称           | 类型           | 约束 | 描述                                                         |
| -------------- | -------------- | ---- | ------------------------------------------------------------ |
| code           | String         | 选填 | 合同编号，如果用户没有传递系统会自动生成合同编号。合同编号不能重复（1-64字符） |
| name           | String         | 选填 | 合同名称 1-64字符，支持中文、英文大小写，数字、特殊字符，如果业务类型未设置合同名称策略，则合同名称必传；如业务类型已设置合同名称策略，则该参数可以不传，系统自动按照业务类型设置的合同名称策略生成合同名称； |
| signCount      | int            | 必填 | 签约人数 0-10人，0代表不限制签署人个数。需要调用强制结束接口结束合同签署。 |
| docName        | String         | 必填 | 合同文档名称1-64字符，支持中文、英文大小写，数字、特殊字符必填 |
| base64         | String         | 选填 | 合同文件base64，最大不超过5MB，支持pdf/doc/docx文件格式      |
| lastFileType   | Integer        | 选填 | 合同终版文件类型：1PDF（默认）,2OFD；当该参数未传时，取业务类型中设置的合同终版文件类型，若业务类型中也未设置，则取系统默认设置（PDF）类型。<span style="color:#00ff00">(v4.7.0.0新增)</span> |
| filePath       | String         | 选填 | 文件绝对路径（带文件名）(base64与filePath二选一必填)         |
| pathType       | Integer        | 选填 | 文件绝对路径类型：1ftp路径（默认）、2http路径、3fastdfs路径  |
| bizCode        | String         | 选填 | 业务分类                                                     |
| signValidDays  | int            | 选填 | 签署有效期（天）默认90天。范围1-365天。当未传该参数时，看业务类型是否已设置，如未设置，默认90天，已设置，则取业务类型中设置的签署有效期； |
| signSortable   | boolean        | 选填 | 是否顺序签署:false无序（默认）、true有序                     |
| send           | boolean        | 选填 | 是否立即发起合同：false不发起、true立即发起（默认立即发起）  |
| creator        | String         | 必填 | 创建人（发起用户id）（创建人必须实名，并且加入到此企业）     |
| enterpriseId   | String         | 必填 | 发起方企业id                                                 |
| syncUrl        | String         | 选填 | 页面同步通知地址；页面签有效；                               |
| asyncUrl       | String         | 选填 | 后台异步通知地址；页面签有效；                               |
| waterMarkOff   | Boolean        | 选填 | 是否设置水印开关：false(不设置)，true(设置)；***\*若业务类型设置水印关闭，则水印无法设置\****<br>,<font color=red>OFD本版本不支持水印功能</font> |
| waterMarkParam | WaterMarkParam | 选填 | 当waterMarkOff为true时，该参数必填                           |

WaterMarkParam水印设置参数结构体：

| 名称                | 类型                | 约束 | 描述                                                         |
| ------------------- | ------------------- | ---- | ------------------------------------------------------------ |
| markName            | String              | 必填 | 水印名称                                                     |
| markType            | Integer             | 必填 | 水印类型1文字2图片3二维码(注:根据类型取的对应参数)           |
| position            | Integer             | 选填 | 水印位置:1左上,2右上,3 左下 ,4右下, 5居中,6平铺,7填充（默认1左上）(注意二维码仅支持1左上,2右上,3 左下 ,4右下) |
| pdfTextMarkParams   | PdfTextMarkParams   | 选填 | 添加文本水印请求参数实体                                     |
| pdfImageMarkParams  | PdfImageMarkParams  | 选填 | 添加图片水印请求参数实体                                     |
| pdfQrCodeMarkParams | PdfQrCodeMarkParams | 选填 | 添加二维码水印请求参数实体                                   |

PdfTextMarkParams:添加文本水印请求参数实体

| 名称     | 类型   | 约束 | 描述                                                         |
| -------- | ------ | ---- | ------------------------------------------------------------ |
| text     | String | 必填 | 水印文字                                                     |
| fontSize | Float  | 选填 | 文字大小：默认为12，取值范围[6.5,7.5,9,10.5,12,14,15,16,18,22,24,26,36] |
| color    | String | 选填 | 文字颜色 (色号) ，格式：\#FF0000                             |
| opacity  | Float  | 选填 | 透明度；范围：0至1；0：透明，1：不透明；默认为1；            |
| rotation | Float  | 选填 | 旋转角度，范围-180至180；正数：逆时针旋转，负数：顺时针旋转 默认（0°） |

PdfImageMarkParams:添加图片水印请求参数实体

| 名称                | 类型   | 约束 | 描述                                                         |
| ------------------- | ------ | ---- | ------------------------------------------------------------ |
| watermarkFileBase64 | String | 必填 | 图片文件(base64)                                             |
| width               | Float  | 选填 | 水印图片放在PDF上的宽度；如果不传，则为水印图片默认宽度；    |
| height              | Float  | 选填 | 水印图片放在PDF上的高度；如果不传，则为水印图片默认高度；    |
| opacity             | Float  | 选填 | 透明度；范围：0至1；0：透明，1：不透明；如果不传，默认为1；如果小于0，默认为0；如果大于1，默认为1; |
| rotation            | Float  | 选填 | 旋转角度；正数：逆时针旋转，负数：顺时针旋转  默认（0°）     |

PdfQrCodeMarkParams:添加二维码水印请求参数实体

| 名称         | 类型   | 约束 | 描述                                                     |
| ------------ | ------ | ---- | -------------------------------------------------------- |
| qrCodeWidth  | Float  | 选填 | 二维码宽度，默认86px                                     |
| qrCodeHeight | Float  | 选填 | 二维码高度，默认86px                                     |
| viewRange    | String | 选填 | 二维码查看范围（0:公开文档；1:文件参与人与管理员可查看） |

请求实例：

```json
{
    "Code": "1020200620701056856",
    "name": "汽车购买交易合同",
    "signCount": 10,
    "docName":"员工保密协议",
    "base64": "3453QWFfds435...",
    "creator": "1003",
    "enterpriseId":"1001",
    "signValidDays": 90,
    "syncUrl": "http://wwww.XXXX.com/api",
    "asyncUrl": "http://www.XXXX.com"
}

```

### 12.3 返回结果



#### 12.3.1 正确响应

| 名称         | 类型   | 描述                                                         |
| ------------ | ------ | ------------------------------------------------------------ |
| contractId   | Long   | 合同id                                                       |
| code         | string | 合同编号                                                     |
| contractName | String | 合同名称                                                     |
| status       | int    | 合同状态:0草稿、1.待签署，2.签署中，3.已完成，4.已过期，5.已解约，6.已拒签 |
| docId        | Long   | 合同文档id                                                   |
| docName      | String | 合同文档名称                                                 |

 

返回实例：

```json
{
    "status":1,
    "data":{
        "contractId":23432453535111123,
        "code":"1020200620701056856",
        "contractName":"员工劳动合同",
        "status":0,
        "docId":2343453535,
        "docName":"员工保密协议"
    },
    "message":"成功"
}

```



#### 12.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 12.4 响应码

| 编号 | 描述                             |
| ---- | -------------------------------- |
| 1    | 成功                             |
| 500  | 系统错误，请联系管理员           |
| 1000 | 参数为空或不满足规则             |
| 2001 | 合同文件格式转换失败             |
| 2002 | 合同编号已存在                   |
| 2004 | 检查发起方企业用户失败           |
| 2039 | 合同文件大小超过最大限制5MB      |
| 2053 | 业务类型错误或没有该业务类型权限 |

# 十三、添加上传合同文件

**注意：**当合同业务类型发起策略设置的是仅允许上传一个合同文件时，该接口不可调用；

### 13.1 接口地址

http://localhost:8080/apigate/contractapi/contract/uploadFile

### 13.2 请求参数

#### 13.2.1 请求方法

POST

#### 13.2.2 请求体

| 名称         | 类型    | 约束 | 描述                                                         |
| ------------ | ------- | ---- | ------------------------------------------------------------ |
| contractId   | Long    | 必填 | 合同id                                                       |
| docName      | String  | 必填 | 合同文档名称1-64字符，支持中文、英文大小写，数字、特殊字符必填 |
| filePath     | String  | 选填 | 文件绝对路径（带文件名）(base64与filePath二选一必填)         |
| pathType     | Integer | 选填 | 文件绝对路径类型：1ftp路径（默认）、2http路径、3fastdfs路径  |
| contractFile | String  | 必填 | 合同文件（base64），支持pdf/doc/docx文件格式                 |
| sequence     | int     | 选填 | 合同文件排序序号（此序号用于多文件场景，无多文件场景可不传递） |



请求实例：

```json
{
    "contractId": 1020200620701056856,
    "docName":"员工保密协议",
    "contractFile": 合同文件base64
}

```

### 13.3 返回结果

#### 13.3.1 正确响应

| 名称            | 类型       | 描述                                                         |
| --------------- | ---------- | ------------------------------------------------------------ |
| contractId      | Long       | 合同id                                                       |
| code            | String     | 合同编号                                                     |
| contractName    | String     | 合同名称                                                     |
| status          | int        | 合同状态:0草稿、1.待签署，2.签署中，3.已完成，4.已过期，5.已解约，6.已拒签 |
| documents       | Document[] | 合同文件列表                                                 |
| currUploadDocId | Long       | 当前上传文档id                                               |

Document合同文件结构

| 名称    | 类型   | 描述         |
| ------- | ------ | ------------ |
| docId   | Long   | 合同文档id   |
| docName | String | 合同文档名称 |



返回实例

```json
{
    "status":1,
    "data":{
        "contractId":23432453535111123,
        "code":"1020200620701056856",
        "contractName":"员工劳动合同",
        "status":0,
        "documents":[{ 
            "docId":2343453535,
       		"docName":"员工保密协议"
        }]
       
    },
    "message":"成功"
}

```

#### 13.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 13.4 响应码

| 编号 | 描述                             |
| ---- | -------------------------------- |
| 1    | 成功                             |
| 500  | 系统错误，请联系管理员           |
| 2003 | 合同不存在                       |
| 2007 | 合同不是草稿状态，不可以上传文件 |
| 2008 | 合同上传失败，文件保存异常       |
| 2039 | 合同文件大小超过最大限制         |
| 2040 | 应用AppId没有操作此合同权限      |
| 2049 | 合同文件总数超过最大限制         |
| 2050 | 合同文档名称已存在，不可以重复   |

# 十四、发起合同签署

### 14.1 接口地址

http://localhost:8080/apigate/contractapi/contract/send

### 14.2 请求参数

#### 14.2.1 请求方法

POST

#### 14.2.2 请求体

| 名称       | 类型 | 约束 | 描述   |
| ---------- | ---- | ---- | ------ |
| contractId | Long | 必填 | 合同id |



请求实例：

```json
{
    "contractId": 1020200620701056856
}

```

### 14.3 返回结果



#### 14.3.1 正确响应

| 名称         | 类型       | 描述                                                         |
| ------------ | ---------- | ------------------------------------------------------------ |
| contractId   | Long       | 合同id                                                       |
| code         | String     | 合同编号                                                     |
| contractName | String     | 合同名称                                                     |
| status       | int        | 合同状态:0草稿、1.待签署，2.签署中，3.已完成，4.已过期，5.已解约，6.已拒签 |
| documents    | Document[] | 合同文件列表                                                 |

Document合同文件结构

| 名称    | 类型   | 描述         |
| ------- | ------ | ------------ |
| docId   | Long   | 合同文档id   |
| docName | String | 合同文档名称 |



返回实例

```json
{
    "status":1,
    "data":{
        "contractId":23432453535111123,
        "code":"4567767897899",
        "contractName":"员工劳动合同",
        "status":0,
        "documents":[{ 
            "docId":2343453535,
       		"docName":"员工保密协议"
        }]
       
    },
    "message":"成功"
}

```

#### 14.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 14.4 响应码

| 编号 | 描述                             |
| ---- | -------------------------------- |
| 1    | 成功                             |
| 500  | 系统错误，请联系管理员           |
| 2003 | 合同不存在                       |
| 2007 | 合同不是草稿状态，不可以上传文件 |
| 2040 | 应用AppId没有操作此合同权限      |



# 十五、添加上传合同签署人

### 15.1 接口地址

http://localhost:8080/apigate/contractapi/contract/addSignerByFile

### 15.2 请求参数

#### 15.2.1 请求方法

POST

#### 15.2.2 请求体

| 名称       | 类型     | 约束 | 描述       |
| ---------- | -------- | ---- | ---------- |
| contractId | Long     | 必填 | 合同ID     |
| signers    | Signer[] | 必填 | 合同签署人 |

Signer合同签署人结构

| 名称         | 类型        | 约束 | 描述                                                         |
| ------------ | ----------- | ---- | ------------------------------------------------------------ |
| signerType   | Integer     | 必填 | 签署人类型：1个人、2企业                                     |
| userId       | String      | 必填 | 签署人用户id，签署人可以未实名                               |
| enterpriseId | String      | 可填 | 签署人公司ID（当签署人类型为企业时，必填）                   |
| sequence     | Integer     | 可填 | 签署人顺序（签署顺序1-100之间）                              |
| sendMsg      | boolean     | 可填 | 是否发送短信通知到电子合同系统签署，false不发送(默认)、true发送 |
| signFiles    | SignFile[]  | 必填 | 签署文件列表                                                 |
| setting      | Boolean     | 可填 | 是否设置控件：false不设置，true设置（默认）                  |
| controlsType | Set<String> | 可填 | 不设置控件，签署时的控件类型范围；当setting为false时，该参数为必填，控件类型-参照附录：26.2 |

SignFile签署文件结构

| 名称                | 类型             | 约束 | 描述           |
| ------------------- | ---------------- | ---- | -------------- |
| docId               | Long             | 必填 | 签署合同文档Id |
| xySignControls      | XYControl[]      | 可填 | 坐标轴控件     |
| keywordSignControls | KeywordControl[] | 可填 | 关键字控件     |
| crossSignControls   | CrossControl[]   | 可填 | 骑缝章控件     |

关键字签署控件KeywordControl：（$\color{#FF0000}{接口UKey签不支持该控件}$）

| 名称    | 类型    | 约束 | 描述                                                         |
| ------- | ------- | ---- | ------------------------------------------------------------ |
| id      | Integer | 必填 | 控件id，不可重复                                             |
| type    | String  | 必填 | 控件类型                                                     |
| pageNum | String  | 必填 | 多页签时为必填项 指定盖章页， 0：所有页盖章 -1：最后一页，支持：1，2，3，4，5，-1 |
| keyword | String  | 必填 | 关键字（一个签署方只支持一个关键字）                         |
| offsetX | Float   | 可填 | 关键字偏移横坐标x，原点印章默认位置，浮点数，0-21 单位cm     |
| offsetY | Float   | 可填 | 关键字偏移纵坐标y，原点印章默认位置，浮点数，0-29.7 单位cm   |
| width   | Float   | 可填 | 控件宽（单位：cm），印章、图片控件，可不填，默认为图片的宽度 |
| height  | Float   | 可填 | 控件高（单位：cm），印章、图片控件，可不填，默认为图片的高度 |

坐标轴签署控件XYControl：

| 名称    | 类型    | 约束 | 描述                                                         |
| ------- | ------- | ---- | ------------------------------------------------------------ |
| id      | Integer | 必填 | 控件id，不可重复                                             |
| type    | String  | 必填 | 控件类型                                                     |
| pageNum | String  | 必填 | 多页签时为必填项 指定盖章页， 0：所有页盖章 -1：最后一页，支持：1，2，3，4，5，-1 |
| x       | Float   | 必填 | 横坐标x，原点为左上角，浮点数，0-1，PDF位置比例              |
| y       | Float   | 必填 | 纵坐标y，原点为左上角，浮点数，0-1，PDF位置比例              |
| width   | Float   | 可填 | 控件宽（单位：cm），印章、图片控件，可不填，默认为图片的宽度 |
| height  | Float   | 可填 | 控件高（单位：cm），印章、图片控件，可不填，默认为图片的高度 |

骑缝签署控件CrossControl：（$\color{#FF0000}{接口UKey签不支持该控件}$）

| 名称    | 类型    | 约束 | 描述                                                         |
| ------- | ------- | ---- | ------------------------------------------------------------ |
| id      | Integer | 必填 | 控件id，不可重复                                             |
| pageNum | String  | 必填 | 多页签时为必填项 指定盖章页， 0：所有页盖章 -1：最后一页，支持：1，2，3，4，5，-1 |
| y       | Float   | 必填 | 纵坐标y，印章左上角距离文档上边缘的距离（cm），<br />默认印章垂直居中 |
| width   | Float   | 可填 | 控件宽（单位：cm），默认为图片的宽度                         |
| height  | Float   | 可填 | 控件高（单位：cm），默认为图片的高度                         |

请求实例：

```json
{
	"contractId": 13000001,
	"signers": [{
		"userId": "1001",
		"signerType": 2,
		"enterpriseId": "1003",
		"sequence": 8,
		"sendMsg": false,
		"signFiles": [{
			"docId": 343465645,
			"xySignControls": [{
					"id": 1,
					"type": "text",
					"pageNum": 1,
					"x": 0.04,
					"y": 0.6
				},
				{
					"id": 2,
					"type": "signet",
					"pageNum": 2,
					"x": 0.04,
					"y": 0.6
				},
				{
					"id": 3,
					"type": "date",
					"pageNum": 2,
					"x": 0.03,
					"y": 0.5
				}
			],
			"keywordSignControls": [{
				"id": 1,
				"type": "signet",
				"pageNum": 2,
				"keyword": "盖章",
				"offsetX": 0.03,
				"offsetY": 0.5
			}]
		}]
	}]
}
```

### 15.3 返回结果

#### 15.3.1 正确响应

| 名称          | 类型     | 描述                                                         |
| ------------- | -------- | ------------------------------------------------------------ |
| code          | String   | 合同编号                                                     |
| contractId    | Long     | 合同id                                                       |
| contractName  | String   | 合同主题                                                     |
| status        | Integer  | 合同状态:0草稿、1.待签署，2.签署中，3.已完成，4.已过期，5.已解约，6.已拒签 |
| signers       | Signer[] | 合同签署人                                                   |
| lastSignTime  | date     | 最后签署时间                                                 |
| currSignerIds | Long[]   | 当前签署人ID                                                 |

Signer签署人结构

| 名称       | 类型       | 描述                                                         |
| ---------- | ---------- | ------------------------------------------------------------ |
| signerId   | Long       | 签署人ID                                                     |
| userId     | String     | 签署人用户id                                                 |
| userName   | String     | 合同签署人姓名                                               |
| signStatus | Integer    | 合同签署人签署状态：1.待他人签署，2 待我签（.签署中），3.已签署，5.已解约，6.已拒签 |
| docList    | Document[] | 合同文档                                                     |

Document合同文档体结构

| 名称      | 类型    | 描述             |
| --------- | ------- | ---------------- |
| docId     | Long    | 合同文件Id       |
| docName   | String  | 合同文件名称     |
| docStatus | Integer | 合同文件签署状态 |

返回实例：

```json
{
    "status": 1,
    "data":{
        "code": "1020200620701056856",
        "contractId": 13000001,
        "contractName": "汽车购买交易合同",
        "status": 1,
        "lastSignTime": "2020-06-22",
        "signers": [
            {	
                "signerId": 1100,
                "userId": "1100",
                "userName": "张三",
                "signStatus": 1,
                "docList": [
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议",
                        "docStatus": 1
                    },
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议",
                        "docStatus": 1
                    }
                ]
            }],
        "currSignerIds": [1100]
    },
    "message": "成功"
}

```

#### 15.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 15.4 响应码

| 编号 | 描述                                                     |
| ---- | -------------------------------------------------------- |
| 1    | 成功                                                     |
| 500  | 系统错误，请联系管理员                                   |
| 2003 | 合同不存在                                               |
| 2004 | 校验企业用户失败                                         |
| 2005 | 校验个人用户失败                                         |
| 2009 | 签署人签署的合同中不存在合同文档id                       |
| 2040 | 应用AppId没有操作此合同权限                              |
| 2041 | 添加的合同签署人数超过创建合同时设置的签署人数           |
| 2042 | 合同顺序签署时，添加的合同签署人序号必须大于已签署的序号 |



# 十六、发送意愿认证验证码

### 16.1 接口地址

http://localhost:8080/apigate/contractapi/user/sendSmsCode

### 16.2 请求参数

#### 16.2.1 请求方法

POST

#### 16.2.2 请求体

| 名称       | 类型    | 约束 | 描述                                                         |
| ---------- | ------- | ---- | ------------------------------------------------------------ |
| userId     | String  | 选填 | 用户id  type为1时必填                                        |
| authType   | Integer | 选填 | 意愿认证类型：1合同签署意愿认证（默认），2个人用户实名意愿认证 3企业实名意愿认证()  4签署密码设置 |
| authMethod | Integer | 选填 | 意愿认证方式：1发送手机号短信验证码(默认)2发送邮箱验证码<br/> (目前只支持手机号) |
| type       | Integer | 选填 | 1 用户id(默认)  2 手机号                                     |
| phone      | String  | 选填 | 手机号 type为1时必填                                         |



请求实例：

```json
{
    "userId": "1020200620701056856",
    "authType": 1,
    "authMethod": 1
}

```

### 16.3 返回结果

#### 16.3.1 正确响应

| 名称       | 类型   | 描述     |
| ---------- | ------ | -------- |
| codeNumber | String | 短信编号 |



返回实例

```json
{
    "status":1,
    "data":{
        "codeNumber":"4567767897899"
    },
    "message":"成功"
}

```

#### 16.3.2 错误响应

```json

{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 16.4 响应码

| 编号 | 描述                   |
| ---- | ---------------------- |
| 1    | 成功                   |
| 500  | 系统错误，请联系管理员 |





# 十七、上传文件合同后台签署

### 17.1 接口地址

http://localhost:8080/apigate/contractapi/contract/signByFile

### 17.2 请求参数

#### 17.2.1 请求方法

POST

#### 17.2.2 请求体

| 名称       | 类型   | 约束 | 描述       |
| ---------- | ------ | ---- | ---------- |
| contractId | Long   | 必填 | 合同ID     |
| signer     | Signer | 必填 | 合同签署人 |

Signer合同签署人结构

| 名称          | 类型       | 约束 | 描述                                                         |
| ------------- | ---------- | ---- | ------------------------------------------------------------ |
| signerId      | Long       | 必填 | 签署人ID（添加签署人接口返回）                               |
| isUserWishes  | boolean    | 选填 | 是否要做意愿认证；默认false；<br />false 否 用户自己做意愿认证， <br />true 是 需要天威诚信做意愿认证 ； |
| userWishesWay | Integer    | 选填 | 意愿认证方式；1 验证码认证方式，2  签署密码认证 <br />  后续会扩展认证方式；<br />isUserWishes参数为true时必填<br /> |
| codeNumber    | String     | 选填 | 验证码编号    意愿认证方式为验证码认证时必填                 |
| verifyCode    | String     | 选填 | 验证码   意愿认证方式为验证码认证时必填                      |
| signPassword  | String     | 选填 | 签署密码   意愿认证方式为签署密码认证时必填                  |
| signFiles     | SignFile[] | 必填 | 签署文件                                                     |
| remark        | String     | 选填 | 签章备注                                                     |

SignFile签署文件结构

| 名称        | 类型               | 约束 | 描述                                                         |
| ----------- | ------------------ | ---- | ------------------------------------------------------------ |
| docId       | Long               | 必填 | 签署合同文件id                                               |
| signControl | Map<String,String> | 必填 | 签署控件，控件对应的ID、对应的value值<br/>map的key支持sealId和base64 详见请求示例 |
| fonts       | TextControlsFont[] | 可填 | 文本控件字体属性                                             |

TextControlsFont文本控件字体属性

| 名称       | 类型    | 约束 | 描述                                  |
| ---------- | ------- | ---- | ------------------------------------- |
| controlsId | Integer | 必填 | 文本控件id                            |
| fontType   | Integer | 可填 | 字体类型：1宋体、2楷体、3黑体         |
| fontSize   | Float   | 可填 | 字体大小                              |
| fontColor  | String  | 可填 | 字体颜色，格式：\#FF0000              |
| alignment  | Integer | 可选 | 对齐方式：0左对齐，1居中对其，2右对齐 |



请求实例：

```json
{
	"contractId": 13000001,
	"signer": {
		"signerId": 1001,
		"isUserWishes": 0,
		"userWishesWay": 1,
		"codeNumber": "1004",
		"verifyCode": "13006",
		"signFiles": [{
			"docId": 23435566,
			"signControl": {
				"1": "sealId:123",
                "2": "base64:AAAA"
			},
            "fonts":[{"controlsId":1,"fontType":1,"fontSize":8.5,
                      "fontColor":"#56600F","alignment":1}]
		}]
	}
}
```

### 17.3 返回结果



#### 17.3.1 正确响应

| 名称         | 类型     | 描述                                                         |
| ------------ | -------- | ------------------------------------------------------------ |
| code         | String   | 合同编号                                                     |
| contractId   | Long     | 合同id                                                       |
| contractName | String   | 合同主题                                                     |
| status       | int      | 合同状态:0草稿、1.待签署，2.签署中，3.已完成，4.已过期，5.已解约，6.已拒签 |
| signers      | Signer[] | 合同签署人                                                   |
| lastSignTime | date     | 最后签署时间                                                 |

Signer签署人结构

| 名称       | 类型       | 描述                                                         |
| ---------- | ---------- | ------------------------------------------------------------ |
| userId     | String     | 签署人用户id                                                 |
| userName   | String     | 合同签署人姓名                                               |
| signStatus | Integer    | 合同签署人签署状态：1.待他人签署，2 待我签（.签署中），3.已签署，5.已解约，6.已拒签 |
| docList    | Document[] | 合同文档                                                     |

Document合同文档体结构

| 名称    | 类型   | 描述         |
| ------- | ------ | ------------ |
| docId   | Long   | 合同文档Id   |
| docName | String | 合同文档名称 |

返回实例：

```json
{
    "status": 1,
    "data":{
        "code": "1020200620701056856",
        "contractId": 13000001,
        "contractName": "汽车购买交易合同",
        "status": 1,
        "lastSignTime": "2020-06-22",
        "signers": [
            {
                "userId": "1100",
                "userName": "张三",
                "signStatus": 1,
                "docList": [
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    },
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    }
                ]
            }]
    },
    "message": "成功"
}

```

#### 17.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 17.4 响应码

| 编号 | 描述                                               |
| ---- | -------------------------------------------------- |
| 1    | 成功                                               |
| 500  | 系统错误，请联系管理员                             |
| 2003 | 合同不存在                                         |
| 2012 | 模板签合同不能调用自由签接口                       |
| 2013 | 合同不存在签署人，请先添加签署人                   |
| 2014 | 签署人不是该合同签署人                             |
| 2015 | 签署人的签署文档数与创建合同设置的签署文档数不匹配 |
| 2016 | 缺少签署文档docId【】的控件参数                    |
| 2017 | 签署文档docId【】控件id错误                        |
| 2022 | 合同签署人状态不是签署中                           |
| 2025 | 合同状态已过期                                     |
| 2026 | 合同已签署完成                                     |
| 2040 | 应用AppId没有操作此合同权限                        |
| 2045 | 意愿认证验证码编号与验证码都不能为空               |
| 2046 | 签署意愿认证验证码错误                             |
| 2052 | 图片签署控件值错误                                 |
| 2054 | 图片控件图片文件大小超过最大限制                   |
| 2055 | 文本控件参数值长度不能超过300个字符                |
| 2056 | 印章、签名控件参数值错误                           |



# 十八、添加合同抄送人

### 18.1 接口地址

http://localhost:8080/apigate/contractapi/contract/addContractCc

### 18.2 请求参数

#### 18.2.1 请求方法

POST

#### 18.2.2 请求体

| 名称         | 类型    | 约束 | 描述                                   |
| ------------ | ------- | ---- | -------------------------------------- |
| contractId   | Long    | 必填 | 合同ID                                 |
| userId       | String  | 必填 | 抄送人用户id                           |
| ccType       | Integer | 必填 | 抄送人类型:1个人 2企业                 |
| enterpriseId | String  | 选填 | 抄送人公司ID（当抄送人为企业时，必填） |



请求实例：

```json
{
    "contractId": 13000001,
    "userId": "1001",
    "ccType": 2,
    "enterpriseId":"1000",
            
}

```

### 18.3 返回结果

#### 18.3.1 正确响应

| 名称         | 类型     | 描述                                                         |
| ------------ | -------- | ------------------------------------------------------------ |
| code         | String   | 合同编号                                                     |
| contractId   | Long     | 合同id                                                       |
| contractName | String   | 合同主题                                                     |
| status       | int      | 合同状态:0草稿、1.待签署，2.签署中，3.已完成，4.已过期，5.已解约，6.已拒签 |
| signers      | Signer[] | 合同签署人                                                   |
| lastSignTime | date     | 最后签署时间                                                 |

Signer签署人结构

| 名称       | 类型       | 描述                                                         |
| ---------- | ---------- | ------------------------------------------------------------ |
| signerId   | Long       | 签署人ID                                                     |
| userId     | Long       | 签署人用户id                                                 |
| userName   | String     | 合同签署人姓名                                               |
| signStatus | int        | 合同签署人签署状态：1.待他人签署，2 待我签（.签署中），3.已签署，5.已解约，6.已拒签 |
| docList    | Document[] | 合同文档                                                     |

Document合同文档体结构

| 名称    | 类型   | 描述         |
| ------- | ------ | ------------ |
| docId   | Long   | 合同文件Id   |
| docName | String | 合同文件名称 |

返回实例：

```json
{
    "status": 1,
    "data":{
        "code": "1020200620701056856",
        "contractId": 13000001,
        "contractName": "汽车购买交易合同",
        "status": 1,
        "lastSignTime": "2020-06-22",
        "signers": [
            {	
                "signerId": 1100,
                "userId": 1100,
                "userName": "张三",
                "signStatus": 1,
                "docList": [
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    },
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    }
                ]
            }]
    },
    "message": "成功"
}

```

#### 18.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 18.4 响应码

| 编号 | 描述                   |
| ---- | ---------------------- |
| 1    | 成功                   |
| 500  | 系统错误，请联系管理员 |
| 2003 | 合同不存在             |
| 2004 | 校验企业用户失败       |
| 2005 | 校验个人用户失败       |



# 十九、通过模板创建合同

### 19.1 接口地址

http://localhost:8080/apigate/contractapi/contract/createByTemplate

### 19.2 请求参数

#### 19.2.1 请求方法

POST

#### 19.2.2 请求体

| 名称         | 类型       | 约束 | 描述                                                         |
| ------------ | ---------- | ---- | ------------------------------------------------------------ |
| code         | String     | 可填 | 合同编号，如果用户没有传递系统会自动生成合同编号。合同编号不能重复（1-64字符） |
| templateCode | String     | 必填 | 模板编号（模板只能调用创建人有使用权限的模板）               |
| name         | String     | 选填 | 合同名称 1-64字符，支持中文、英文大小写，数字、特殊字符，如果业务类型未设置合同名称策略，则合同名称必传；如业务类型已设置合同名称策略，则该参数可以不传，系统自动按照业务类型设置的合同名称策略生成合同名称； |
| docList      | Document[] | 可填 | 合同文件列表，用于修改合同文件名、设置补充变量值             |
| enterpriseId | String     | 必填 | 发起方企业id                                                 |
| creator      | String     | 必填 | 发起人（用户id）                                             |
| syncUrl      | String     | 可填 | 页面同步通知地址；页面签有效；                               |
| asyncUrl     | String     | 可填 | 后台异步通知地址；页面签有效；                               |

Document合同文件结构：

| 名称          | 类型               | 约束 | 描述                     |
| ------------- | ------------------ | ---- | ------------------------ |
| templateDocId | Long               | 必填 | 模板合同文档id           |
| docName       | String             | 必填 | 合同文档名称1-64字符     |
| params        | Map<String,Object> | 可填 | 合同文件文本补充变量参数 |
| fonts         | TextControlsFont[] | 可填 | 文本控件字体属性         |

TextControlsFont文本控件字体属性

| 名称              | 类型    | 约束 | 描述                                                         |
| ----------------- | ------- | ---- | ------------------------------------------------------------ |
| controlsKey       | Integer | 必填 | 文本控件key                                                  |
| fontType          | Integer | 选填 | 字体类型：1宋体、2楷体、3黑体                                |
| fontSize          | Float   | 选填 | 字体大小                                                     |
| fontColor         | String  | 选填 | 字体颜色，格式：\#FF0000                                     |
| alignment         | Integer | 选填 | 文本水平对齐方式：0左对齐，1居中对其，2右对齐，默认:0        |
| verticalAlignment | Integer | 选填 | 文本垂直对齐方式 0:顶部对齐、1居中对齐、2:底部对齐，默认:0<br/>仅文本域支持<span style="color:#00CC00">【4.2.2新增】</span> |
| singleLine        | Boolean | 选填 | 是否单行显示，若为true则该控件文本单行自适应，<br />否则多行自适应，默认false<span style="color:#00CC00">【4.2.2新增】</span> |

请求实例：

```json
{
    "code": "1020200620701056856",
    "templateCode": "2020200620701056855",
    "name": "劳动合同",
    "docList":[
        {
            "templateDocId":13234465677,
            "docName":"保密协议",
            "params":[
                {
                    "租金":300
                }],
            "fonts": [
                    {
                        "controlsKey": "租金",
                        "fontType": 1,
                        "fontSize": 8.5,
                        "fontColor": "#56600F",
                        "alignment": 1
                    }
                ]
        }],
    "creator": 1002,
    "syncUrl": "http://www.baidu.com",
    "asyncUrl": "http://www.baidu.com"
}

```

### 19.3 返回结果

#### 19.3.1 正确响应

| 名称         | 类型       | 描述                                                         |
| ------------ | ---------- | ------------------------------------------------------------ |
| contractId   | Long       | 合同id                                                       |
| code         | String     | 合同编号                                                     |
| contractName | String     | 合同名称                                                     |
| status       | int        | 合同状态:0草稿、1.待签署，2.签署中，3.已完成，4.已过期，5.已解约，6.已拒签 |
| documents    | Document[] | 合同文件列表                                                 |

Document合同文件结构

| 名称    | 类型   | 描述         |
| ------- | ------ | ------------ |
| docId   | Long   | 合同文档id   |
| docName | String | 合同文档名称 |



返回实例

```json
{
    "status":1,
    "data":{
        "contractId":23432453535111123,
        "code":"1020200620701056856",
        "contractName":"员工劳动合同",
        "status":0,
        "documents":[{ 
            "docId":2343453535,
       		"docName":"员工保密协议"
        }]
       
    },
    "message":"成功"
}

```

### 19.3.1 正确响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 19.4 响应码

| 编号 | 描述                                         |
| ---- | -------------------------------------------- |
| 1    | 成功                                         |
| 500  | 系统错误，请联系管理员                       |
| 2002 | 合同编号已存在                               |
| 2004 | 检查发起方企业用户失败                       |
| 2006 | 合同模板不存在或不可用                       |
| 2009 | 合同文档id不存在                             |
| 2029 | 合同文件补充变量填充失败                     |
| 2030 | 合同文档名称不能重复                         |
| 2031 | 模板合同文件docId【】不存在补充变量          |
| 2032 | 模板合同文件docId【】补充变量key与模板不一致 |
| 2055 | 文本控件参数值长度不能超过300个字符          |



# 二十、添加模板合同签署人

### 20.1 接口地址

http://localhost:8080/apigate/contractapi/contract/addSignerByTemplate

### 20.2 请求参数

#### 20.2.1 请求方法

POST

#### 20.2.2 请求体

| 名称            | 类型             | 约束 | 描述       |
| --------------- | ---------------- | ---- | ---------- |
| contractId      | Long             | 必填 | 合同ID     |
| templateSigners | TemplateSigner[] | 必填 | 合同签署人 |

TemplateSigner合同签署人结构：

| 名称         | 类型    | 约束 | 描述                                                         |
| ------------ | ------- | ---- | ------------------------------------------------------------ |
| signerRole   | String  | 必填 | 模板签署方（角色与签署人类型要匹配）                         |
| userId       | String  | 必填 | 签署人用户id，签署人可以未实名                               |
| enterpriseId | String  | 可填 | 签署公司ID（当签署人为企业时，必填）                         |
| sendMsg      | boolean | 可填 | 是否发送短信通知到电子合同系统签署，false不发送(默认)、true发送 |

请求实例：

```json
{
    "contractId": 13000001,
    "templateSigners": [
        {	
            "userId": 1001,
            "enterpriseId":1000,
            "signerRole": "甲方",
            "sendMsg":false
        },
         {	
            "userId": 1001,
            "enterpriseId":1000,
            "signerRole": "乙方",
            "sendMsg":false
        }
    ]
}

```

### 20.3 返回结果

#### 20.3.1 正确响应

| 名称         | 类型     | 描述                                                         |
| ------------ | -------- | ------------------------------------------------------------ |
| code         | String   | 合同编号                                                     |
| contractId   | Long     | 合同id                                                       |
| contractName | String   | 合同主题                                                     |
| status       | int      | 合同状态:0草稿、1.待签署，2.签署中，3.已完成，4.已过期，5.已解约，6.已拒签 |
| signers      | Signer[] | 合同签署人                                                   |
| lastSignTime | date     | 最后签署时间                                                 |

Signer签署人结构

| 名称       | 类型       | 描述                                                         |
| ---------- | ---------- | ------------------------------------------------------------ |
| signerId   | Long       | 签署人ID                                                     |
| userId     | Long       | 签署人用户id                                                 |
| userName   | String     | 合同签署人姓名                                               |
| signStatus | int        | 合同签署人签署状态：1.待他人签署，2 待我签（.签署中），3.已签署，5.已解约，6.已拒签 |
| docList    | Document[] | 合同文档                                                     |

Document合同文档体结构

| 名称    | 类型   | 描述         |
| ------- | ------ | ------------ |
| docId   | Long   | 合同文件Id   |
| docName | String | 合同文件名称 |

返回实例：

```json
{
    "status": 1,
    "data":{
        "code": "1020200620701056856",
        "contractId": 13000001,
        "contractName": "汽车购买交易合同",
        "status": 1,
        "lastSignTime": "2020-06-22",
        "signers": [
            {	
                "signerId": 1100,
                "userId": 1100,
                "userName": "张三",
                "signStatus": 1,
                "docList": [
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    },
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    }
                ]
            }]
    },
    "message": "成功"
}

```

#### 20.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 20.4 响应码

| 编号 | 描述                         |
| ---- | ---------------------------- |
| 1    | 成功                         |
| 500  | 系统错误，请联系管理员       |
| 2003 | 合同不存在                   |
| 2004 | 校验企业用户失败             |
| 2005 | 校验个人用户失败             |
| 2011 | 签署人角色与模板签署方不一致 |
| 2040 | 应用AppId没有操作此合同权限  |
| 2048 | 企业签署方企业id参数不能为空 |



# 二十一、模板创建合同后台签署

### 21.1 接口地址

http://localhost:8080/apigate/contractapi/contract/signByTemplate

### 21.2 请求参数

#### 21.2.1 请求方法

POST

#### 21.2.2 请求体

| 名称       | 类型   | 约束 | 描述       |
| ---------- | ------ | ---- | ---------- |
| contractId | Long   | 必填 | 合同ID     |
| signer     | Signer | 必填 | 合同签署人 |

Signer合同签署人结构

| 名称          | 类型       | 约束 | 描述                                                         |
| ------------- | ---------- | ---- | ------------------------------------------------------------ |
| signerId      | Long       | 必填 | 签署人id（添加模板合同签署人接口返回）                       |
| isUserWishes  | boolean    | 选填 | 是否要做意愿认证；默认false；<br />false 否 用户自己做意愿认证， <br />true 是 需要天威诚信做意愿认证； |
| userWishesWay | Integer    | 选填 | 意愿认证方式；1 验证码认证方式（默认），2  签署密码认证方式 <br />后续会扩展认证方式；<br />isUserWishes参数为true时必填<br /> |
| codeNumber    | String     | 选填 | 验证码编号  意愿认证方式为验证码认证时必填                   |
| verifyCode    | String     | 选填 | 验证码   意愿认证方式为验证码认证时必填                      |
| signPassword  | String     | 选填 | 签署密码   意愿认证方式为签署密码认证时必填                  |
| signFiles     | SignFile[] | 必填 | 签署文件                                                     |
| remark        | String     | 选填 | 签章备注                                                     |

SignFile签署文件结构

| 名称         | 类型               | 约束 | 描述                                                 |
| ------------ | ------------------ | ---- | ---------------------------------------------------- |
| docId        | Long               | 必填 | 合同文件id                                           |
| signControls | Map<String,String> | 必填 | 签署控件<br/>map的key支持sealId和base64 详见请求示例 |
| fonts        | TextControlsFont[] | 可填 | 文本控件字体属性                                     |

签署签署控件signControls：

| 名称  | 类型   | 约束 | 描述    |
| ----- | ------ | ---- | ------- |
| key   | String | 必填 | 控件key |
| value | String | 必填 | 控件值  |

TextControlsFont文本控件字体属性

| 名称        | 类型    | 约束 | 描述                                  |
| ----------- | ------- | ---- | ------------------------------------- |
| controlsKey | Integer | 必填 | 文本控件key                           |
| fontType    | Integer | 可填 | 字体类型：1宋体、2楷体、3黑体         |
| fontSize    | Float   | 可填 | 字体大小                              |
| fontColor   | String  | 可填 | 字体颜色，格式：\#FF0000              |
| alignment   | Integer | 可填 | 对齐方式：0左对齐，1居中对其，2右对齐 |

请求实例：

```json
{
    "contractId": 13000001,
    "signer": {
        "signerId": 1001,
        "isUserWishes": 0,
        "userWishesWay": 1,
        "codeNumber": "1004",
        "verifyCode": "13006",
        "signFiles": [
            {
                "docId": 2235365,
                "signControls": {
                    "甲方签章": "base64:45645657",
                    "测试": "sealId:123123"
                    "租金": "100"
                },
                "fonts": [
                    {
                        "controlsKey": "文本1",
                        "fontType": 1,
                        "fontSize": 8.5,
                        "fontColor": "#56600F",
                        "alignment": 1
                    }
                ]
            }
        ]
    }
}
```

### 21.3 返回结果

#### 21.3.1 正确响应

| 名称         | 类型     | 描述                                                         |
| ------------ | -------- | ------------------------------------------------------------ |
| code         | String   | 合同编号                                                     |
| contractId   | Long     | 合同id                                                       |
| contractName | String   | 合同主题                                                     |
| status       | int      | 合同状态:0草稿、1.待签署，2.签署中，3.已完成，4.已过期，5.已解约，6.已拒签 |
| signers      | Signer[] | 合同签署人                                                   |
| lastSignTime | date     | 最后签署时间                                                 |

Signer签署人结构

| 名称       | 类型       | 描述                                                         |
| ---------- | ---------- | ------------------------------------------------------------ |
| userId     | Long       | 签署人用户id                                                 |
| userName   | String     | 合同签署人姓名                                               |
| signStatus | Integer    | 合同签署人签署状态：1.待他人签署，2 待我签（.签署中），3.已签署，5.已解约，6.已拒签 |
| docList    | Document[] | 合同文件                                                     |

Document合同文档体结构

| 名称    | 类型   | 描述         |
| ------- | ------ | ------------ |
| docId   | Long   | 合同文件Id   |
| docName | String | 合同文件名称 |

返回实例：

```json
{
    "status": 1,
    "data":{
        "code": "1020200620701056856",
        "contractId": 13000001,
        "contractName": "汽车购买交易合同",
        "status": 1,
        "lastSignTime": "2020-06-22",
        "signers": [
            {
                "userId": 1100,
                "userName": "张三",
                "signStatus": 1,
                "docList": [
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    },
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    }
                ]
            }]
    },
    "message": "成功"
}

```

#### 21.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 21.4 响应码

| 编号 | 描述                                               |
| ---- | -------------------------------------------------- |
| 1    | 成功                                               |
| 500  | 系统错误，请联系管理员                             |
| 2003 | 合同不存在                                         |
| 2012 | 自由签合同不能调用模板签接口                       |
| 2014 | 签署人不是该合同签署人                             |
| 2015 | 签署人的签署文档数与模板合同设置的签署文档数不匹配 |
| 2016 | 缺少签署文档docId【】的控件参数                    |
| 2017 | 签署文档docId【】控件key错误                       |
| 2022 | 合同签署人状态不是签署中                           |



# 二十二、用户绑定ukey

### 22.1 接口地址

http://localhost:8080/apigate/contractapi/contract/bindUkey

### 22.2 请求参数

#### 22.2.1 请求方法

POST

#### 22.2.2 请求体

请求体结构

| 名称             | 类型    | 约束 | 描述                                                         |
| ---------------- | ------- | ---- | ------------------------------------------------------------ |
| enterpriseUserId | Long    | 必填 | 用户/企业id  <br/>证书类型为个人时enterpriseUserId为个人id<br/>证书类型为企业时enterpriseUserId为企业id |
| certType         | Integer | 必填 | 证书类型 1:个人；2:企业                                      |
| publicKey        | String  | 必填 | 公钥证书base64                                               |

请求示例：

```json
{
    "enterpriseUserId":1001,
    "certType":2,
    "publicKey":"ZXNHFUISGNZKXFG==...",
    "expiredTime":"2020-12-12 12:59:59"
}


```



### 22.3 返回结果

#### 22.3.1 正确响应

| 名称    | 类型   | 描述     |
| ------- | ------ | -------- |
| status  | int    | 响应码   |
| message | String | 响应结果 |

返回实例：

```json
{
    "status": 1,
    "message": "成功"
}
```

#### 22.3.2 错误响应

除1之外的响应码,均为失败


### 22.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |



# 二十三、Ukey签获取合同hash接口

### 23.1 接口地址

http://localhost:8080/apigate/contractapi/contract/getSignData

### 23.2 请求参数

#### 23.2.1 请求方法

POST

#### 23.2.2 请求体

| 名称             | 类型               | 约束 | 描述                                                         |
| ---------------- | ------------------ | ---- | ------------------------------------------------------------ |
| contractId       | Long               | 必填 | 合同ID                                                       |
| signerId         | Long               | 必填 | 签署人id（添加签署人接口返回）                               |
| signControls     | Map<String,String> | 必填 | 控件id、控件值<br/>根据控件类型填充不支持sealId:和base64:<br/>text传入文本<br/>pic传入base64<br/>autograph传入签名id<br/>signet传入印章id |
| docId            | Long               | 必填 | 合同文件id                                                   |
| pageNum          | integer            | 必填 | 页码 1-9999                                                  |
| publicKey        | String             | 必填 | 公钥证书base64                                               |
| textControlsFont | TextControlsFont   | 选填 | 文本控件字体属性(控件为text类型时必填)                       |

TextControlsFont文本控件字体属性

| 名称      | 类型    | 约束 | 描述                                  |
| --------- | ------- | ---- | ------------------------------------- |
| fontType  | Integer | 可填 | 字体类型：1宋体、2楷体、3黑体         |
| fontSize  | Float   | 可填 | 字体大小                              |
| fontColor | String  | 可填 | 字体颜色，格式：\#FF0000              |
| alignment | Integer | 可填 | 对齐方式：0左对齐，1居中对其，2右对齐 |

请求实例：

```json
{
    "contractId": 13000001,
    "signerId":1001,
    "pageNum":1,
    "docId":130000001,
    "signControls":{"1":"43453564646"},
    "publicKey":"KDSFSLwr2342353==.....",
    "textControlsFont":{
        "fontType":1,
        "fontSize":16,
        "fontColor":"#333333",
        "alignment":0
    }
}
```

### 23.3 返回结果

#### 23.3.1 正确响应

| 名称 | 类型   | 描述                       |
| ---- | ------ | -------------------------- |
| data | String | 待签署数据String类型base64 |

返回实例：

```json
{
    "status": 1,
    "data":{
        "data":"1zsw15zx51z"
    },
    "message": "成功"
}

```

#### 23.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 23.4 响应码

| 编号 | 描述                   |
| ---- | ---------------------- |
| 1    | 成功                   |
| 500  | 系统错误，请联系管理员 |



# 二十四、合同UKey签署合成

### 24.1 接口地址

http://localhost:8080/apigate/contractapi/contract/signByUkey

### 24.2 请求参数

#### 24.2.1 请求方法

POST

#### 24.2.2 请求体

| 名称      | 类型   | 约束 | 描述                           |
| --------- | ------ | ---- | ------------------------------ |
| hash      | String | 必填 | 合同文件原文hash（带签章外观） |
| signature | String | 必填 | 使用UKey签后的合同签名值       |



请求实例：

```json
{
    "hash":"KDSFSLwr2342353==.....",
    "signature":"sdsxswe2346553..."
}
```

### 24.3 返回结果

#### 24.3.1 正确响应

| 名称         | 类型       | 描述                                                         |
| ------------ | ---------- | ------------------------------------------------------------ |
| code         | String     | 合同编号                                                     |
| contractId   | Long       | 合同id                                                       |
| contractName | String     | 合同主题                                                     |
| status       | int        | 合同状态:0草稿、1.待签署，2.签署中，3.已完成，4.已过期，5.已解约，6.已拒签 |
| signers      | Signer[]   | 合同签署人                                                   |
| lastSignTime | date       | 最后签署时间                                                 |
| documents    | Document[] | 全部合同文件                                                 |

Signer签署人结构

| 名称       | 类型       | 描述                                                         |
| ---------- | ---------- | ------------------------------------------------------------ |
| userId     | Long       | 签署人用户id                                                 |
| userName   | String     | 合同签署人姓名                                               |
| signStatus | Integer    | 合同签署人签署状态：1.待他人签署，2 待我签（.签署中），3.已签署，5.已解约，6.已拒签 |
| docList    | Document[] | 合同文件                                                     |

Document文档体结构

| 名称    | 类型   | 描述         |
| ------- | ------ | ------------ |
| docId   | Long   | 合同文件Id   |
| docName | String | 合同文件名称 |

返回实例：

```json
{
    "status": 1,
    "data":{
        "code": "1020200620701056856",
        "contractId": 13000001,
        "contractName": "汽车购买交易合同",
        "status": 1,
        "lastSignTime": "2020-06-22",
         "documents": [
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    },
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    }
                ],
        "signers": [
            {
                "userId": 1100,
                "userName": "张三",
                "signStatus": 1,
                "docList": [
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    },
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    }
                ]
            }]
    },
    "message": "成功"
}
```

#### 24.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 24.4 响应码

| 编号 | 描述                   |
| ---- | ---------------------- |
| 1    | 成功                   |
| 500  | 系统错误，请联系管理员 |

# 二十五、撤回合同



### 25.1 接口地址

http://localhost:8080/apigate/contractapi/contract/revoke

### 25.2 请求参数

#### 25.2.1 请求方法

POST

#### 25.2.2 请求体

| 名称       | 类型 | 约束 | 描述   |
| ---------- | ---- | ---- | ------ |
| contractId | Long | 必填 | 合同id |

请求实例：

```json
{
    "contractId": 1000
}

```

### 25.3 返回结果

#### 25.3.1 正确响应

| 名称         | 类型       | 描述                                                         |
| ------------ | ---------- | ------------------------------------------------------------ |
| code         | String     | 合同编号                                                     |
| contractId   | Long       | 合同id                                                       |
| contractName | String     | 合同主题                                                     |
| status       | int        | 合同状态:0草稿、1.待签署，2.签署中，3.已完成，4.已过期，5.已解约，6.已拒签 |
| signers      | Signer[]   | 合同签署人                                                   |
| lastSignTime | date       | 最后签署时间                                                 |
| documents    | Document[] | 全部合同文件                                                 |

Signer签署人结构

| 名称       | 类型       | 描述                                                         |
| ---------- | ---------- | ------------------------------------------------------------ |
| userId     | String     | 签署人用户id                                                 |
| userName   | String     | 合同签署人姓名                                               |
| signStatus | Integer    | 合同签署人签署状态:1.待他人签署，2 待我签（.签署中），3.已签署，5.已解约，6.已拒签 |
| docList    | Document[] | 合同文档                                                     |

Document文档体结构

| 名称    | 类型   | 描述         |
| ------- | ------ | ------------ |
| docId   | Long   | 合同文件Id   |
| docName | String | 合同文件名称 |

返回实例：

```json
{
    "status": 200,
    "data":{
        "code": "1020200620701056856",
        "contractId": 13000001,
        "contractName": "汽车购买交易合同",
        "status": 1,
        "lastSignTime": "2020-06-22",
        "documents": [
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    },
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    }
                ],
        "signers": [
            {
                "userId": "1100",
                "userName": "张三",
                "signStatus": 1,
                "docList": [
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    },
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    }
                ]
            }]
    },
    "message": "成功"
}

```

#### 25.3.2 错误响应

除1之外的响应码,均为失败


### 25.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |



# 二十六、结束签署接口



### 26.1 接口地址

http://localhost:8080/apigate/contractapi/contract/finished

### 26.2 请求参数

#### 26.2.1 请求方法

POST

#### 26.2.2 请求体

| 名称       | 类型 | 约束 | 描述   |
| ---------- | ---- | ---- | ------ |
| contractId | Long | 必填 | 合同id |

请求实例：

```json
{
    "contractId": 1000,
}

```

### 26.3 返回结果

#### 26.3.1 正确响应

| 名称         | 类型       | 描述                                                         |
| ------------ | ---------- | ------------------------------------------------------------ |
| code         | String     | 合同编号                                                     |
| contractId   | Long       | 合同id                                                       |
| contractName | String     | 合同主题                                                     |
| status       | int        | 合同状态:0草稿、1.待签署，2.签署中，3.已完成，4.已过期，5.已解约，6.已拒签 |
| signers      | Signer[]   | 合同签署人                                                   |
| lastSignTime | date       | 最后签署时间                                                 |
| documents    | Document[] | 全部合同文件                                                 |

Signer签署人结构

| 名称       | 类型       | 描述                                                         |
| ---------- | ---------- | ------------------------------------------------------------ |
| userId     | String     | 签署人用户id                                                 |
| userName   | String     | 合同签署人姓名                                               |
| signStatus | Integer    | 合同签署人签署状态:1.待他人签署，2 待我签（.签署中），3.已签署，5.已解约，6.已拒签 |
| docList    | Document[] | 合同文档                                                     |

Document文档体结构

| 名称    | 类型   | 描述         |
| ------- | ------ | ------------ |
| docId   | Long   | 合同文件Id   |
| docName | String | 合同文件名称 |

返回实例：

```json
{
    "status": 1,
    "data":{
        "code": "1020200620701056856",
        "contractId": 13000001,
        "contractName": "汽车购买交易合同",
        "status": 1,
        "lastSignTime": "2020-06-22",
        "documents": [
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    },
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    }
                ],
        "signers": [
            {
                "userId": "1100",
                "userName": "张三",
                "signStatus": 1,
                "docList": [
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    },
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    }
                ]
            }]
    },
    "message": "成功"
}

```

#### 26.3.2 错误响应

除1之外的响应码,均为失败


### 26.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |



# 二十七、获取合同列表

### 27.1 接口地址

http://localhost:8080/apigate/contractapi/contract/contractList

### 27.2 请求参数

#### 27.2.1 请求方法

POST

#### 27.2.2 请求体

| 名称         | 类型    | 约束 | 描述                                                         |
| ------------ | ------- | ---- | ------------------------------------------------------------ |
| userId       | String  | 选填 | 用户id                                                       |
| enterpriseId | String  | 选填 | 企业id                                                       |
| bizCode      | String  | 选填 | 业务类型编号                                                 |
| status       | Integer | 选填 | 合同状态:0草稿、1.待签署，2.签署中，3.已完成，4.已过期，5.已解约，6.已拒签 |
| beginTime    | Long    | 选填 | 开始时间（创建时间）时间戳（毫秒）                           |
| endTime      | Long    | 选填 | 结束时间（创建时间）时间戳（毫秒）                           |
| pageNumber   | Integer | 选填 | 页码                                                         |
| pageSize     | Integer | 选填 | 每页记录数                                                   |



请求实例：

```json
{
	"nodeCode": "1020200620701056856",
    "pageNumber": 1,
    "pageSize": 10,
}
```

### 27.3 返回结果

#### 27.3.1 正确响应

| 名称        | 类型       | 描述         |
| ----------- | ---------- | ------------ |
| pageNumber  | Long       | 当前页码     |
| pageSize    | Long       | 每页记录数   |
| totalRecord | Long       | 总记录数     |
| totalPage   | Long       | 总页数       |
| list        | Contract[] | 合同数据列表 |

Contract数据结构体：

| 名称           | 类型    | 描述                                                         |
| -------------- | ------- | ------------------------------------------------------------ |
| contractId     | Long    | 合同id                                                       |
| code           | String  | 合同编号                                                     |
| contractName   | String  | 合同主题名称                                                 |
| status         | Integer | 合同状态:0草稿、1.待签署，2.签署中，3.已完成，4.已过期，5.已解约，6.已拒签 |
| createTime     | Date    | 合同创建时间                                                 |
| lastUpdateTime | Date    | 合同最后更新时间                                             |

返回实例：

```json
{
	"status": 1,
	"data": {
		"pageNumber": 3,
		"pageSize": 10,
		"totalRecord": 100,
		"totalPage": 10,
		"list": [{
			"contractId": 23432453535111123,
			"code": "1020200620701056856",
			"contractName": "员工劳动合同",
			"status": 2,
			"createTime": "2020-10-21",
			"lastUpdateTime": "2020-10-21"
		}]
	},
	"message": "成功"
}
```



#### 27.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 27.4 响应码

| 编号 | 描述                             |
| ---- | -------------------------------- |
| 1    | 成功                             |
| 500  | 系统错误，请联系管理员           |
| 1000 | 参数为空或不满足规则             |
| 2002 | 模板编号已存在                   |
| 2004 | 检查创建企业用户失败             |
| 2039 | 模板合同文件大小超过最大限制5MB  |
| 2053 | 业务类型错误或没有该业务类型权限 |



# 二十八、合同详情查询

### 28.1 接口地址

http://localhost:8080/apigate/contractapi/contract/search

### 28.2 请求参数

#### 28.2.1 请求方法

POST

#### 28.2.2 请求体

| 名称                 | 类型    | 约束 | 描述                                          |
| -------------------- | ------- | ---- | --------------------------------------------- |
| contractId           | Long    | 必填 | 合同id                                        |
| responseContractFile | Boolean | 选填 | 查询详情是否返回合同文件数据，默认false不返回 |

请求实例：

```json
{
    "contractId": 1000,
    "responseContractFile":true
}

```

### 28.3 返回结果

#### 28.3.1 正确响应

| 名称         | 类型       | 描述                                                         |
| ------------ | ---------- | ------------------------------------------------------------ |
| code         | String     | 合同编号                                                     |
| contractId   | Long       | 合同id                                                       |
| contractName | String     | 合同主题                                                     |
| status       | int        | 合同状态:0草稿、1.待签署，2.签署中，3.已完成，4.已过期，5.已解约，6.已拒签 |
| signers      | Signer[]   | 合同签署人                                                   |
| lastSignTime | Date       | 最后签署时间                                                 |
| documents    | Document[] | 全部合同文件                                                 |
| enterpriseId | String     | 企业id                                                       |

Signer签署人结构（区分企业和个人）

| 名称         | 类型       | 描述                                                         |
| ------------ | ---------- | ------------------------------------------------------------ |
| userId       | String     | 签署人用户id                                                 |
| userName     | String     | 合同签署人姓名                                               |
| signStatus   | Integer    | 合同签署人签署状态:1.待他人签署，2 待我签（.签署中），3.已签署，5.已解约，6.已拒签 |
| signerId     | Long       | 签署人表id                                                   |
| enterpriseId | String     | 签署人企业id                                                 |
| docList      | Document[] | 合同文档                                                     |

Document文档体结构

| 名称      | 类型   | 描述             |
| --------- | ------ | ---------------- |
| docId     | Long   | 合同文件Id       |
| docName   | String | 合同文件名称     |
| docBase64 | String | 合同文件base64   |
| filePath  | String | 合同文件归档路径 |

返回实例：

```json
{
    "status": 1,
    "data":{
        "code": "1020200620701056856",
        "contractId": 13000001,
        "contractName": "汽车购买交易合同",
        "status": 1,
        "lastSignTime": "2020-06-22",
        "documents": [
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议",
                        "docBase64":"BvJS13....",
                        "filePath":"ftp://127.0.0.1/test/贷款合同1.pdf"
                    },
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议",
                        "docBase64":"BvJS13....",
                        "filePath":"ftp://127.0.0.1/test/贷款合同2.pdf"
                    }
                ],
        "signers": [
            {	
                "signerId": 1100,
                "userId": "1100",
                "userName": "张三",
                "signStatus": 1,
                "enterpriseId": "L49056",
                "docList": [
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    },
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    }
                ]
            }]
    },
    "message": "成功"
}

```

#### 28.3.2 错误响应

除1之外的响应码,均为失败


### 28.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |



# 二十九、下载合同

### 29.1 接口地址

http://localhost:8080/apigate/contractapi/contract/downloadContract

### 29.2 请求参数

#### 29.2.1 请求方法

POST

#### 29.2.2 请求体

| 名称        | 类型       | 约束 | 描述                                         |
| ----------- | ---------- | ---- | -------------------------------------------- |
| contractId  | Long       | 选填 | 合同id                                       |
| type        | Integer    | 选填 | 下载类型  1 单个 2 批量 3 业务单号 默认1单个 |
| contractIds | List<Long> | 选填 | 合同id集合 type为2时必填                     |
| applyOrder  | String     | 选填 | 业务单号 type为3时必填                       |
| docIds      | List<Long> | 选填 | 文档id组                                     |

请求实例：

```json
{
    "contractId": 2335765768768,
    "docIds": [123,123]
}


```

### 29.3 返回结果

#### 29.3.1 正确响应

| 名称    | 类型   | 描述         |
| ------- | ------ | ------------ |
| data    | byte[] | 文件字节数组 |
| docName | String | 文件名称     |
| type    | String | .pdf/.zip    |

返回实例：

```json
{
    "status": 1,
    "data": {  
        "data": byte[],
        "docName":"测试.zip",
        "type":".zip"
    },
    "message": "成功"
}
```

#### 29.3.2 错误响应

```json
{
    "status": 9031,
    "data": {  
        
    },
    "message": "下载失败"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述


### 29.4 响应码

| 编号 | 描述                     |
| ---- | ------------------------ |
| 1    | 成功                     |
| 1000 | 参数为空或不满足规则     |
| 9030 | 该合同不存在合同文档     |
| 9031 | 下载失败                 |
| 5000 | 非法请求                 |
| 5023 | 只允许签署完成的合同下载 |

# 三十、获取关键字坐标

### 30.1 接口地址

http://localhost:8080/apigate/contractapi/contract/getKeywordCoordinates

### 30.2 请求参数

#### 30.2.1 请求方法

POST

#### 30.2.2 请求体

| 名称       | 类型   | 约束 | 描述                       |
| ---------- | ------ | ---- | -------------------------- |
| contractId | Long   | 必填 | 合同id                     |
| docId      | Long   | 必填 | 文档id                     |
| keyword    | String | 必填 | 关键字                     |
| pageNo     | String | 选填 | 1,2,3,-1(不填默认所有页码) |

请求实例：

```json
{"
    "contractId": 2335765768768,
    "keyword": "关键字",
    "docId":1335765768768,
    "pageNo":"1"
}


```

### 30.3 返回结果

#### 30.3.1 正确响应

| 名称               | 类型  | 描述                                             |
| ------------------ | ----- | ------------------------------------------------ |
| keywordCoordinates | Array | 关键字坐标信息数组，当数组为空时说明没有关键字。 |

关键字坐标信息结构：

| 名称   | 类型    | 描述                                        |
| ------ | ------- | ------------------------------------------- |
| x      | Float   | 关键字X轴坐标位置，从左上角开始的百分比坐标 |
| y      | Float   | 关键字Y轴坐标位置，从左上角开始的百分比坐标 |
| pageNo | Integer | 关键字所在页数                              |

**实例：**

返回实例：

```json
{
    "status": 1,
    "data": {
        "keywordCoordinates": [
            {
                "x": 0.39532354,
                "y": 0.76451445,
                "pageNo": 1
            },
            {
                "x": 0.3023987,
                "y": 0.1251663,
                "pageNo": 2
            },
            {
                "x": 0.36287037,
                "y": 0.1251663,
                "pageNo": 3
            }
        ]
    }
}
```

#### 30.3.2 错误响应

```json
{
    "status": 400,
    "data": {  
        
    },
    "message": "失败"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述


### 30.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |

# 三十一、签署结果回调通知

### 31.1 接口地址

对接方系统提供

### 31.2 请求参数

#### 31.2.1 请求方法

POST

#### 31.2.2 请求体

请求示例：

```json
{
        "code": "1020200620701056856",
        "contractId": 13000001,
        "contractName": "汽车购买交易合同",
        "status": 1,
        "lastSignTime": "2020-06-22",
        "documents": [
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    },
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    }
                ],
        "signers": [
            {
                "userId": "1100",
                "userName": "张三",
                "signStatus": 1,
                "docList": [
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    },
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    }
                ]
            }]
    }

```

请求体结构

| 名称         | 类型       | 描述                                                         |
| ------------ | ---------- | ------------------------------------------------------------ |
| code         | String     | 合同编号                                                     |
| contractId   | Long       | 合同id                                                       |
| contractName | String     | 合同主题                                                     |
| status       | int        | 合同状态:0草稿、1.待签署，2.签署中，3.已完成，4.已过期，5.已解约，6.已拒签 |
| signers      | Signer[]   | 合同签署人                                                   |
| lastSignTime | date       | 最后签署时间                                                 |
| documents    | Document[] | 合同所有文档列表                                             |

Signer签署人结构

| 名称       | 类型       | 描述                                                         |
| ---------- | ---------- | ------------------------------------------------------------ |
| userId     | Long       | 签署人id                                                     |
| userName   | String     | 合同签署人姓名                                               |
| signStatus | int        | 合同签署人签署状态：1.待他人签署，2 待我签（.签署中），3.已签署，5.已解约，6.已拒签 |
| docList    | Document[] | 签署人合同文档                                               |

Document文档体结构

| 名称    | 类型   | 描述         |
| ------- | ------ | ------------ |
| docId   | Long   | 合同文件Id   |
| docName | String | 合同文件名称 |

### 31.3 返回结果

#### 31.3.1 正确响应

| 名称    | 类型   | 描述     |
| ------- | ------ | -------- |
| status  | int    | 响应码   |
| message | String | 响应结果 |

除200之外的响应码,均为失败

返回实例：

```json
{
    "status": 200,
    "message": "成功"
}
```

#### 31.3.2 错误响应

**除200之外的响应码,均为失败**


### 31.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 200    | 成功 |
| 其他 | 失败 |

# 三十二、创建模板分类节点

### 32.1 接口地址

http://localhost:8080/apigate/contractapi/contractTemplate/createTypeNode

### 32.2 请求参数

#### 32.2.1 请求方法

POST

#### 32.2.2 请求体

| 名称           | 类型   | 约束 | 描述                                                         |
| -------------- | ------ | ---- | ------------------------------------------------------------ |
| nodeCode       | String | 必填 | 模板分类节点编号（1-16字符）                                 |
| nodeName       | String | 必填 | 模板分类节点名称（1-16字符）                                 |
| parentNodeCode | String | 选填 | 模板分类父节点编号（1-16字符）                               |
| extendData     | String | 选填 | 扩展数据，数据格式为json（key/value形式）例如：{"name":"张三"} |
| userId         | String | 必填 | 创建者用户id                                                 |
| enterpriseId   | String | 必填 | 创建者企业id                                                 |

请求实例：

```json
{
	"nodeCode": "1020200620701056856",
	"nodeName": "汽车购买交易合同",
    "parentNodeCode": "1020200620701056856",
	"extendData": {
		"docName": "员工保密协议",
		"base64": "3453QWFfds435..."
	},
	"userId": "1003",
	"enterpriseId": "1001"	
}
```

### 32.3 返回结果

#### 32.3.1 正确响应

| 名称     | 类型   | 描述             |
| -------- | ------ | ---------------- |
| nodeCode | String | 模板分类节点编号 |
| nodeName | String | 模板分类节点名称 |



返回实例

```json
{
	"status": 1,
	"data": {
		"nodeCode": "1020200620701056856",
		"nodeName": "员工劳动合同"
	},
	"message": "成功"
}
```



#### 32.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 32.4 响应码

| 编号 | 描述                                            |
| ---- | ----------------------------------------------- |
| 1    | 成功                                            |
| 500  | 系统错误，请联系管理员                          |
| 1000 | 参数为空或不满足规则                            |
| 3012 | 模板分类节点不存在                              |
| 3013 | 企业尚未开启设置分类，请在通配置-业务配置中开启 |
| 3014 | 默认模板业务分类下不可创建分类                  |
| 3018 | 业务类型参数错误                                |
| 3019 | 模板编号已存在                                  |



# 三十三、获取模板分类

### 33.1 接口地址

http://localhost:8080/apigate/contractapi/contractTemplate/getTypeNode

### 33.2 请求参数

#### 33.2.1 请求方法

POST

#### 33.2.2 请求体

| 名称         | 类型    | 约束 | 描述                                                       |
| ------------ | ------- | ---- | ---------------------------------------------------------- |
| nodeCode     | String  | 选填 | 模板分类节点编号                                           |
| nodeName     | String  | 选填 | 模板分类节点名称                                           |
| nodeLevel    | Integer | 选填 | 模板分类节点层级，默认查询1级                              |
| enterpriseId | String  | 必填 | 创建企业id(前置版本，该参数无效，可不传，系统默认主企业id) |

请求实例：

```json
{
	"nodeCode": "1020200620701056856",
	"nodeName": "汽车购买交易合同",
    "nodeLevel": 2,
    "enterpriseId":"1011"
}
```

### 33.3 返回结果

#### 33.3.1 正确响应

| 名称  | 类型   | 描述                 |
| ----- | ------ | -------------------- |
| nodes | Node[] | 模板多级分类节点集合 |

Node模板分类节点数据结构：

| 名称           | 类型   | 描述               |
| -------------- | ------ | ------------------ |
| nodeCode       | String | 模板分类节点编号   |
| nodeName       | String | 模板分类节点名称   |
| parentNodeCode | String | 模板分类父节点编号 |
| extendData     | String | 模板分类扩展数据   |



返回实例

```json
{
	"status": 1,
	"data": {
		"nodes": [{
			"nodeCode": "1020200620701056856",
			"nodeName": "员工劳动合同",
            "parentNodeCode": "1020200620701056856",
			"extendData": "扩展数据",
			"nodes": [{
				"nodeCode": "1020200620701056856",
				"nodeName": "员工劳动合同",
                "parentNodeCode": "1020200620701056856",
				"extendData": "扩展数据"
			}]
		}]
	},
	"message": "成功"
}

```



#### 33.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 33.4 响应码

| 编号 | 描述                   |
| ---- | ---------------------- |
| 1    | 成功                   |
| 500  | 系统错误，请联系管理员 |
| 1000 | 参数为空或不满足规则   |
| 3012 | 模板分类节点不存在     |
|      |                        |
|      |                        |
|      |                        |



# 三十四、创建合同模板

### 34.1 接口地址

http://localhost:8080/apigate/contractapi/contractTemplate/createTemplate

### 34.2 请求参数

#### 34.2.1 请求方法

POST

#### 34.2.2 请求体

| 名称           | 类型           | 约束 | 描述                                                         |
| -------------- | -------------- | ---- | ------------------------------------------------------------ |
| code           | String         | 选填 | 模板编号，如果用户没有传递系统会自动生成模板编号。模板编号不能重复（1-32字符） |
| name           | String         | 必填 | 模板名称 1-32字符，支持中文、英文大小写，数字、特殊字符      |
| docName        | String         | 必填 | 模板合同文档名称1-32字符，支持中文、英文大小写，数字、特殊字符必填 |
| base64         | String         | 必填 | 模板合同文件base64，最大不超过5MB，支持pdf/doc/docx文件格式  |
| lastFileType   | Integer        | 选填 | 合同终版文件类型：1PDF（默认）,2OFD；当该参数未传时，取业务类型中设置的合同终版文件类型，若业务类型中也未设置，则取系统默认设置（PDF）类型。<span style="color:#00ff00">(v4.7.0.0新增)</span> |
| bizCode        | String         | 选填 | 业务分类                                                     |
| validDays      | int            | 选填 | 签署有效期（天）默认180天。范围1-365天。当未传该参数时，看业务类型是否已设置，如未设置，默认90天，已设置，则取业务类型中设置的签署有效期； |
| signSortable   | boolean        | 选填 | 是否顺序签署:false无序（默认）、true有序                     |
| signers        | Signer[]       | 必填 | 模板合同签署方列表                                           |
| creator        | String         | 必填 | 创建人（用户id）（创建人必须实名，并且加入到此企业）         |
| enterpriseId   | String         | 必填 | 创建企业id                                                   |
| nodeCode       | String         | 选填 | 模板分类节点编号，不传该参数，则模板默认归属为默认分类节点   |
| extendData     | String         | 选填 | 扩展数据，数据格式为json（key/value形式）例如：{"name":"张三"} |
| waterMarkOff   | Boolean        | 选填 | 是否设置水印开关：false(不设置)，true(设置)；***\*若业务类型设置水印关闭，则水印无法设置\****,<br><font color=red>OFD本版本不支持水印功能</font> |
| waterMarkParam | WaterMarkParam | 选填 | 当waterMarkOff为true时，该参数必填                           |
| syncUrl        | String         | 选填 | 页面同步通知地址；                                           |
| asyncUrl       | String         | 选填 | 后台异步通知地址；                                           |
| htmlBase64     | String         | 选填 | html文件base64                                               |

Signer模板合同签署方数据结构：

| 名称       | 类型    | 约束 | 描述                                      |
| ---------- | ------- | ---- | ----------------------------------------- |
| signerRole | String  | 必填 | 模板签署方（角色与签署人类型要匹配）      |
| signerType | Integer | 必填 | 模板签署方类型：1个人，2企业，4，内部员工 |
| sequence   | Integer | 可填 | 签署方序号                                |

WaterMarkParam水印设置参数结构体：

| 名称                | 类型                | 约束 | 描述                                                         |
| ------------------- | ------------------- | ---- | ------------------------------------------------------------ |
| markName            | String              | 必填 | 水印名称(1-16个字符)                                         |
| markType            | String              | 必填 | 水印类型1文字2图片3二维码(注:根据类型取的对应参数)           |
| position            | Integer             | 选填 | 水印位置:1左上,2右上,3 左下 ,4右下, 5居中,6平铺,7填充（默认1左上）(注意二维码仅支持1左上,2右上,3 左下 ,4右下) |
| pdfTextMarkParams   | PdfTextMarkParams   | 选填 | 添加文本水印请求参数实体                                     |
| pdfImageMarkParams  | PdfImageMarkParams  | 选填 | 添加图片水印请求参数实体                                     |
| pdfQrCodeMarkParams | PdfQrCodeMarkParams | 选填 | 添加二维码水印请求参数实体                                   |

PdfTextMarkParams:添加文本水印请求参数实体

| 名称     | 类型   | 约束 | 描述                                                         |
| -------- | ------ | ---- | ------------------------------------------------------------ |
| text     | String | 必填 | 水印文字(1-16个字符)                                         |
| fontSize | Float  | 选填 | 文字大小：默认为12，取值范围[6.5,7.5,9,10.5,12,14,15,16,18,22,24,26,36] |
| color    | String | 选填 | 文字颜色 (色号)                                              |
| opacity  | Float  | 选填 | 透明度；范围：0至1；0：透明，1：不透明；默认为1；            |
| rotation | Float  | 选填 | 旋转角度，范围-180至180；正数：逆时针旋转，负数：顺时针旋转 默认（0°） |

PdfImageMarkParams:添加图片水印请求参数实体

| 名称                | 类型   | 约束 | 描述                                                         |
| ------------------- | ------ | ---- | ------------------------------------------------------------ |
| watermarkFileBase64 | String | 必填 | 图片文件(base64)                                             |
| width               | Float  | 选填 | 水印图片放在PDF上的宽度；如果不传，则为水印图片默认宽度；    |
| height              | Float  | 选填 | 水印图片放在PDF上的高度；如果不传，则为水印图片默认高度；    |
| opacity             | Float  | 选填 | 透明度；范围：0至1；0：透明，1：不透明；如果不传，默认为1；如果小于0，默认为0；如果大于1，默认为1；关键字 |
| rotation            | Float  | 选填 | 旋转角度，范围-180至180；正数：逆时针旋转，负数：顺时针旋转  默认（0°） |

PdfQrCodeMarkParams:添加二维码水印请求参数实体

| 名称         | 类型    | 约束 | 描述                                                     |
| ------------ | ------- | ---- | -------------------------------------------------------- |
| qrCodeWidth  | Float   | 选填 | 二维码宽度，默认86px                                     |
| qrCodeHeight | Float   | 选填 | 二维码高度，默认86px                                     |
| viewRange    | Integer | 选填 | 二维码查看范围（0:公开文档；1:文件参与人与管理员可查看） |

请求实例：

```json
{
	"code": "1020200620701056856",
	"name": "汽车购买交易合同",
	"docName": "员工保密协议",
	"base64": "3453QWFfds435...",
	"bizCode": "common",
	"creator": "1003",
	"enterpriseId": "1001",
	"validDays": 180,
	"signSortable": true,
	"signers": [{
			"signerRole": "甲方",
			"signerType": 1,
			"sequence": 1
		},
		{
			"signerRole": "乙方",
			"signerType": 2,
			"sequence": 2
		}
	],
    "syncUrl": "http://www.baidu.com",
	"asyncUrl": "http://www.baidu.com"
}
```

### 34.3 返回结果

#### 34.3.1 正确响应

| 名称       | 类型       | 描述             |
| ---------- | ---------- | ---------------- |
| templateId | Long       | 模板id           |
| code       | string     | 模板编号         |
| name       | String     | 模板名称         |
| docList    | Document[] | 模板合同文档列表 |
| signers    | Signer[]   | 模板签署方列表   |

模板合同文档列表Document数据结构：

| 名称    | 类型   | 描述             |
| ------- | ------ | ---------------- |
| docId   | Long   | 模板合同文档id   |
| docName | String | 模板合同文档名称 |

Signer模板合同签署方数据结构：

| 名称       | 类型    | 描述                                      |
| ---------- | ------- | ----------------------------------------- |
| signerRole | String  | 模板签署方                                |
| signerType | Integer | 模板签署方类型：1个人，2企业，4，内部员工 |
| sequence   | Integer | 签署方序号:                               |

返回实例：

```json
{
	"status": 1,
	"data": {
		"templateId": 23432453535111123,
		"code": "1020200620701056856",
		"name": "员工劳动合同",
		"docList": [{
			"docId": 2343453535,
			"docName": "员工保密协议"
		}],
        "signers": [{
			"signerRole": "甲方",
			"signerType": 1,
			"sequence": 1
		},
		{
			"signerRole": "乙方",
			"signerType": 2,
			"sequence": 2
		}]
	},
	"message": "成功"
}
```



#### 34.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 34.4 响应码

| 编号 | 描述                             |
| ---- | -------------------------------- |
| 1    | 成功                             |
| 500  | 系统错误，请联系管理员           |
| 1000 | 参数为空或不满足规则             |
| 2002 | 模板编号已存在                   |
| 2004 | 检查创建企业用户失败             |
| 2039 | 模板合同文件大小超过最大限制5MB  |
| 2053 | 业务类型错误或没有该业务类型权限 |



# 三十五、上传模板文件

### 35.1 接口地址

http://localhost:8080/apigate/contractapi/contractTemplate/uploadFile

### 35.2 请求参数

#### 35.2.1 请求方法

POST

#### 35.2.2 请求体

| 名称         | 类型   | 约束 | 描述                                                         |
| ------------ | ------ | ---- | ------------------------------------------------------------ |
| code         | String | 必填 | 模板编号                                                     |
| docName      | String | 必填 | 模板合同文档名称1-32字符，支持中文、英文大小写，数字、特殊字符必填 |
| templateFile | String | 必填 | 模板合同文件（base64），支持pdf/doc/docx文件格式             |
| sequence     | int    | 选填 | 模板合同文件排序序号（此序号用于多文件场景，无多文件场景可不传递） |
| enterpriseId | String | 必填 | 模板所属企业id;                                              |



请求实例：

```json
{
    "code": "1020200620701056856",
    "docName":"员工保密协议",
    "templateFile": 合同文件base64,
    "enterpriseId": "10030"
}

```

### 35.3 返回结果

#### 35.3.1 正确响应

| 名称       | 类型       | 描述                  |
| ---------- | ---------- | --------------------- |
| templateId | Long       | 模板id                |
| code       | String     | 模板编号              |
| name       | String     | 模板名称              |
| status     | Integer    | 模板状态:1启用、2停用 |
| docList    | Document[] | 模板合同文件列表      |

Document合同文件结构

| 名称    | 类型   | 描述         |
| ------- | ------ | ------------ |
| docId   | Long   | 合同文档id   |
| docName | String | 合同文档名称 |

返回实例

```json
{
    "status":1,
    "data":{
        "templateId":23432453535111123,
        "code":"1020200620701056856",
        "name":"员工劳动合同模板",
        "status":1,
        "docList":[{ 
            "docId":2343453535,
       		"docName":"员工保密协议"
        }]
       
    },
    "message":"成功"
}

```

#### 35.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 35.4 响应码

| 编号 | 描述                               |
| ---- | ---------------------------------- |
| 1    | 成功                               |
| 500  | 系统错误，请联系管理员             |
| 2003 | 模板不存在                         |
| 2008 | 模板合同上传失败，文件保存异常     |
| 2039 | 模板合同文件大小超过最大限制       |
| 2049 | 模板合同文件总数超过最大限制       |
| 2050 | 模板合同文档名称已存在，不可以重复 |

# 三十六、启用、停用模板

### 36.1 接口地址

http://localhost:8080/apigate/contractapi/contractTemplate/onOrOffTemplate

### 36.2 请求参数

#### 36.2.1 请求方法

POST

#### 36.2.2 请求体

| 名称         | 类型    | 约束 | 描述                  |
| ------------ | ------- | ---- | --------------------- |
| code         | String  | 必填 | 模板编号              |
| enterpriseId | String  | 必填 | 模板所属企业id;       |
| status       | Integer | 必填 | 模板状态:1启用、2停用 |



请求实例：

```json
{
    "code": "1020200620701056856",
    "enterpriseId": "10030",
    "status": 1,
}

```

### 36.3 返回结果

#### 36.3.1 正确响应

| 名称   | 类型    | 描述                  |
| ------ | ------- | --------------------- |
| code   | String  | 模板编号              |
| name   | String  | 模板名称              |
| status | Integer | 模板状态:1启用、2停用 |



返回实例

```json
{
    "status":1,
    "data":{
        "code":"1020200620701056856",
        "name":"员工劳动合同模板",
        "status":1   
    },
    "message":"成功"
}

```

#### 36.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 36.4 响应码

| 编号 | 描述                   |
| ---- | ---------------------- |
| 1    | 成功                   |
| 500  | 系统错误，请联系管理员 |
| 2003 | 模板不存在             |
|      |                        |
|      |                        |



# 三十七、设置合同模板签署控件

### 37.1 接口地址

http://localhost:8080/apigate/contractapi/contractTemplate/setSignControls

### 37.2 请求参数

#### 37.2.1 请求方法

POST

#### 37.2.2 请求体

| 名称         | 类型     | 约束 | 描述       |
| ------------ | -------- | ---- | ---------- |
| code         | String   | 必填 | 模板编号   |
| enterpriseId | String   | 必填 | 企业id     |
| signers      | Signer[] | 必填 | 模板签署方 |

Signer模板合同签署方数据结构：

| 名称       | 类型       | 约束 | 描述                                                         |
| ---------- | ---------- | ---- | ------------------------------------------------------------ |
| signerRole | String     | 必填 | 模板签署方（角色与签署人类型要匹配，$\color{#FF0000}{当签署方为“补充变量”时，只允许文本类型坐标轴控件}$） |
| signFiles  | SignFile[] | 必填 | 模板签署方签署文件列表及控件                                 |

SignFile模板签署方签署文件及控件数据结构：

| 名称              | 类型                | 约束 | 描述           |
| ----------------- | ------------------- | ---- | -------------- |
| docId             | Long                | 必填 | 模板合同文档Id |
| xySignControls    | XYSignControls[]    | 可填 | 坐标控件       |
| crossSignControls | CrossSignControls[] | 可填 | 骑缝章控件     |

坐标轴签署控件XYSignControls：

| 名称    | 类型   | 约束 | 描述                                                         |
| ------- | ------ | ---- | ------------------------------------------------------------ |
| key     | String | 必填 | 控件key，不可重复                                            |
| type    | String | 必填 | 控件类型                                                     |
| pageNum | String | 必填 | 数字字符（一个数字字符）                                     |
| x       | Float  | 必填 | 横坐标x，原点为左上角，浮点数，0-1，PDF位置比例              |
| y       | Float  | 必填 | 纵坐标y，原点为左上角，浮点数，0-1，PDF位置比例              |
| width   | Float  | 可填 | 控件宽（单位：cm），印章、图片控件，可不填，默认为图片的宽度 |
| height  | Float  | 可填 | 控件高（单位：cm），印章、图片控件，可不填，默认为图片的高度 |

骑缝签署控件CrossSignControls：（$\color{#FF0000}{接口UKey签不支持该控件}$）

| 名称   | 类型   | 约束 | 描述                                                         |
| ------ | ------ | ---- | ------------------------------------------------------------ |
| key    | String | 必填 | 控件key，不可重复                                            |
| y      | Float  | 必填 | 纵坐标y，印章左上角距离文档上边缘的距离（cm），<br />默认印章垂直居中 |
| width  | Float  | 可填 | 控件宽（单位：cm），默认为图片的宽度                         |
| height | Float  | 可填 | 控件高（单位：cm），默认为图片的高度                         |

请求实例：

```json
{
	"code": "1020200620701056856",
    "enterpriseId": "10206",
	"signers": [{
			"signerRole": "文本补充变量",
			"signFiles": [{
				"docId": 343465645,
				"xySignControls": [{
						"key": "文本1",
						"type": "text",
						"pageNum": 1,
						"x": 0.04,
						"y": 0.6
					},
					{
						"key": "文本2",
						"type": "text",
						"pageNum": 2,
						"x": 0.04,
						"y": 0.6
					}
				]
			}]
		},
		{
			"signerRole": "甲方",
			"signFiles": [{
				"docId": 343465645,
				"xySignControls": [{
						"key": "文本1",
						"type": "text",
						"pageNum": 1,
						"x": 0.04,
						"y": 0.6
					},
					{
						"key": "签章1",
						"type": "signet",
						"pageNum": 2,
						"x": 0.04,
						"y": 0.6
					},
					{
						"key": "日期1",
						"type": "date",
						"pageNum": 2,
						"x": 0.03,
						"y": 0.5
					}
				]
			}]
		},
		{
			"signerRole": "乙方",
			"signFiles": [{
				"docId": 343465645,
				"crossSignControls": [{
					"key": "骑缝章",
					"pageNum": 1,
					"y": 0.6
				}]
			}]
		}
	]
}
```

### 37.3 返回结果

#### 37.3.1 正确响应

| 名称       | 类型       | 描述             |
| ---------- | ---------- | ---------------- |
| templateId | Long       | 模板id           |
| code       | String     | 模板编号         |
| name       | String     | 模板名称         |
| docList    | Document[] | 模板合同文档列表 |
| signers    | Signer[]   | 模板签署方       |

模板合同文档列表Document数据结构：

| 名称    | 类型   | 描述             |
| ------- | ------ | ---------------- |
| docId   | Long   | 模板合同文档id   |
| docName | String | 模板合同文档名称 |

模板签署方列表Signer数据结构：

| 名称       | 类型     | 描述                                                   |
| ---------- | -------- | ------------------------------------------------------ |
| signerRole | String   | 模板签署方                                             |
| signerType | Integer  | 模板签署方类型：1个人，2企业，3文本补充变量，4内部员工 |
| signFiles  | SignFile | 模板签署方已设置控件的文件列表                         |

SignFile模板签署方签署文件及控件数据结构：

| 名称              | 类型                | 描述           |
| ----------------- | ------------------- | -------------- |
| docId             | Long                | 模板合同文档Id |
| xySignControls    | XYSignControls[]    | 坐标控件       |
| crossSignControls | CrossSignControls[] | 骑缝章控件     |

坐标轴签署控件XYSignControls：

| 名称    | 类型   | 描述                                                         |
| ------- | ------ | ------------------------------------------------------------ |
| key     | String | 控件key，不可重复                                            |
| type    | String | 控件类型                                                     |
| pageNum | String | 多页签时为必填项 指定盖章页， 0：所有页盖章 -1：最后一页，支持：1，2，3，4，5，-1 |
| x       | Float  | 横坐标x，原点为左上角，浮点数，0-1，PDF位置比例              |
| y       | Float  | 纵坐标y，原点为左上角，浮点数，0-1，PDF位置比例              |
| width   | Float  | 控件宽（单位：cm），印章、图片控件，可不填，默认为图片的宽度 |
| height  | Float  | 控件高（单位：cm），印章、图片控件，可不填，默认为图片的高度 |

骑缝签署控件CrossSignControls：（$\color{#FF0000}{接口UKey签不支持该控件}$）

| 名称   | 类型   | 描述                                                         |
| ------ | ------ | ------------------------------------------------------------ |
| key    | String | 控件key，不可重复                                            |
| y      | Float  | 纵坐标y，印章左上角距离文档上边缘的距离（cm），<br />默认印章垂直居中 |
| width  | Float  | 控件宽（单位：cm），默认为图片的宽度                         |
| height | Float  | 控件高（单位：cm），默认为图片的高度                         |

返回实例

```json
{
	"status": 1,
	"data": {
		"templateId": 23432453535111123,
		"code": "1020200620701056856",
		"name": "员工劳动合同",
		"docList": [{
			"docId": 2343453535,
			"docName": "员工保密协议"
		}],
        "signers": [{
			"signerRole": "文本补充变量",
            "signerType": 3,
			"signFiles": [{
				"docId": 343465645,
				"xySignControls": [{
						"key": "文本1",
						"type": "text",
						"pageNum": 1,
						"x": 0.04,
						"y": 0.6
					},
					{
						"key": "文本2",
						"type": "text",
						"pageNum": 2,
						"x": 0.04,
						"y": 0.6
					}
				]
			}]
		},
		{
			"signerRole": "甲方",
            "signerType": 2,
			"signFiles": [{
				"docId": 343465645,
				"xySignControls": [{
						"key": "文本1",
						"type": "text",
						"pageNum": 1,
						"x": 0.04,
						"y": 0.6
					},
					{
						"key": "签章1",
						"type": "signet",
						"pageNum": 2,
						"x": 0.04,
						"y": 0.6
					},
					{
						"key": "日期1",
						"type": "date",
						"pageNum": 2,
						"x": 0.03,
						"y": 0.5
					}
				]
			}]
		},
		{
			"signerRole": "乙方",
            "signerType": 2,
			"signFiles": [{
				"docId": 343465645,
				"crossSignControls": [{
					"key": "骑缝章",
					"pageNum": 1,
					"y": 0.6
				}]
			}]
		}
	]},
	"message": "成功"
}
```



#### 37.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 37.4 响应码

| 编号 | 描述                   |
| ---- | ---------------------- |
| 1    | 成功                   |
| 500  | 系统错误，请联系管理员 |
| 1000 | 参数为空或不满足规则   |
|      |                        |
|      |                        |
|      |                        |
|      |                        |



# 三十八、删除合同模板

### 38.1 接口地址

http://localhost:8080/apigate/contractapi/contractTemplate/delete

### 38.2 请求参数

#### 38.2.1 请求方法

POST

#### 38.2.2 请求体

| 名称         | 类型   | 约束 | 描述                 |
| ------------ | ------ | ---- | -------------------- |
| code         | String | 必填 | 模板编号（1-32字符） |
| enterpriseId | String | 必填 | 模板所属企业id       |

请求实例：

```json
{
	"code": "1020200620701056856",
    "enterpriseId":"10002"
}
```

### 38.3 返回结果

#### 38.3.1 正确响应

| 名称   | 类型 | 描述                           |
| ------ | ---- | ------------------------------ |
| status | Long | 状态码1:删除成功，其它删除失败 |

返回实例

```json
{
	"status": 1,
	"data": {
	},
	"message": "成功"
}
```



#### 38.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 38.4 响应码

| 编号 | 描述                   |
| ---- | ---------------------- |
| 1    | 成功                   |
| 500  | 系统错误，请联系管理员 |
| 1000 | 参数为空或不满足规则   |
|      |                        |
|      |                        |
|      |                        |
|      |                        |

# 三十九、编辑合同模板

### 39.1 接口地址

http://localhost:8080/apigate/contractapi/contractTemplate/updateTemplate

### 39.2 请求参数

#### 39.2.1 请求方法

POST

#### 39.2.2 请求体

| 名称         | 类型   | 约束 | 描述                 |
| ------------ | ------ | ---- | -------------------- |
| code         | String | 必填 | 模板编号（1-32字符） |
| enterpriseId | String | 必填 | 模板所属企业         |



请求实例：

```json
{
	"code": "1020200620701056856",
    "enterpriseId": "10202006",
	
}
```

### 39.3 返回结果

#### 39.3.1 正确响应

| 名称               | 类型   | 描述        |
| ------------------ | ------ | ----------- |
| code               | string | 模板编号    |
| name               | String | 模板名称    |
| settingControlsURL | String | 设置控件Url |



返回实例：

```json
{
	"status": 1,
	"data": {
		"code": "1020200620701056856",
		"name": "员工劳动合同",
        "settingControlsURL":"http://192.168.1.1/contractapi"
	},
	"message": "成功"
}
```



#### 39.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 39.4 响应码

| 编号 | 描述                   |
| ---- | ---------------------- |
| 1    | 成功                   |
| 500  | 系统错误，请联系管理员 |
| 1000 | 参数为空或不满足规则   |
| 3002 | 模板不存在             |
| 3015 | 模板启用状态不能编辑   |
|      |                        |
|      |                        |



# 四十、获取模板详细信息

### 40.1 接口地址

http://localhost:8080/apigate/contractapi/contractTemplate/templateDetails

### 40.2 请求参数

#### 40.2.1 请求方法

POST

#### 40.2.2 请求体

| 名称         | 类型   | 约束 | 描述           |
| ------------ | ------ | ---- | -------------- |
| code         | String | 必填 | 模板编号       |
| enterpriseId | String | 必填 | 模板所属企业id |



请求实例：

```json
{
	"code": "1020200620701056856",
    "enterpriseId": "10202"
}
```

### 40.3 返回结果

#### 40.3.1 正确响应

| 名称       | 类型       | 描述                                |
| ---------- | ---------- | ----------------------------------- |
| templateId | Long       | 模板id                              |
| code       | String     | 模板编号                            |
| name       | String     | 模板名称                            |
| needSign   | Boolean    | 是否需要签署：false不需要、true需要 |
| nodeCode   | String     | 所属分类节点编号                    |
| docList    | Document[] | 模板合同文档列表                    |
| signerList | Signer[]   | 模板签署方列表                      |

模板合同文档列表Document数据结构：

| 名称       | 类型   | 描述             |
| ---------- | ------ | ---------------- |
| docId      | Long   | 模板合同文档id   |
| docName    | String | 模板合同文档名称 |
| htmlBase64 | String | html合同文件     |
| docUrl     | String | 合同文档访问url  |

Signer模板合同签署方数据结构：

| 名称       | 类型       | 描述                                               |
| ---------- | ---------- | -------------------------------------------------- |
| signerRole | String     | 模板签署方                                         |
| signerType | Integer    | 模板签署方类型：1个人，2企业，3文本补充，4内部员工 |
| sequence   | Integer    | 签署方序号                                         |
| signFiles  | SignFile[] | 签署的合同文档                                     |

SignFile模板签署方签署文件及控件数据结构：

| 名称              | 类型                | 描述           |
| ----------------- | ------------------- | -------------- |
| docId             | Long                | 模板合同文档Id |
| xySignControls    | XYSignControls[]    | 坐标控件       |
| crossSignControls | CrossSignControls[] | 骑缝章控件     |

坐标轴签署控件XYSignControls：

| 名称    | 类型   | 描述                                                         |
| ------- | ------ | ------------------------------------------------------------ |
| key     | String | 控件key                                                      |
| type    | String | 控件类型                                                     |
| pageNum | String | 多页签时为必填项 指定盖章页， 0：所有页盖章 -1：最后一页，支持：1，2，3，4，5，-1 |
| x       | Float  | 横坐标x，原点为左上角，浮点数，0-1，PDF位置比例              |
| y       | Float  | 纵坐标y，原点为左上角，浮点数，0-1，PDF位置比例              |
| width   | Float  | 控件宽（单位：cm），印章、图片控件，可不填，默认为图片的宽度 |
| height  | Float  | 控件高（单位：cm），印章、图片控件，可不填，默认为图片的高度 |

骑缝签署控件CrossSignControls：（$\color{#FF0000}{接口UKey签不支持该控件}$）

| 名称   | 类型   | 约束 | 描述                                                         |
| ------ | ------ | ---- | ------------------------------------------------------------ |
| key    | String | 必填 | 控件key，不可重复                                            |
| y      | Float  | 必填 | 纵坐标y，印章左上角距离文档上边缘的距离（cm），<br />默认印章垂直居中 |
| width  | Float  | 可填 | 控件宽（单位：cm），默认为图片的宽度                         |
| height | Float  | 可填 | 控件高（单位：cm），默认为图片的高度                         |

返回实例：

```json
{
	"status": 1,
	"data": {
		"templateId": 23432453535111123,
		"code": "1020200620701056856",
		"name": "员工劳动合同",
		"docList": [{
			"docId": 2343453535,
			"docName": "员工保密协议"
		}],
        "signerList": [{
			"signerRole": "甲方",
			"signerType": 1,
			"sequence": 1,
            "signFiles": [{
			"docId": 343465645,
			"xySignControls": [{
					"id": 1,
					"type": "text",
					"pageNum": 1,
					"x": 0.04,
					"y": 0.6
				},
				{
					"id": 2,
					"type": "signet",
					"pageNum": 2,
					"x": 0.04,
					"y": 0.6
				},
				{
					"id": 3,
					"type": "date",
					"pageNum": 2,
					"x": 0.03,
					"y": 0.5
				}
			],
			"keywordSignControls": [{
				"id": 1,
				"type": "signet",
				"pageNum": 2,
				"keyword": "盖章",
				"offsetX": 0.03,
				"offsetY": 0.5
			}]
		}]
		},
		{
			"signerRole": "乙方",
			"signerType": 2,
			"sequence": 2,
            "signFiles": [{
			"docId": 343465645,
			"xySignControls": [{
					"id": 1,
					"type": "text",
					"pageNum": 1,
					"x": 0.04,
					"y": 0.6
				},
				{
					"id": 2,
					"type": "signet",
					"pageNum": 2,
					"x": 0.04,
					"y": 0.6
				},
				{
					"id": 3,
					"type": "date",
					"pageNum": 2,
					"x": 0.03,
					"y": 0.5
				}
			],
			"keywordSignControls": [{
				"id": 1,
				"type": "signet",
				"pageNum": 2,
				"keyword": "盖章",
				"offsetX": 0.03,
				"offsetY": 0.5
			}]
		}]
		}]
	},
	"message": "成功"
}
```



#### 40.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 40.4 响应码

| 编号 | 描述                             |
| ---- | -------------------------------- |
| 1    | 成功                             |
| 500  | 系统错误，请联系管理员           |
| 1000 | 参数为空或不满足规则             |
| 2002 | 模板编号已存在                   |
| 2004 | 检查创建企业用户失败             |
| 2039 | 模板合同文件大小超过最大限制5MB  |
| 2053 | 业务类型错误或没有该业务类型权限 |

# 四十一、获取模板列表

### 41.1 接口地址

http://localhost:8080/apigate/contractapi/contractTemplate/templatePageList

### 41.2 请求参数

#### 41.2.1 请求方法

POST

#### 41.2.2 请求体

| 名称         | 类型    | 约束 | 描述                     |
| ------------ | ------- | ---- | ------------------------ |
| nodeCode     | String  | 选填 | 模板分类节点编号         |
| bizCode      | String  | 选填 | 业务类型                 |
| creator      | String  | 选填 | 模板创建者id             |
| enterpriseId | String  | 必填 | 模板创建企业id           |
| beginTime    | Long    | 选填 | 开始时间（模板创建时间） |
| endTime      | Long    | 选填 | 结束时间（模板创建时间） |
| pageNumber   | Integer | 选填 | 页码                     |
| pageSize     | Integer | 选填 | 每页记录数               |



请求实例：

```json
{
	"nodeCode": "1020200620701056856",
    "creator":"1001",
    "enterpriseId":"1101",
    "beginTime":"2020-09-01",
    "endTime":"2020-10-31",
    "pageNumber": 1,
    "pageSize": 10,
}
```

### 41.3 返回结果

#### 41.3.1 正确响应

| 名称        | 类型               | 描述             |
| ----------- | ------------------ | ---------------- |
| pageNumber  | Long               | 当前页码         |
| pageSize    | Long               | 每页记录数       |
| totalRecord | Long               | 总记录数         |
| totalPage   | Long               | 总页数           |
| list        | ContractTemplate[] | 合同模板数据列表 |

ContractTemplate合同模板数据结构：

| 名称       | 类型    | 描述                  |
| ---------- | ------- | --------------------- |
| templateId | Long    | 模板id                |
| code       | string  | 模板编号              |
| name       | String  | 模板名称              |
| status     | Integer | 模板状态:1启用、2停用 |
| extendData | String  | 扩展数据              |
| createTime | Date    | 模板创建时间          |



返回实例

```json
{
	"status": 1,
	"data": {
		"pageNumber": 2,
		"pageSize": 10,
		"totalRecord": 100,
		"totalPage": 10,
		"list": [{
			"templateId": 23432453535111123,
			"code": "1020200620701056856",
			"name": "员工劳动合同模板",
			"status": 1,
			"createTime": "2020-10-21"
		}]
	},
	"message": "成功"
}
```



#### 41.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 41.4 响应码

| 编号 | 描述                   |
| ---- | ---------------------- |
| 1    | 成功                   |
| 500  | 系统错误，请联系管理员 |
| 1000 | 参数为空或不满足规则   |
|      |                        |
|      |                        |
|      |                        |
|      |                        |



# 四十二、修改模板控件通知回调

### 42.1 接口地址

第三方提供（入参只返回修改成功与否状态）

### 42.2 请求参数

#### 42.2.1 请求方法

POST

#### 42.2.2 请求体

| 名称   | 类型    | 约束 | 描述                  |
| ------ | ------- | ---- | --------------------- |
| code   | String  | 必填 | 模板编号              |
| name   | String  | 必填 | 模板名称              |
| status | Integer | 必填 | 模板状态:1启用、2停用 |



请求实例：

```json
{
	"status": 1,
	"data": {
		"code": "1020200620701056856",
		"name": "员工劳动合同",
        "status": 1
	},
	"message": "成功"
}
```

### 42.3 返回结果

#### 42.3.1 正确响应

| 名称    | 类型   | 描述     |
| ------- | ------ | -------- |
| status  | int    | 响应码   |
| message | String | 响应结果 |

返回实例：

```json
{
    "status": 1,
    "message": "成功"
}
```

#### 42.3.2 错误响应

除1之外的响应码,均为失败


### 42.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |

# 四十三、数据固化接口

### 43.1 接口地址

http://localhost:8080/apigate/contractapi/law/solidify

### 43.2 请求参数

#### 43.2.1 请求方法

POST

#### 43.2.2 请求体

| 名称                | 类型       | 约束 | 描述                                                         |
| ------------------- | ---------- | ---- | ------------------------------------------------------------ |
| applyOrder          | String     | 选填 | 系统业务单号(不填申请后自动生成 , 填后追加数据)              |
| enterpriseId        | String     | 选填 | 企业id   enterpriseId和userId二选一                          |
| userId              | String     | 选填 | 用户id   enterpriseId和userId二选一                          |
| contractIds         | List<Long> | 必填 | 合同id集合，本期只支持一个合同id                             |
| signerIds           | List<Long> | 选填 | 签署人id 不填默认所有，本期不做处理                          |
| fileType            | Integer    | 必填 | 文件类型 1 hash 2 原文 本期只支持hash                        |
| legalInstrumentType | Integer    | 选填 | 法律文书类型(默认见证报告),<br/>支持1、见证报告 2、取证报告3、存证报告(本期不支持存证报告) |
| signLocation        | String     | 选填 | 签署地点                                                     |

请求实例：

```json
{
		"applyOrder": "123123123",
    	"userType":2,
		"enterpriseId": "asdasd",
		"contractIds": [],
    	"signerIds":[],
    	"fileType":1,
    	"signLocation":"北京"
}
```

### 43.3 返回结果

#### 43.3.1 正确响应

| 名称    | 类型   | 描述     |
| ------- | ------ | -------- |
| status  | int    | 响应码   |
| message | String | 响应结果 |

返回实例：

```json
{
    "status": 1,
    "message": "成功",
    data:{
        "applyOrder":"业务单号"
    }
}
```

#### 43.3.2 错误响应

除1之外的响应码,均为失败


### 43.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |

# 四十四、取证报告申请接口

### 44.1 接口地址

http://localhost:8080/apigate/contractapi/law/applyObtainEvidenceReport

### 44.2 请求参数

#### 44.2.1 请求方法

POST

#### 44.2.2 请求体

| 名称       | 类型   | 约束 | 描述         |
| ---------- | ------ | ---- | ------------ |
| applyOrder | String | 必填 | 系统业务单号 |

请求实例：

```json
{
		"applyOrder": "123123123"
}
```

### 44.3 返回结果

#### 44.3.1 正确响应

| 名称    | 类型   | 描述     |
| ------- | ------ | -------- |
| status  | int    | 响应码   |
| message | String | 响应结果 |

返回实例：

```json
{
    "status": 1,
    "message": "成功",
    data:{}
}
```

#### 44.3.2 错误响应

除1之外的响应码,均为失败


### 44.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |



# 四十五、获取见证报告接口

### 45.1 接口地址

http://localhost:8080/apigate/contractapi/law/getWitnessReport

### 45.2 请求参数

#### 45.2.1 请求方法

POST

#### 45.2.2 请求体

| 名称       | 类型   | 约束 | 描述             |
| ---------- | ------ | ---- | ---------------- |
| applyOrder | String | 必填 | 客户唯一业务单号 |

请求实例：

```json
{
	"applyOrder": "201801010001"
}
```

### 45.3 返回结果

#### 45.3.1 正确响应

| 名称    | 类型   | 描述     |
| ------- | ------ | -------- |
| status  | int    | 响应码   |
| message | String | 响应结果 |

返回实例：

```json
{
    "status": 1,
    "message": "成功",
    "data":{
        stage:”40”,  //当前的状态 40:已受理  79:已出具见证报告，此状态会返回见证报告
		report: {  //见证报告
			fileContent:"base64文件”,
			fileType:"pdf",//文件类型,
			fileName:"见证报告//文件名称”
       }
    }
}
```

#### 45.3.2 错误响应

除1之外的响应码,均为失败


### 45.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |

# 四十六、获取取证报告接口

### 46.1 接口地址

http://localhost:8080/apigate/contractapi/law/getObtainEvidenceReport

### 46.2 请求参数

#### 46.2.1 请求方法

POST

#### 46.2.2 请求体

| 名称       | 类型   | 约束 | 描述             |
| ---------- | ------ | ---- | ---------------- |
| applyOrder | String | 必填 | 客户唯一业务单号 |

请求实例：

```json
{
	"applyOrder": "201801010001"
}
```

### 46.3 返回结果

#### 46.3.1 正确响应

| 名称    | 类型   | 描述     |
| ------- | ------ | -------- |
| status  | int    | 响应码   |
| message | String | 响应结果 |

返回实例：

```json
{
    "status": 1,
    "message": "成功",
    "data":{
        "stage":"40",  //当前的状态 40:已受理  79:已出具见证报告，此状态会返回见证报告
        "pdf":"",//一般为一组文件,自动压缩为base64编码zip文件。
		"fileType":"",//文件类型
        "fileName":"",//取证报告名称
        "errorMsg":""//错误消息
    }
}
```

#### 46.3.2 错误响应

除1之外的响应码,均为失败


### 46.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |

# 四十七、**查询法律文书接口**

### 47.1 接口地址

http://localhost:8080/apigate/contractapi/law/getLegalInstrument

### 47.2 请求参数

#### 47.2.1 请求方法

POST

#### 47.2.2 请求体

| 名称                | 类型    | 约束 | 描述                                                         |
| ------------------- | ------- | ---- | ------------------------------------------------------------ |
| enterpriseId        | String  | 选填 | 企业id   enterpriseId和userId二选一                          |
| userId              | String  | 选填 | 用户id   enterpriseId和userId二选一                          |
| legalInstrumentType | Integer | 选填 | 法律文书类型(默认见证报告),<br/>支持1、 见证报告2、取证报告3、存证报告(本期不支持存证报告) |
| pageNum             | Integer | 必填 | 页码                                                         |
| pageSize            | Integer | 必填 | 每页个数                                                     |
| startTime           | Long    | 选填 | 开始时间                                                     |
| endTime             | Long    | 选填 | 结束时间                                                     |

请求实例：

```json
{
		"userType": 2,
		"enterpriseId": "asdasd",
		"legalInstrumentType": 1,
    	"pageNum":10,
    	"pageSize":20,
    	"startTime":1340000009,
        "endTime":1340000010
}
```

### 47.3 返回结果

#### 47.3.1 正确响应

| 名称    | 类型   | 描述     |
| ------- | ------ | -------- |
| status  | int    | 响应码   |
| message | String | 响应结果 |

返回实例：

```json
{
    "status": 1,
    "message": "成功",
    data:{
        "pageNum": 3,
		"pageSize": 10,
		"totalRecord": 100,
		"totalPage": 10,
       "list":[ {
            "contractId":123123123123,
            "contractTitle":"合同名称",
            "legalDoc":"业务单号"
           }
        ]
    }
}
```

#### 47.3.2 错误响应

除1之外的响应码,均为失败


### 47.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |





# 四十八、**快捷签署接口(异步)**（v3.2.2新增）

### 48.1 接口地址

http://localhost:8080/apigate/contractapi/easySign/easySignContract

### 48.2 请求参数

#### 48.2.1 请求方法

POST

#### 48.2.2 请求体

| 名称             | 类型           | 约束 | 描述                                                         |
| ---------------- | -------------- | ---- | ------------------------------------------------------------ |
| bizOrderNum      | String         | 选填 | 合同的业务单号                                               |
| asyncUrl         | String         | 必填 | 签署回调地址                                                 |
| creator          | String         | 必填 | 创建人                                                       |
| enterpriseId     | String         | 必填 | 创建人企业                                                   |
| uploadType       | Integer        | 必填 | 传输类型（1:获取地址;2:base64;）                             |
| folderPath       | String         | 选填 | 获取合同文件地址（注释：如果是镜像部署需要挂载出一个路径<br>用来上传文件；如果是jar包部署需要给一个jar包能够读取到的文件路径<br>注意权限问题）例子：/usr/local/app/contract-all/data |
| easySignerList   | EasySigner[]   | 必填 | 签署人信息                                                   |
| easyContractList | EasyContract[] | 选填 | 合同信息                                                     |
| lastFileType     | Integer        | 选填 | 合同终版文件类型：1PDF（默认）,2OFD；当该参数未传时，取业务类型中设置的合同终版文件类型，若业务类型中也未设置，则取系统默认设置（PDF）类型。<span style="color:#00ff00">(v4.7.0.0新增)</span> |

EasySigner的数据结构：

| 名称                | 类型             | 约束 | 描述                                     |
| ------------------- | ---------------- | ---- | ---------------------------------------- |
| userId              | String           | 必填 | 签署人用户id                             |
| enterpriseId        | String           | 选填 | 签署人企业id（当签署人类型为企业时必填） |
| signerType          | Integer          | 必填 | 签署人类型：1个人、2企业                 |
| keywordSignControls | KeywordControl[] | 选填 | 关键字控件                               |
| xySignControls      | XYControl[]      | 选填 | 坐标轴控件                               |
| crossSignControls   | CrossControl[]   | 选填 | 骑缝章控件                               |

关键字签署控件KeywordControl：（$\color{#FF0000}{接口UKey签不支持该控件}$）

| 名称    | 类型    | 约束 | 描述                                                         |
| ------- | ------- | ---- | ------------------------------------------------------------ |
| id      | Integer | 必填 | 控件id，不可重复                                             |
| type    | String  | 必填 | 控件类型                                                     |
| value   | String  | 选填 | 控件值(当签署人为企业时必填)                                 |
| pageNum | String  | 必填 | 多页签时为必填项 指定盖章页， 0：所有页盖章 -1：最后一页，支持：1，2，3，4，5，-1 |
| keyword | String  | 必填 | 关键字（一个签署方只支持一个关键字）                         |
| offsetX | Float   | 选填 | 关键字偏移横坐标x，原点印章默认位置，浮点数，0-21 单位cm     |
| offsetY | Float   | 选填 | 关键字偏移纵坐标y，原点印章默认位置，浮点数，0-29.7 单位cm   |

坐标轴签署控件XYControl：

| 名称    | 类型    | 约束 | 描述                                                         |
| ------- | ------- | ---- | ------------------------------------------------------------ |
| id      | Integer | 必填 | 控件id，不可重复                                             |
| type    | String  | 必填 | 控件类型                                                     |
| value   | String  |      | 控件值(当签署人为企业时必填)                                 |
| pageNum | String  | 必填 | 多页签时为必填项 指定盖章页， 0：所有页盖章 -1：最后一页，支持：1，2，3，4，5，-1 |
| x       | Float   | 必填 | 横坐标x，原点为左上角，浮点数，0-1，PDF位置比例              |
| y       | Float   | 必填 | 纵坐标y，原点为左上角，浮点数，0-1，PDF位置比例              |

骑缝签署控件CrossControl：（$\color{#FF0000}{接口UKey签不支持该控件}$）

| 名称    | 类型    | 约束 | 描述                                                         |
| ------- | ------- | ---- | ------------------------------------------------------------ |
| id      | Integer | 必填 | 控件id，不可重复                                             |
| pageNum | String  | 必填 | 多页签时为必填项 指定盖章页， 0：所有页盖章 -1：最后一页，支持：1，2，3，4，5，-1 |
| y       | Float   | 必填 | 纵坐标y，印章左上角距离文档上边缘的距离（cm），<br />默认印章垂直居中 |
| value   | String  | 选填 | 控件值(当签署人为企业时必填)                                 |

EasyContract的数据结构：

| 名称           | 类型   | 约束 | 描述                                     |
| -------------- | ------ | ---- | ---------------------------------------- |
| contractCode   | String | 选填 | 合同编号                                 |
| contractName   | String | 必填 | 合同名称（当使用base64创建合同时必填）   |
| contractBase64 | String | 必填 | 合同base64（当使用base64创建合同时必填） |

请求实例：

```json
{
    "asyncUrl":"http://www.baidu.com",
    "creator":"L478u6ru8kx91d",
	"bizOrderNum":"110119312412414512",
    "easySignerList":[
        {
            "crossSignControls":[

            ],
            "keywordSignControls":[
                {
                    "id":2,
                    "keyword":"设计费",
                    "offsetX":0.5,
                    "offsetY":0.5,
                    "pageNum":"1",
                    "type":"autograph",
					"value":"1333671083234979842"
                }
            ],
            "signerType":1,
            "userId":"L478u6ru8kx91d",
            "xySignControls":[
                {
                    "id":1,
                    "key":"1",
                    "pageNum":"1",
                    "type":"autograph",
					"value":"1333671083234979842",
                    "x":0.5,
                    "y":0.5
                }
            ]
        },
        {
            "crossSignControls":[
                {
                    "id":6,
                    "key":"6",
					"value":"1332246639486382081",
                    "y":10
                }
            ],
            "enterpriseId":"L4702t",
            "keywordSignControls":[
                {
                    "id":5,
                    "keyword":"建元装饰",
                    "offsetX":0.5,
                    "offsetY":0.5,
                    "pageNum":"1",
                    "type":"signet",
					"value":"1332246639486382081"
                }
            ],
            "signerType":2,
            "userId":"L478u6ru8kx91d",
            "xySignControls":[
                {
                    "id":4,
                    "key":"4",
                    "pageNum":"1",
                    "type":"signet",
					"value":"1332246639486382081",
                    "x":0.2,
                    "y":0.5
                }
            ]
        }
    ],
	"uploadType":1,
    "enterpriseId":"L4702t",
    "folderPath":"F:\\Test_004",
    "signSortable":false
}
```

### 48.3 返回结果

#### 48.3.1 正确响应

| 名称    | 类型   | 描述     |
| ------- | ------ | -------- |
| status  | int    | 响应码   |
| message | String | 响应结果 |

返回实例：

```json
{
    "data": {},
    "status": 1,
    "message": "请求成功"
}
```

#### 48.3.2 错误响应

除1之外的响应码,均为失败


### 48.4 响应码

| 编号 | 描述                         |
| ---- | ---------------------------- |
| 1    | 成功                         |
| 1000 | 参数为空或不满足规则         |
| 2004 | 校验企业用户失败             |
| 2005 | 校验个人用户失败             |
| 2010 | 签署人签署控件不能为空       |
| 2043 | 合同文件签署控件id不能重复   |
| 2044 | 控件类型错误                 |
| 2051 | 个人签署人不能设置骑缝章控件 |
| 2057 | 合同签署人不能重复           |
| 2101 | 合同业务单号已经存在         |
| 2102 | 业务单号长度为1-32个字符     |
| 2103 | 获取地址不存在               |
| 2104 | 未找到需要签署的合同         |
| 2105 | 合同名称不能为空             |
| 2106 | 合同名称长度为1-32个字符     |
| 2107 | 合同文件不存在               |
| 2108 | 合同编号不能重复             |
| 2109 | 合同编号长度为1-32个字符     |
| 2110 | 签署人未实名                 |
| 2111 | 企业用户签章控件未设置值     |
| 2112 | 关键字不能重复               |
| 2113 | 创建人未实名                 |
| 2114 | 创建企业未实名               |

# 四十九、快捷签署回调（v3.2.2新增）

### 49.1 接口地址

对接方系统提供

### 49.2 请求参数

#### 49.2.1 请求方法

POST

#### 49.2.2 请求体

请求示例：

```json
{
	"errorCount": 2,
	"errorList": [
		{
			"contractName": "contract1.pdf",
			"contractCode": 1334338348657831937,
			"failReason": "未找到文件"
		},
		{
			"contractName": "contract1.pdf",
			"contractCode": 1334338348657831937,
			"failReason": "未找到文件"
		}
	],
	"successCount": 2,
	"successList": [
		{
			"contractCode": "2020201203003027371",
			"contractId": 1334338348657831937,
			"contractName": "contract1.pdf",
			"contractStatus": 3,
			"lastSignTime": "2020-12-03T11:27:06.908",
			"signers": [
				{
					"docList": [
						{
							"docId": 1334338348984987650,
							"docName": "contract1.pdf"
						}
					],
					"signStatus": 3,
					"signerId": 1334338348880130050,
					"userId": "L478u6ru8kx91d",
					"userName": "刘羽"
				},
				{
					"docList": [
						{
							"docId": 1334338348984987650,
							"docName": "contract1.pdf"
						}
					],
					"enterpriseId": "L4702t",
					"signStatus": 3,
					"signerId": 1334338348922073090,
					"userId": "L478u6ru8kx91d",
					"userName": "刘羽"
				}
			]
		},
		{
			"contractCode": "2020201203003039383",
			"contractId": 1334338348657831938,
			"contractName": "contract8.pdf",
			"contractStatus": 3,
			"lastSignTime": "2020-12-03T11:27:06.979",
			"signers": [
				{
					"docList": [
						{
							"docId": 1334338348984987651,
							"docName": "contract8.pdf"
						}
					],
					"signStatus": 3,
					"signerId": 1334338348880130051,
					"userId": "L478u6ru8kx91d",
					"userName": "刘羽"
				},
				{
					"docList": [
						{
							"docId": 1334338348984987651,
							"docName": "contract8.pdf"
						}
					],
					"enterpriseId": "L4702t",
					"signStatus": 3,
					"signerId": 1334338348930461697,
					"userId": "L478u6ru8kx91d",
					"userName": "刘羽"
				}
			]
		}
	],
	"totalCount": 12,
    "bizOrderNum":"fwefw415415"
}
```

请求体结构:

| 名称         | 类型                      | 描述         |
| ------------ | ------------------------- | ------------ |
| totalCount   | Integer                   | 总条数       |
| bizOrderNum  | String                    | 业务单号     |
| successCount | Integer                   | 成功条数     |
| errorCount   | Integer                   | 失败条数     |
| successList  | EasySignSuccessContract[] | 成功数据列表 |
| errorList    | EasySignErrorContract[]   | 失败数据列表 |

EasySignSuccessContract的数据结构：

| 名称           | 类型     | 描述                                    |
| -------------- | -------- | --------------------------------------- |
| contractId     | Long     | 合同id                                  |
| contractName   | String   | 合同名称                                |
| contractCode   | String   | 合同编码                                |
| contractStatus | Integer  | 合同状态(3:已完成)                      |
| signers        | Signer[] | 合同签署人                              |
| lastSignTime   | String   | 最后签署时间(格式：yyyy-MM-dd HH:mm:ss) |

Signer签署人结构

| 名称       | 类型       | 描述                                                         |
| ---------- | ---------- | ------------------------------------------------------------ |
| userId     | Long       | 签署人id                                                     |
| userName   | String     | 合同签署人姓名                                               |
| signStatus | int        | 合同签署人签署状态：1.待他人签署，2 待我签（.签署中），3.已签署，5.已解约，6.已拒签 |
| docList    | Document[] | 签署人合同文档                                               |

Document文档体结构

| 名称    | 类型   | 描述         |
| ------- | ------ | ------------ |
| docId   | Long   | 合同文件Id   |
| docName | String | 合同文件名称 |

EasySignErrorContract的数据结构：

| 名称         | 类型   | 描述                             |
| ------------ | ------ | -------------------------------- |
| contractName | String | 客户自定义的合同名称或者文件名称 |
| contractCode | String | 客户自定义的合同编码             |
| failReason   | String | 失败原因                         |

# 五十、上传文件合同-发起页面签接口

### 50.1 接口地址

http://localhost:8080/apigate/contractapi/pageSign/startSignByFile

### 50.2 请求参数

#### 50.2.1 请求方法

POST

#### 50.2.2 请求体

| 名称       | 类型     | 约束 | 描述                                                         |
| ---------- | -------- | ---- | ------------------------------------------------------------ |
| signType   | int | 选填 | 1 页面云端签署(默认) 2 页面ukey签署                          |
| contractId | Long     | 必填 | 合同ID                                                       |
| signer     | Signer   | 必填 | 合同签署人                                                   |
| expire     | int      | 选填 | 链接有效期,单位分钟；默认30分钟，最小5分钟，<br />最大60*24分钟（24小时）； |
| syncUrl    | String   | 选填 | 同步地址                                                     |
| asyncUrl   | String   | 选填 | 异步地址                                                     |

Signer合同签署人结构

| 名称          | 类型        | 约束 | 描述                                                         |
| ------------- | ----------- | ---- | ------------------------------------------------------------ |
| signerType    | Integer     | 必填 | 签署人类型：1个人、2企业                                     |
| userId        | String      | 必填 | 签署人用户id，签署人可以未实名                               |
| enterpriseId  | String      | 选填 | 签署人公司ID（当签署人类型为企业时，必填）                   |
| isUserWishes  | boolean     | 选填 | 是否要做意愿认证；默认false；<br />false 否 用户自己做意愿认证， <br />true 是 需要天威诚信做意愿认证； |
| userWishesWay | Integer[]   | 选填 | 意愿认证方式；1 验证码认证方式（默认），后续会扩展认证方式；<br />isUserWishes参数为true时必填<br /> |
| sequence      | Integer     | 选填 | 签署人顺序（签署顺序1-100之间），合同有序签时，该参数生效    |
| signFiles     | SignFile[]  | 必填 | 签署文件列表                                                 |
| setting       | Boolean     | 选填 | 是否设置控件：false不设置，true设置（默认）                  |
| controlsType  | Set<String> | 选填 | 不设置控件，签署时的控件类型范围；当setting为false时，该参数为必填，控件类型-参照附录：控件类型 |

SignFile签署文件结构

| 名称                | 类型             | 约束 | 描述           |
| ------------------- | ---------------- | ---- | -------------- |
| docId               | Long             | 必填 | 签署合同文档Id |
| xySignControls      | XYControl[]      | 选填 | 坐标轴控件     |
| keywordSignControls | KeywordControl[] | 选填 | 关键字控件     |
| crossSignControls   | CrossControl[]   | 选填 | 骑缝章控件     |

坐标轴签署控件XYControl：

| 名称    | 类型    | 约束 | 描述                                                         |
| ------- | ------- | ---- | ------------------------------------------------------------ |
| id      | Integer | 必填 | 控件id，不可重复                                             |
| type    | String  | 必填 | 控件类型                                                     |
| pageNum | String  | 必填 | 多页签时为必填项 指定盖章页， 0：所有页盖章 -1：最后一页，支持：1，2，3，4，5，-1 |
| x       | Float   | 必填 | 横坐标x，原点为左上角，浮点数，0-1，PDF位置比例              |
| y       | Float   | 必填 | 纵坐标y，原点为左上角，浮点数，0-1，PDF位置比例              |
| value   | String  | 选填 | 控件值                                                       |
| width   | Float   | 选填 | 控件宽（单位：cm），印章、图片控件，可不填，默认为图片的宽度 |
| height  | Float   | 选填 | 控件高（单位：cm），印章、图片控件，可不填，默认为图片的高度 |

关键字签署控件KeywordControl：

| 名称    | 类型    | 约束 | 描述                                                         |
| ------- | ------- | ---- | ------------------------------------------------------------ |
| id      | Integer | 必填 | 控件id，不可重复                                             |
| type    | String  | 必填 | 控件类型                                                     |
| pageNum | String  | 必填 | 多页签时为必填项 指定盖章页， 0：所有页盖章 -1：最后一页，支持：1，2，3，4，5，-1 |
| keyword | String  | 必填 | 关键字（一个签署方只支持一个关键字）                         |
| value   | String  | 选填 | 控件值                                                       |
| offsetX | Float   | 可填 | 关键字偏移横坐标x，原点印章默认位置，浮点数，0-21 单位cm     |
| offsetY | Float   | 可填 | 关键字偏移纵坐标y，原点印章默认位置，浮点数，0-29.7 单位cm   |
| width   | Float   | 可填 | 控件宽（单位：cm），印章、图片控件，可不填，默认为图片的宽度 |
| height  | Float   | 可填 | 控件高（单位：cm），印章、图片控件，可不填，默认为图片的高度 |

骑缝签署控件CrossControl：

| 名称   | 类型    | 约束 | 描述                                                         |
| ------ | ------- | ---- | ------------------------------------------------------------ |
| id     | Integer | 必填 | 控件id，不可重复                                             |
| y      | Float   | 必填 | 纵坐标y，印章左上角距离文档上边缘的距离（cm），<br />默认印章垂直居中 |
| width  | Float   | 可填 | 控件宽（单位：cm），默认为图片的宽度                         |
| height | Float   | 可填 | 控件高（单位：cm），默认为图片的高度                         |

请求实例：

```json
{
	"contractId": 13000001,
	"signers": {
		"userId": "1001",
		"signerType": 2,
		"enterpriseId": "1003",
		"sequence": 8,
		"sendMsg": false,
		"signFiles": [{
			"docId": 343465645,
			"xySignControls": [{
					"id": 1,
					"type": "text",
					"pageNum": 1,
					"x": 0.04,
					"y": 0.6
				},
				{
					"id": 2,
					"type": "signet",
					"pageNum": 2,
					"x": 0.04,
					"y": 0.6
				},
				{
					"id": 3,
					"type": "date",
					"pageNum": 2,
					"x": 0.03,
					"y": 0.5
				}
			],
			"keywordSignControls": [{
				"id": 1,
				"type": "signet",
				"pageNum": 2,
				"keyword": "盖章",
				"offsetX": 0.03,
				"offsetY": 0.5
			}]
		}]
	}
}
```

### 50.3 返回结果

#### 50.3.1 正确响应

| 名称    | 类型   | 描述            |
| ------- | ------ | --------------- |
| signUrl | String | 页面签署url地址 |



返回实例：

```json
{
    "status": 1,
    "data":{
        "signUrl": "1020200620701056856"
    },
    "message": "成功"
}

```

#### 50.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 50.4 响应码

| 编号 | 描述                                           |
| ---- | ---------------------------------------------- |
| 1    | 成功                                           |
| 500  | 系统错误，请联系管理员                         |
| 2003 | 合同不存在                                     |
| 2004 | 校验企业用户失败                               |
| 2005 | 校验个人用户失败                               |
| 2009 | 签署人签署的合同中不存在合同文档id             |
| 2041 | 添加的合同签署人数超过创建合同时设置的签署人数 |

# 五十一、**批量签署接口**(v4.0.2新增)

### 51.1 接口地址

http://localhost:8080/apigate/contractapi/contract/batchSign

### 51.2 请求参数

#### 51.2.1 请求方法

POST

#### 51.2.2 请求体

| 名称             | 类型       | 约束 | 描述                                                         |
| ---------------- | ---------- | ---- | ------------------------------------------------------------ |
| enterpriseId     | String     | 选填 | 企业id                                                       |
| userId           | String     | 必填 | 用户id                                                       |
| signerType       | Integer    | 必填 | 签署人类型 1 个人 2企业                                      |
| contractIds      | List<Long> | 必填 | 合同id集合                                                   |
| isUserWishes     | boolean    | 选填 | 是否要做意愿认证；默认false；<br />false 否 用户自己做意愿认证， <br />true 是 需要天威诚信做意愿认证 ； |
| userWishesWay    | Integer    | 选填 | 意愿认证方式；1 验证码认证方式（默认），后续会扩展认证方式；<br />isUserWishes参数为true时必填<br /> |
| codeNumber       | String     | 选填 | 验证码编号                                                   |
| verifyCode       | String     | 选填 | 验证码                                                       |
| signControlValue | String     | 必填 | 控件值  支持 base64:xxx 和 sealId:123                        |
| signDate         | String     | 选填 | 如果存在日期控件此项为必填                                   |

请求实例：

```json
{
		"userType": 2,
		"enterpriseId": "asdasd",
		"userId": 1,
    	"contractIds":[1L,2L],
    	"isUserWishes":true,
    	"userWishesWay":1,
        "verifyCode":123,
    	"signControlValue":"base64:aaaa",
    	"signDate":"2021-06-07"
}
```

### 51.3 返回结果

#### 51.3.1 正确响应

| 名称    | 类型   | 描述     |
| ------- | ------ | -------- |
| status  | int    | 响应码   |
| message | String | 响应消息 |
| data    | Object | 响应结果 |

data结构 :

| 名称         | 类型    | 描述         |
| ------------ | ------- | ------------ |
| totalCount   | Integer | 总数量       |
| successCount | Integer | 签署成功数量 |
| errorCount   | Integer | 签署失败数量 |
| successList  | List    | 签署成功列表 |
| errorList    | List    | 签署失败列表 |

successList结构:

| 名称         | 类型     | 描述                                                         |
| ------------ | -------- | ------------------------------------------------------------ |
| code         | String   | 合同编号                                                     |
| contractId   | Long     | 合同id                                                       |
| contractName | String   | 合同主题                                                     |
| status       | int      | 合同状态:0草稿、1.待签署，2.签署中，3.已完成，4.已过期，5.已解约，6.已拒签 |
| signers      | Signer[] | 合同签署人                                                   |
| lastSignTime | Date     | 最后签署时间                                                 |

Signer签署人结构（区分企业和个人）

| 名称         | 类型       | 描述                                                         |
| ------------ | ---------- | ------------------------------------------------------------ |
| userId       | String     | 签署人用户id                                                 |
| enterpriseId | String     | 签署人企业id                                                 |
| userName     | String     | 合同签署人姓名                                               |
| signStatus   | Integer    | 合同签署人签署状态:1.待他人签署，2 待我签（.签署中），3.已签署，5.已解约，6.已拒签 |
| docList      | Document[] | 合同文档                                                     |

Document文档体结构

| 名称    | 类型   | 描述         |
| ------- | ------ | ------------ |
| docId   | Long   | 合同文件Id   |
| docName | String | 合同文件名称 |

errorList结构:



| 名称         | 类型   | 描述     |
| ------------ | ------ | -------- |
| contractId   | Long   | 合同Id   |
| contractCode | String | 合同编号 |
| contractName | String | 合同名称 |
| errorMessage | String | 错误消息 |

返回实例：

```json
{
    "status": 1,
    "message": "成功",
    data:{
        "totalCount":5,
        "successCount":2,
        "errorCount":3,
        "successList":[
            {
                "code": "1020200620701056856",
                "contractId": 13000001,
                "contractName": "汽车购买交易合同",
                "status": 1,
                "lastSignTime": "2020-06-22",
                "signers":[ {
                        "userId": "1100",
                        "userName": "张三",
                        "signStatus": 1,
                        "docList": [
                            {
                                "docId": 11000001,
                                "docName":"汽车购买贷款协议"
                            },
                            {
                                "docId": 11000001,
                                "docName":"汽车购买贷款协议"
                            }
                        ]
                    }
                ]
            }
        ],
        "errorList":[
        	{
                "contractId":123L,
                "contractCode":"123",
                "contractName":"123"
                "errorMessage":""
            }
        ]
    }
}
```

#### 51.3.2 错误响应

除1之外的响应码,均为失败


### 51.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |




# 五十二、P7数据签(v4.1.0新增)

### 52.1 接口地址

http://localhost:8080/apigate/contractapi/digestSign/dataSign

### 52.2 请求参数

#### 52.2.1 请求方法

POST

#### 52.2.2 请求体

| 名称       | 类型    | 约束 | 描述     |
| ---------- | ------- | ---- | -------- |
| title | String | 必填 | 标题 |
| content | String | 必填 | 待签名数据 (原文或摘要) |
| digestType | Integer | 必填 | 数据类型：0摘要签名、1原文签名 |
| userId | String | 必填 | 用户ID |
| enterpriseId | String | 选填 | 企业id |
| signerType | Integer | 必填 | 签署方类型:1个人   2 企业 |
| desireType | Boolean | 必填 | 意愿验证  true：表示应用进行了用户意愿验证，并验证通过 ；非true返回错误信息提示 |

请求实例：

```json
{
		"title": "标题",
		"content": "原文",
		"digestType": 0,
    	"userId": "123",
    	"enterpriseId": "1234",
    	"signerType": 0,
		"desireType": true
       	
}
```

### 52.3 返回结果

#### 52.3.1 正确响应

| 名称            | 类型    | 描述                                                         |
| --------------- | ------- | ------------------------------------------------------------ |
| signRecordCode  | Long    | 签名记录id                                                   |
| signValue       | String  | 签名值，字符串Base64                                         |
| certApplyStatus | Integer | 证书申请状态： 1：新证书的申请   2：新更新的证书   3：使用原有的证书 |
| certCode        | String  | 证书编号                                                     |
| certEffectTime  | String  | 证书生效时间，格式：yyyy-MM-dd HH:mm:ss                      |
| certExpireTime  | String  | 证书过期时间，格式：yyyy-MM-dd HH:mm:ss                      |

返回实例：

```json
{
    "status": 1,
    "message": "成功",
    data:{
        "signRecordCode": "123",
		"signValue": "123",
		"certApplyStatus": 1,
		"certCode": "123",
        "certEffectTime": "2021-05-28 13:26:00",
        "certExpireTime": "2021-06-28 13:26:00",
    }
}
```

#### 52.3.2 错误响应

除1之外的响应码,均为失败


### 52.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |

# 五十三、P7数据验签(v4.1.0新增)

### 53.1 接口地址

http://localhost:8080/apigate/contractapi/digestSign/digestVerify

### 53.2 请求参数

#### 53.2.1 请求方法

POST

#### 53.2.2 请求体

| 名称           | 类型   | 约束 | 描述         |
| -------------- | ------ | ---- | ------------ |
| signRecordCode | Long   | 必填 | 签名记录编号 |
| signValue      | String | 必填 | 签名值       |
| content        | String | 必填 | 摘要或原文   |

请求实例：

```json
{
		"signRecordCode": 1L,
		"content": "原文",
		"signValue": ""
       	
}
```

### 53.3 返回结果

#### 53.3.1 正确响应

| 名称 | 类型    | 描述                                      |
| ---- | ------- | ----------------------------------------- |
| code | Integer | 结果码：1，验证成功，其他失败（见响应码） |
| msg  | String  | 验证结果描述                              |

返回实例：

```json
{
    "status": 1,
    "message": "成功",
}
```

#### 53.3.2 错误响应

| 编号   | 描述                       |
| ------ | -------------------------- |
| 1      | 成功                       |
| 300100 | 数据签记录未找到           |
| 300101 | 原文或摘要被修改           |
| 300102 | 签名记录编号与签名值不匹配 |




### 53.4 响应码

| 编号   | 描述                       |
| ------ | -------------------------- |
| 1      | 成功                       |
| 300100 | 数据签记录未找到           |
| 300101 | 原文或摘要被修改           |
| 300102 | 签名记录编号与签名值不匹配 |



# 五十四、获取合同图片(v4.1.0新增)

### 54.1 接口地址

http://localhost:8080/apigate/contractapi/digestSign/downLoadContractPic

### 54.2 请求参数

#### 54.2.1 请求方法

POST

#### 54.2.2 请求体

| 名称         | 类型    | 约束 | 描述                                                    |
| ------------ | ------- | ---- | ------------------------------------------------------- |
| downLoadType | Integer | 选填 | 下载类型  0  全部 （默认全部）  1  按页下载             |
| pageStart    | Integer | 选填 | 起始页                                                  |
| pageEnd      | Integer | 选填 | 结束页                                                  |
| contractId   | String  | 必填 | 合同id                                                  |
| docId        | String  | 选填 | 文档id(不填下载所有合同文档，填入下载指定文档id)        |
| returnType   | Integer | 选填 | 返回类型: 0  返回集合  （默认返回集合）   1  返回压缩包 |

请求实例：

```json
{		
    	"downLoadType": 1,
    	"pageStart": 1,
		"pageEnd": 5,
		"contractId": "1381561257416384514",
    	"docId": "1312312432"
}
```

### 54.3 返回结果

#### 54.3.1 正确响应

| 名称            | 类型          | 描述                   |
| --------------- | ------------- | ---------------------- |
| zipBase64       | String        | 所有合同文件图片压缩包 |
| contractPicList | ContractPic[] | 合同文件图片集合       |

合同文件图片集合

| 名称       | 类型     | 描述             |
| ---------- | -------- | ---------------- |
| docId      | String   | 合同文档id       |
| docName    | String   | 合同文档名称     |
| totalPage  | Integer  | 合同文档总页数   |
| docPicList | DocPic[] | 合同文档图片集合 |

合同文档图片集合结构

| 名称      | 类型    | 描述                |
| --------- | ------- | ------------------- |
| picBase64 | String  | 图片base64          |
| type      | Integer | 图片格式类型 1  png |
| pageNum   | Integer | 当前图片页码        |

返回实例：

```json
{
    "status": 1,
    "message": "成功",
    data:{
        "contractPicList": [
            {
                "docId": "123",
                "docName": "合同文档名称",
                "totalPage": 10,
                "docPicList": [{
                        "picBase64": "12sdf31232",
                        "type": 1,
                        "pageNum": 10
                	}
                    
                ]
            }
        ]
        
    }
}
```

#### 54.3.2 错误响应

除1之外的响应码,均为失败


### 54.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |

# 五十五、企业实名认证(v4.1.2新增)

### 54.1 接口地址

http://localhost:8080/apigate/contractapi/enterprise/realName

### 55.2 请求参数

#### 55.2.1 请求方法

POST

#### 55.2.2 请求体

| 名称            | 类型    | 约束 | 描述                                    |
| --------------- | ------- | ---- | --------------------------------------- |
| enterpriseId    | String  | 必填 | 企业id                                  |
| agentUserId     | String  | 必填 | 经办人用户id                            |
| authType        | Integer | 必填 | 认证方式 1法人手机号验证 2.企业打款认证 |
| inOneType       | Boolean | 必填 | 是否三证合一 false 否 true 是（默认）   |
| socialCode      | String  | 选填 | 统一社会信用代码(三证合一必填)          |
| unitCode        | String  | 选填 | 组织机构代码(非三证合一必填)            |
| registeredNo    | String  | 选填 | 工商注册号(非三证合一必填)              |
| verifyCode      | String  | 选填 | 短信验证码 认证方式 为1时必填           |
| codeNumber      | String  | 选填 | 验证码流水号 认证方式 为1时必填         |
| legalPersonName | String  | 选填 | 法人姓名  认证方式 为1时必填            |
| legalIdcardNum  | String  | 选填 | 法人身份证号 认证方式 为1时必填         |
| legalPhone      | String  | 选填 | 法人手机号 认证方式 为1时必填           |
| bankAccount     | String  | 选填 | 银行账号 认证方式 为2时必填             |
| bankName        | String  | 选填 | 开户行名称 认证方式 为2时必填           |
| branchBankName  | String  | 选填 | 支行名称 认证方式 为2时必填             |
| bankCode        | String  | 选填 | 开户银行编码 认证方式 为2时必填         |
| provinceCode    | String  | 选填 | 省份编码 认证方式 为2时必填             |
| cityCode        | String  | 选填 | 城市编码 认证方式 为2时必填             |

请求实例：

```json
{		
    	"enterpriseId": "1",
    	"agentUserId": "1",
		"authType": 1,
		"inOneType": true,
    	"socialCode": "1312312432",
        "legalPersonName":"张三",
        "legalPhone":"1111",
    	"verifyCode":"1111",
      	"codeNumber":"1111"
}
```

### 55.3 返回结果

| 名称           | 类型   | 描述     |
| -------------- | ------ | -------- |
| enterpriseId   | String | 企业id   |
| enterpriseName | String | 企业名称 |



#### 55.3.1返回实例：

```json
{
    "status": 1,
    "message": "成功",
     data:{
         "enterpriseId":"1",
         "enterpriseName":"企业名称"
     }
}
```

#### 55.3.2 错误响应

除1之外的响应码,均为失败


### 55.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |

# 五十六、签署密码设置(v4.2.0新增)

### 56.1 接口地址

http://localhost:8080/apigate/contractapi/user/resetPassword

### 56.2 请求参数

#### 56.2.1 请求方法

POST

#### 56.2.2 请求体

| 名称         | 类型    | 约束 | 描述                                                         |
| ------------ | ------- | ---- | ------------------------------------------------------------ |
| userId       | String  | 必填 | 用户id                                                       |
| verifySource | Integer | 选填 | 验证来源 1 客户验证 2 天威验证 默认客户验证                  |
| verifyWay    | Integer | 选填 | 验证方式 1.手机验证 2.邮箱验证（暂不支持）                   |
| signPassword | String  | 必填 | 设置签署的密码，如果设置类型是更改密码，则在此录入新密码，可以与原密码保持一致<br>签署密码只支持 1-16个字符，至少包含数字、字母、特殊字符任意两种组合 |
| codeNumber   | String  | 选填 | 验证码流水号 （选填）选择天威验证时必填                      |
| verifyCode   | String  | 选填 | 验证码（选填）选择天威验证时必填                             |

请求实例：

```json
{		
    	"userId": "1",
    	"verifySource": 1,
		"verifyWay": 1,
		"signPassword": "123",
    	"codeNumber": "123123",
        "verifyCode":"123123"
}
```

### 56.3 返回结果

#### 56.3.1返回实例：

```json
{
    "status": 1,
    "message": "成功",
     data:{}
}
```

#### 56.3.2 错误响应

除1之外的响应码,均为失败


### 56.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |

# 五十七、PDF验签(v4.2.0新增)

### 57.1 接口地址

http://localhost:8080/apigate/contractapi/contract/verifyContract

### 57.2 请求参数

#### 57.2.1 请求方法

POST

#### 57.2.2 请求体

| 名称        | 类型    | 约束 | 描述                                                         |
| ----------- | ------- | ---- | ------------------------------------------------------------ |
| verifyWay   | Integer | 必填 | 验证方式 1合同id验证、 2base64验证                           |
| contractId  | Long    | 选填 | 合同id 验证方式选合同id,必填，若为base64 则不填              |
| base64      | String  | 选填 | 已签名PDF文档Base64，若验证方式为id验证，此项可不填          |
| checkAnnot  | Boolean | 选填 | 是否验证批注，验证签章后是否添加批注：true：验证 false：不验证（默认） |
| checkCRL    | Boolean | 选填 | 是否验证吊销列表：true：验证 false：不验证（默认）           |
| checkIssuer | Boolean | 选填 | 否验证书颁发者：true：验证 false：不验证（默认）             |

请求实例：

```json
{		
    	"verifyWay": 1,
    	"contractId": 1L,
		"base64": "aaa",
		"checkAnnot": false,
    	"checkCRL": false,
        "checkIssuer":false
}
```

### 57.3 返回结果

verifyContractList : 

| 名称         | 类型 | 描述     |
| ------------ | ---- | -------- |
| contractId   | Long | 合同id   |
| templateId   | Long | 文档id   |
| certInfoList | List | 证书信息 |

certInfoList : 

| 名称         | 类型     | 描述                                                         |
| ------------ | -------- | ------------------------------------------------------------ |
| signCert     | signCert | 签名证书信息                                                 |
| signTime     | String   | 签名时间，格式：yyyy-MM-dd HH:mm:ss<br/>如果有时间戳，签名时间以时间戳时间为准 |
| timestamp    | String   | 时间戳，格式：yyyy-MM-dd HH:mm:ss                            |
| hashAlg      | String   | 摘要Hash算法                                                 |
| vcResult     | Long     | 证书验证结果：  0：成功； 1：证书已吊销 2：证书不在有效期内 4：无效的证书签名 8：证书损坏。（证书编码格式异常，无法解析证书。） 9：证书无吊销列表URI 10：吊销列表下载失败 11：吊销列表解释失败 |
| vdsResult    | Long     | 数字签名验证结果: 0：成功； 1：数字签名无效 2：签名后添加批注信息 |
| vtsResult    | Long     | 时间戳验证结果: 0：成功； 1：时间戳验证失败 9：无时间戳      |
| isSecondSign | Boolean  | 双证书签章时，是否为第二个证书的签名                         |

signCert: 

| 名称       | 类型   | 描述                                                |
| ---------- | ------ | --------------------------------------------------- |
| certSN     | String | 证书序列号                                          |
| version    | Long   | 证书版本                                            |
| subjectDN  | String | 证书使用者DN                                        |
| issuerDN   | String | 证书颁发者DN                                        |
| notBefore  | String | 证书有效期起始日，格式：yyyy-MM-dd HH:mm:ss         |
| notAfter   | String | 证书有效期截至日，格式：yyyy-MM-dd HH:mm:ss         |
| sigAlgName | String | 签名算法名称:SHA1withRSA、SHA256withRSA、SM3withSM2 |

#### 57.3.1返回实例：

```json
{
    "status": 1,
    "message": "成功",
     data:{
         "verifyContractList":[{
				"certInfoList":[
					{
						"vtsResult":0,
						"vdsResult":0,
						"signTime":"2021-07-06 16:00:40",
						"signCert":{
							"notAfter":"2021-07-07 08:00:36",
							"issuerDN":"C=CN,O=iTrusChina Co.\\,Ltd.,CN=iTrus Enterprise CA test",
							"certSN":"123123",
							"version":3,
							"notBefore":"2021-07-06 08:00:36",
							"subjectDN":"CN=xxx有限公司,O=xxx有限公司,OU=xxx有限公司",
							"sigAlgName":"SHA256WithRSAEncryption"
						},
						"hashAlg":"SHA256",
						"vcResult":0,
						"timestamp":"2021-07-06 16:00:40"
					}
				],
				"contractId":1412320437984600065,
				"templateId":1412320438513082369
			}
		]
     }
}
```

#### 57.3.2 错误响应

除1之外的响应码,均为失败


### 57.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |

# 五十八、快捷签FastSign（同步）(v4.2.1新增)

### 58.1 接口地址

http://localhost:8080/apigate/contractapi/contract/fastSign

### 58.2 请求参数

#### 58.2.1 请求方法

POST

#### 58.2.2 请求体

| 名称         | 类型         | 约束 | 描述                                                         |
| ------------ | ------------ | ---- | ------------------------------------------------------------ |
| code         | String       | 选填 | 合同编号，如果用户没有传递系统会自动生成合同编号。合同编号不能重复（1-64字符） |
| name         | String       | 选填 | 合同名称 1-64字符，支持中文、英文大小写，数字、特殊字符，如果业务类型未设置合同名称策略，则合同名称必传；如业务类型已设置合同名称策略，则该参数可以不传，系统自动按照业务类型设置的合同名称策略生成合同名称； |
| docName      | String       | 必填 | 合同文档名称1-64字符，支持中文、英文大小写，数字、特殊字符必填 |
| base64       | String       | 选填 | 合同文件base64，最大不超过5MB，支持pdf/doc/docx文件格式(base64与filePath二选一必填) |
| filePath     | String       | 选填 | 文件绝对路径（带文件名）(base64与filePath二选一必填)         |
| bizCode      | String       | 选填 | 业务分类                                                     |
| creator      | String       | 必填 | 创建人（发起用户id）（创建人必须实名，并且加入到此企业）     |
| enterpriseId | String       | 必填 | 发起方企业id                                                 |
| finishSign   | Boolean      | 选填 | 是否将合同置为已完成签署状态，默认true                       |
| signers      | FastSigner[] | 选填 | 签署人集合                                                   |
| lastFileType | Integer      | 选填 | 合同终版文件类型：1PDF（默认）,2OFD；当该参数未传时，取业务类型中设置的合同终版文件类型，若业务类型中也未设置，则取系统默认设置（PDF）类型。<span style="color:#00ff00">(v4.7.0.0新增)</span> |

FastSigner签署人结构

| 名称                | 类型               | 约束 | 描述                                                         |
| ------------------- | ------------------ | ---- | ------------------------------------------------------------ |
| signerType          | Integer            | 必填 | 签署人类型：1个人、2企业                                     |
| userId              | String             | 必填 | 签署人用户id，签署人可以未实名                               |
| enterpriseId        | String             | 可填 | 签署人公司ID（当签署人类型为企业时，必填）                   |
| xySignControls      | XYControl[]        | 可填 | 坐标轴控件                                                   |
| keywordSignControls | KeywordControl[]   | 可填 | 关键字控件                                                   |
| crossSignControls   | CrossControl[]     | 可填 | 骑缝章控件                                                   |
| signControl         | Map<String,String> | 必填 | 签署控件，控件对应的ID、对应的value值<br/>map的key支持sealId和base64 详见请求示例<br><font color=red>OFD不支持base64</font> |
| fonts               | TextControlsFont[] | 可填 | 文本控件字体属性                                             |

关键字签署控件KeywordControl：（$\color{#FF0000}{接口UKey签不支持该控件}$）

| 名称    | 类型    | 约束 | 描述                                                         |
| ------- | ------- | ---- | ------------------------------------------------------------ |
| id      | Integer | 必填 | 控件id，不可重复                                             |
| type    | String  | 必填 | 控件类型                                                     |
| pageNum | String  | 必填 | 多页签时为必填项 指定盖章页， 0：所有页盖章 -1：最后一页，支持：1，2，3，4，5，-1 |
| keyword | String  | 必填 | 关键字（一个签署方只支持一个关键字）                         |
| offsetX | Float   | 可填 | 关键字偏移横坐标x，原点印章默认位置，浮点数，0-21 单位cm     |
| offsetY | Float   | 可填 | 关键字偏移纵坐标y，原点印章默认位置，浮点数，0-29.7 单位cm   |
| width   | Float   | 可填 | 控件宽（单位：cm），印章、图片控件，可不填，默认为图片的宽度 |
| height  | Float   | 可填 | 控件高（单位：cm），印章、图片控件，可不填，默认为图片的高度 |

坐标轴签署控件XYControl：

| 名称    | 类型    | 约束 | 描述                                                         |
| ------- | ------- | ---- | ------------------------------------------------------------ |
| id      | Integer | 必填 | 控件id，不可重复                                             |
| type    | String  | 必填 | 控件类型                                                     |
| pageNum | String  | 必填 | 多页签时为必填项 指定盖章页， 0：所有页盖章 -1：最后一页，支持：1，2，3，4，5，-1 |
| x       | Float   | 必填 | 横坐标x，原点为左上角，浮点数，0-1，PDF位置比例              |
| y       | Float   | 必填 | 纵坐标y，原点为左上角，浮点数，0-1，PDF位置比例              |
| width   | Float   | 可填 | 控件宽（单位：cm），印章、图片控件，可不填，默认为图片的宽度 |
| height  | Float   | 可填 | 控件高（单位：cm），印章、图片控件，可不填，默认为图片的高度 |

骑缝签署控件CrossControl：（$\color{#FF0000}{接口UKey签不支持该控件}$）

| 名称    | 类型    | 约束 | 描述                                                         |
| ------- | ------- | ---- | ------------------------------------------------------------ |
| id      | Integer | 必填 | 控件id，不可重复                                             |
| pageNum | String  | 必填 | 多页签时为必填项 指定盖章页， 0：所有页盖章 -1：最后一页，支持：1，2，3，4，5，-1 |
| y       | Float   | 必填 | 纵坐标y，印章左上角距离文档上边缘的距离（cm），<br />默认印章垂直居中 |
| width   | Float   | 可填 | 控件宽（单位：cm），默认为图片的宽度                         |
| height  | Float   | 可填 | 控件高（单位：cm），默认为图片的高度                         |

TextControlsFont文本控件字体属性

| 名称       | 类型    | 约束 | 描述                                  |
| ---------- | ------- | ---- | ------------------------------------- |
| controlsId | Integer | 必填 | 文本控件id                            |
| fontType   | Integer | 可填 | 字体类型：1宋体、2楷体、3黑体         |
| fontSize   | Float   | 可填 | 字体大小                              |
| fontColor  | String  | 可填 | 字体颜色，格式：\#FF0000              |
| alignment  | Integer | 可选 | 对齐方式：0左对齐，1居中对其，2右对齐 |

请求实例：

```json
{
    "creator": "L499q27vptjqww",
    "code": "20210713111855559",
    "base64": "base64:***",
    "filePath":"test/合同.pdf",
    "signers": [
        {
            "keywordSignControls": [
                {
                    "sealValType": 2,
                    "type": "text",
                    "pageNum": 1,
                    "width": 2,
                    "id": 2,
                    "keyword": "公司名称：北京汇聚融达网络科技有限公司",
                    "key": "2",
                    "height": 2
                }
            ],
            "sealTimestamp": {
                "allAddTimestamp": true,
                "unitTimestampStyle": {
                    "color": "#272727",
                    "controlsId": 2
                }
            },
            "userId": "L49bps56prn08x",
            "signControl": {
                "1": "sealId:1414426562680213506",
                "2": "哈哈哈",
                "3": "base64:aaaa"
            },
            "showTimestamp": true,
            "signerType": 1,
            "xySignControls": [
                {
                    "type": "autograph",
                    "pageNum": 1,
                    "x": 0.5,
                    "y": 0.5,
                    "id": 1,
                    "key": "1"
                }
            ]
        },
        {
            "keywordSignControls": [
                {
                    "sealValType": 2,
                    "type": "signet",
                    "pageNum": 1,
                    "id": 2,
                    "keyword": "合同编号：14266579184473407",
                    "key": "2"
                }
            ],
            "crossSignControls": [
                {
                    "sealValType": 1,
                    "y": 20,
                    "id": 3,
                    "key": "3"
                }
            ],
            "userId": "L499q27vptjqww",
            "signControl": {
                "1": "sealId:1412686996298067970",
                "2": "base64:***",
                "3": "sealId:1412686996298067970"
            },
            "signerType": 2,
            "xySignControls": [
                {
                    "type": "signet",
                    "pageNum": 1,
                    "x": 0.8,
                    "y": 0.8,
                    "id": 1,
                    "key": "1"
                }
            ],
            "enterpriseId": "L4902s"
        }
    ],
    "docName": "base64:***",
    "name": "123.pdf",
    "enterpriseId": "L4902s",
    "finishSign":false
}
```

### 58.3 返回结果

#### 58.3.1 正确响应

| 名称         | 类型     | 描述                                                         |
| ------------ | -------- | ------------------------------------------------------------ |
| code         | String   | 合同编号                                                     |
| contractId   | Long     | 合同id                                                       |
| contractName | String   | 合同主题                                                     |
| status       | int      | 合同状态:0草稿、1.待签署，2.签署中，3.已完成，4.已过期，5.已解约，6.已拒签 |
| signers      | Signer[] | 合同签署人                                                   |
| lastSignTime | date     | 最后签署时间                                                 |

Signer签署人结构

| 名称       | 类型       | 描述                                                         |
| ---------- | ---------- | ------------------------------------------------------------ |
| userId     | String     | 签署人用户id                                                 |
| userName   | String     | 合同签署人姓名                                               |
| signStatus | Integer    | 合同签署人签署状态：1.待他人签署，2 待我签（.签署中），3.已签署，5.已解约，6.已拒签 |
| docList    | Document[] | 合同文档                                                     |

Document合同文档体结构

| 名称    | 类型   | 描述         |
| ------- | ------ | ------------ |
| docId   | Long   | 合同文档Id   |
| docName | String | 合同文档名称 |

返回实例：

```json
{
    "status": 1,
    "data":{
        "code": "1020200620701056856",
        "contractId": 13000001,
        "contractName": "汽车购买交易合同",
        "status": 1,
        "lastSignTime": "2020-06-22",
        "signers": [
            {
                "userId": "1100",
                "userName": "张三",
                "signStatus": 1,
                "docList": [
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    },
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    }
                ]
            }]
    },
    "message": "成功"
}

```

# 五十九、签名列表(v4.2.1新增)

### 59.1 接口地址

http://localhost:8080/apigate/contractapi/stamp/stampList

### 59.2 请求参数

#### 59.2.1 请求方法

POST

#### 59.2.2 请求体

| 名称           | 类型    | 约束 | 描述                   |
| -------------- | ------- | ---- | ---------------------- |
| userId         | String  | 必填 | 用户id                 |
| id             | Long    | 选填 | 签名id                 |
| name           | String  | 选填 | 签名名称               |
| requiredBase64 | Boolean | 选填 | 是否返回签名文件Base64 |

请求实例：

```json
{
    "userId": "L49bus1zl334ed",
    "name": "a",
    "id": 123,
    "requiredBase64": true
}
```

### 59.3 返回结果

| 名称        | 类型    | 描述       |
| ----------- | ------- | ---------- |
| pageNumber  | Number  | 页码       |
| pageSize    | Number  | 每页记录数 |
| totalPage   | Number  | 总页数     |
| totalRecord | Number  | 总数       |
| list        | stamp[] | 签名list   |

stamp : 

| 名称       | 类型      | 描述                                 |
| ---------- | --------- | ------------------------------------ |
| id         | Long      | 签名id                               |
| name       | String    | 签名名称                             |
| defaulted  | Boolean   | 是否默认印章                         |
| createTime | String    | 创建时间：格式=”yyyy-MM-dd HH:mm:ss“ |
| stampFile  | StampFile | 签名文件                             |

StampFile: 

| 名称      | 类型   | 描述       |
| --------- | ------ | ---------- |
| fileName  | String | 文件名称   |
| fileBytes | String | 文件Base64 |

#### 59.3.1返回实例：

```json
{
    "status": 1,
    "message": "请求成功",
    "data": {
        "pageNumber": 1,
        "totalPage": 1,
        "pageSize": 50,
        "list": [
            {
                "stampFile": {
                    "fileName": "64318b3ed60e44d2af79fdf11af0eded.png",
                    "fileBytes": "Base64..."
                },
                "createTime": "2021-07-23 10:15:16",
                "defaulted": true,
                "name": "涂勤霞",
                "id": "1418394250674831361"
            }
        ],
        "totalRecord": 1
    }
}
```



# 六十、印章列表(v4.2.1新增)

### 60.1 接口地址

http://localhost:8080/apigate/contractapi/seal/sealList

### 60.2 请求参数

#### 60.2.1 请求方法

POST

#### 60.2.2 请求体

| 名称               | 类型    | 约束 | 描述                   |
| ------------------ | ------- | ---- | ---------------------- |
| enterpriseId       | String  | 必填 | 用户id                 |
| id                 | Long    | 选填 | 印章id                 |
| name               | String  | 选填 | 印章名称               |
| requiredBase64     | Boolean | 选填 | 是否返回印章文件Base64 |
| requiredAuthorizer | Boolean | 选填 | 是否需要返回授权人     |

请求实例：

```json
{
    "name": "1",
    "enterpriseId": "L4902s",
    "id": 123,
    "requiredBase64": true,
    "requiredAuthorizer": true
}
```

### 60.3 返回结果

| 名称        | 类型    | 描述       |
| ----------- | ------- | ---------- |
| pageNumber  | Number  | 页码       |
| pageSize    | Number  | 每页记录数 |
| totalPage   | Number  | 总页数     |
| totalRecord | Number  | 总数       |
| list        | stamp[] | 签名list   |

stamp : 

| 名称         | 类型         | 描述                                 |
| ------------ | ------------ | ------------------------------------ |
| id           | Long         | 签名id                               |
| name         | String       | 签名名称                             |
| defaulted    | Boolean      | 是否默认印章                         |
| createTime   | String       | 创建时间：格式=”yyyy-MM-dd HH:mm:ss“ |
| sealFile     | SealFile     | 印章文件                             |
| valid        | Boolean      | 是否有效                             |
| creator      | String       | 创建者id                             |
| shape        | String       | 印章形状                             |
| authorizer   | Authorizer[] | 印章授权人                           |
| width        | Float        | 印章宽度                             |
| enterpriseId | String       | 企业id                               |

SealFile: 

| 名称      | 类型   | 描述       |
| --------- | ------ | ---------- |
| fileName  | String | 文件名称   |
| fileBytes | String | 文件Base64 |

Authorizer: 

| 名称        | 类型   | 描述         |
| ----------- | ------ | ------------ |
| displayName | String | 授权人姓名   |
| userId      | String | 授权人用户id |

#### 60.3.1返回实例：

```json
{
    "data":{
        "pageNumber":1,
        "totalPage":1,
        "pageSize":50,
        "list":[
            {
                "valid":true,
                "creator":"L499q27vptjqww",
                "shape":"圆章",
                "createTime":"2021-07-07 16:16:41",
                "authorizer":[
                    {
                        "displayName":"孟令乐",
                        "userId":"L499q27vptjqww"
                    },
                    {
                        "displayName":"孟令乐1",
                        "userId":"L02bbnrbck8uf4"
                    }
                ],
                "defaulted":false,
                "name":"123123",
                "width":38,
                "id":"1412686996298067970",
                "enterpriseId":"L4902s",
                "sealFile":{
                    "fileName":"3e2484d3728a41779190c7c3edfcfacb.png",
                    "fileBytes":"base64"
                }
            }
        ],
        "totalRecord":1
    },
    "message":"请求成功",
    "ok":true,
    "status":1
}
```



# 六十一、发送消息通知(v4.2.2新增)

### 61.1 接口地址

http://localhost:8080/apigate/contractapi/message/send

### 61.2 请求参数

#### 61.2.1 请求方法

POST

#### 61.2.2 请求体

| 名称        | 类型               | 约束 | 描述                                                         |
| ----------- | ------------------ | ---- | ------------------------------------------------------------ |
| userId      | String             | 选填 | 用户id                                                       |
| phone       | String             | 选填 | 手机号，当sendMethod方式为1时，userId与phone参数二选一，优先phone; |
| email       | String             | 选填 | 邮箱，当sendMethod方式为2时，userId与email参数二选一，优先email; |
| sendMethod  | Integer            | 选填 | 消息发送方式：1手机短信（默认）、2邮件                       |
| msgType     | Integer            | 必填 | 消息类型：1签署完成消息通知                                  |
| msgTemplate | String             | 必填 | 消息模板编号                                                 |
| params      | Map<String,String> | 选填 | 消息参数集合                                                 |

请求实例：

```json
{
    "userId": "Llsdfg190",
    "phone": "13200010001",
    "sendMethod": 1,
    "msgType": 1,
    "msgTemplate": "code1",
    "msgParams":{
        "param1":"sss",
        "param2":"yyyy"
    }
}
```

### 61.3 返回结果

| 名称    | 类型    | 描述          |
| ------- | ------- | ------------- |
| message | String  | 消息发送成功  |
| status  | Integer | 状态码：1成功 |



#### 61.3.1返回实例：

```json
{
    "status": 1,
    "message": "成功",
}
```



# 六十二、企业打款金额验证(v4.3.2新增)

### 62.1 接口地址

http://localhost:8080/apigate/contractapi/enterprise/verifyPayBank

### 62.2 请求参数

#### 62.2.1 请求方法

POST

#### 62.2.2 请求体

| 名称          | 类型   | 约束 | 描述         |
| ------------- | ------ | ---- | ------------ |
| enterpriseId  | String | 必填 | 企业id       |
| paymentAmount | String | 必填 | 银行打款金额 |

请求实例：

```json
{
    "enterpriseId": "Llsdfg190",
    "paymentAmount": "13200010001"
}
```

### 62.3 返回结果

| 名称    | 类型    | 描述          |
| ------- | ------- | ------------- |
| message | String  | 消息发送成功  |
| status  | Integer | 状态码：1成功 |



#### 62.3.1返回实例：

```json
{
    "status": 1,
    "message": "成功",
}
```

# 六十三、获取银行列表(v4.3.2新增)

### 63.1 接口地址

http://localhost:8080/apigate/contractapi/bankProvince/bankList

### 63.2 请求参数

#### 63.2.1 请求方法

POST

#### 63.2.2 请求体

### 63.3 返回结果

| 名称              | 类型               | 描述             |
| ----------------- | ------------------ | ---------------- |
| bankCodeBankNames | BankCodeBankName[] | 银行编码银行名称 |

BankCodeBankName:

| 名称     | 类型   | 描述     |
| -------- | ------ | -------- |
| bankCode | String | 银行编码 |
| bankName | String | 银行名称 |



#### 63.3.1返回实例：

```json
{
	"code": 0,
	"msg": "请求成功",
	"data": {
		"bankCodeBankNames": [
			{
				"bankCode": "ICBC",
				"bankName": "中国工商银行"
			}
		]
	},
	"message": "请求成功",
	"status": 1
}
```

# 六十四、获取省份列表(v4.3.2新增)

### 64.1 接口地址

http://localhost:8080/apigate/contractapi/bankProvince/provinceList

### 64.2 请求参数

#### 64.2.1 请求方法

POST

#### 64.2.2 请求体

### 64.3 返回结果

| 名称          | 类型           | 描述             |
| ------------- | -------------- | ---------------- |
| bankProvinces | BankProvince[] | 省份编码省份名称 |

BankProvince:

| 名称         | 类型   | 描述     |
| ------------ | ------ | -------- |
| provinceCode | String | 省份编码 |
| provinceName | String | 省份名称 |



#### 64.3.1返回实例：

```json
{
	"code": 0,
	"msg": "请求成功",
	"data": {
		"bankProvinces": [
			{
				"provinceCode": "110",
				"provinceName": "北京市"
			}
		]
	},
	"message": "请求成功",
	"status": 1
}
```

# 六十五、获取城市列表(v4.3.2新增)

### 65.1 接口地址

http://localhost:8080/apigate/contractapi/bankProvince/cityList

### 65.2 请求参数

#### 65.2.1 请求方法

POST

#### 65.2.2 请求体

| 名称         | 类型   | 约束 | 描述     |
| ------------ | ------ | ---- | -------- |
| provinceCode | String | 必填 | 省份编码 |

请求实例：

```json
{
    "provinceCode": "130"
}
```

### 65.3 返回结果

| 名称               | 类型               | 描述 |
| ------------------ | ------------------ | ---- |
| bankProvinceCities | BankProvinceCity[] | 城市 |

BankProvinceCity:

| 名称         | 类型   | 描述     |
| ------------ | ------ | -------- |
| provinceId   | String | 省份编码 |
| provinceName | String | 省份名称 |
| cityCode     | String | 城市编码 |
| cityName     | String | 城市名称 |



#### 65.3.1返回实例：

```json
{
	"code": 0,
	"msg": "请求成功",
	"data": {
		"bankProvinceCities": [
			{
				"provinceId": "130",
				"provinceName": "河北省",
				"cityCode": "1210",
				"cityName": "石家庄市"
			}
		]
	},
	"message": "请求成功",
	"status": 1
}
```

# 六十六、获取支行列表(v4.3.2新增)

### 66.1 接口地址

http://localhost:8080/apigate/contractapi/bankProvince/branchBankList

### 66.2 请求参数

#### 66.2.1 请求方法

POST

#### 66.2.2 请求体

| 名称     | 类型   | 约束 | 描述     |
| -------- | ------ | ---- | -------- |
| cityCode | String | 必填 | 城市编码 |
| bankCode | String | 必填 | 银行代码 |

请求实例：

```json
{
    "cityCode": "1000",
    "bankCode": "ICBC"
}
```

### 66.3 返回结果

| 名称       | 类型        | 描述 |
| ---------- | ----------- | ---- |
| brankBanks | BrankBank[] | 支行 |

BrankBank:

| 名称            | 类型   | 描述        |
| --------------- | ------ | ----------- |
| bankCnaps       | String | 银行cnaps码 |
| bankCode        | String | 银行编码    |
| bankName        | String | 银行名称    |
| channelBankCode | String | 银行简称    |
| cityId          | String | 城市编码    |
| cityName        | String | 城市名称    |
| provinceId      | String | 省份编码    |
| provinceName    | String | 省份名称    |



#### 66.3.1返回实例：

```json
{
	"code": 0,
	"msg": "请求成功",
	"data": {
		"brankBanks": [
			{
				"bankCnaps": "102100000021",
				"bankCode": "102",
				"bankName": "中国工商银行股份有限公司北京通州支行新华分理处",
				"channelBankCode": "ICBC",
				"cityId": "1000",
				"cityName": "北京市",
				"provinceId": "110",
				"provinceName": "北京市"
			}
		]
	},
	"message": "请求成功",
	"status": 1
}
```

# 六十七、合同催签接口(v4.3.2新增)

### 67.1 接口地址

http://localhost:8080/apigate/contractapi/contract/urgeSign

### 67.2 请求参数

#### 67.2.1 请求方法

POST

#### 67.2.2 请求体

| 名称       | 类型 | 约束 | 描述   |
| ---------- | ---- | ---- | ------ |
| contractId | Long | 必填 | 合同id |

请求实例：

{
	"contractId": 13432534545
}

### 67.3 返回结果

| 名称    | 类型    | 描述       |
| ------- | ------- | ---------- |
| status  | Integer | 返回状态码 |
| message | String  | 响应消息   |



#### 67.3.1返回实例：

```json
{
	"message": "请求成功",
	"status": 1
}
```

# 六十八、添加子企业(v4.3.2新增)

### 68.1 接口地址

http://localhost:8080/apigate/contractapi/enterprise/addSubCompany

### 68.2 请求参数

#### 68.2.1 请求方法

POST

#### 68.2.2 请求体

| 名称           | 类型   | 约束 | 描述         |
| -------------- | ------ | ---- | ------------ |
| userId         | String | 必填 | 邀请人用户ID |
| enterpriseId   | String | 选填 | 邀请企业ID   |
| subCompanyUuid | String | 必填 | 受邀企业ID   |

请求实例：

```json
{
    "userId": "L49bus1zl334ed",
    "enterpriseId": "L4902s",
    "subCompanyUuid": "L4902n"
}
```

### 68.3 返回结果

| 名称           | 类型   | 描述       |
| -------------- | ------ | ---------- |
| subCompanyUuid | String | 受邀企业ID |
| enterpriseId   | String | 邀请企业ID |

#### 68.3.1返回实例：

```json
{
    "msg": "请求成功",
    "code": 0,
    "data": {
        "subCompanyUuid": "L4905o",
        "enterpriseId": "L4902s"
    },
    "message": "请求成功",
    "status": 1
}
```

# 六十九、UKEY签获取文件hash(v4.3.3新增)

### 69.1 接口地址

http://localhost:8080/apigate/contractapi/ukeyCert/getSignData

### 69.2 请求参数

#### 69.2.1 请求方法

POST

#### 69.2.2 请求体

| 名称       | 类型   | 约束 | 描述       |
| ---------- | ------ | ---- | ---------- |
| contractId | Long   | 必填 | 合同ID     |
| signer     | Signer | 必填 | 合同签署人 |
| publicKey  | String | 必填 | 公钥       |

Signer合同签署人结构

| 名称          | 类型       | 约束 | 描述                                                         |
| ------------- | ---------- | ---- | ------------------------------------------------------------ |
| signerId      | Long       | 必填 | 签署人id（添加模板合同签署人接口返回）                       |
| isUserWishes  | boolean    | 选填 | 是否要做意愿认证；默认false；<br />false 否 用户自己做意愿认证， <br />true 是 需要天威诚信做意愿认证； |
| userWishesWay | Integer    | 选填 | 意愿认证方式；1 验证码认证方式（默认），2  签署密码认证方式 <br />后续会扩展认证方式；<br />isUserWishes参数为true时必填<br /> |
| codeNumber    | String     | 选填 | 验证码编号  意愿认证方式为验证码认证时必填                   |
| verifyCode    | String     | 选填 | 验证码   意愿认证方式为验证码认证时必填                      |
| signPassword  | String     | 选填 | 签署密码   意愿认证方式为签署密码认证时必填                  |
| signFiles     | SignFile[] | 必填 | 签署文件                                                     |
| remark        | String     | 选填 | 签章备注                                                     |

SignFile签署文件结构

| 名称         | 类型               | 约束 | 描述                                                 |
| ------------ | ------------------ | ---- | ---------------------------------------------------- |
| docId        | Long               | 必填 | 合同文件id                                           |
| signControls | Map<String,String> | 必填 | 签署控件<br/>map的key支持sealId和base64 详见请求示例 |
| fonts        | TextControlsFont[] | 可填 | 文本控件字体属性                                     |

签署签署控件signControls：

| 名称  | 类型   | 约束 | 描述    |
| ----- | ------ | ---- | ------- |
| key   | String | 必填 | 控件key |
| value | String | 必填 | 控件值  |

TextControlsFont文本控件字体属性

| 名称        | 类型    | 约束 | 描述                                  |
| ----------- | ------- | ---- | ------------------------------------- |
| controlsKey | Integer | 必填 | 文本控件key                           |
| fontType    | Integer | 可填 | 字体类型：1宋体 (本期只支持宋体)      |
| fontSize    | Float   | 可填 | 字体大小                              |
| fontColor   | String  | 可填 | 字体颜色，格式：\#FF0000              |
| alignment   | Integer | 可填 | 对齐方式：0左对齐，1居中对其，2右对齐 |

请求实例：

```json
{
    "contractId": 13000001,
    "signer": {
        "signerId": 1001,
        "isUserWishes": 0,
        "userWishesWay": 1,
        "codeNumber": "1004",
        "verifyCode": "13006",
        "signFiles": [
            {
                "docId": 2235365,
                "signControls": {
                    "甲方签章": "base64:45645657",
                    "测试": "sealId:123123"
                    "租金": "100"
                },
                "fonts": [
                    {
                        "controlsKey": "文本1",
                        "fontType": 1,
                        "fontSize": 8.5,
                        "fontColor": "#56600F",
                        "alignment": 1
                    }
                ]
            }
        ]
    }
}
```

### 69.3 返回结果

#### 69.3.1 正确响应

| 名称         | 类型           | 描述           |
| ------------ | -------------- | -------------- |
| ukeyHashList | UkeyHashList[] | 需要签署的hash |

UkeyHashList签署人结构

| 名称     | 类型     | 描述         |
| -------- | -------- | ------------ |
| docId    | String   | 文档id       |
| ukeyHash | UkeyHash | ukeyHash对象 |

UkeyHash签署人结构

| 名称 | 类型   | 描述           |
| ---- | ------ | -------------- |
| hash | String | 带签名域的hash |

返回实例：

```json
{
    "status": 1,
    "data":{
        "ukeyHashList":[
            {
                "docId":"123123",
                "ukeyHash":{
                    "hash":"123",
                    "intermediateData":"1232"
                }
            },{
                "docId":"1232222123",
                "ukeyHash":{
                    "hash":"123"
                }
            }
        ]
    },
    "message": "成功"
}

```

#### 69.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 69.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |

# 七十、UKEY签合同文件合成(v4.3.3新增)

### 70.1 接口地址

http://localhost:8080/apigate/contractapi/ukeyCert/signByUkey

### 70.2 请求参数

#### 70.2.1 请求方法

POST

#### 70.2.2 请求体

| 名称         | 类型           | 约束 | 描述             |
| ------------ | -------------- | ---- | ---------------- |
| contractId   | Long           | 必填 | 合同ID           |
| signerId     | Long           | 必填 | 签署人Id         |
| ukeyHashList | UkeyHashList[] | 必填 | 签署完成后的hash |

UkeyHashList签署人结构

| 名称     | 类型     | 描述         |
| -------- | -------- | ------------ |
| docId    | String   | 文档id       |
| ukeyHash | UkeyHash | ukeyHash对象 |

UkeyHash签署人结构

| 名称       | 类型   | 描述               |
| ---------- | ------ | ------------------ |
| hash       | String | 带签名域的hash     |
| signedHash | String | 签署完成的hash数据 |

请求实例：

```json
{
    "contractId":123L,
    "signerId":123L,
    "ukeyHashList":[
        {
            "docId":"123123",
            "ukeyHash":{
                "hash":"123",
                "intermediateData":"1232"
            }
        },{
            "docId":"1232222123",
            "ukeyHash":{
                "hash":"123",
                "signedHash":"1232"
            }
        }
    ]
}
```

### 70.3 返回结果

#### 70.3.1 正确响应

| 名称         | 类型       | 描述                                                         |
| ------------ | ---------- | ------------------------------------------------------------ |
| code         | String     | 合同编号                                                     |
| contractId   | Long       | 合同id                                                       |
| contractName | String     | 合同主题                                                     |
| status       | int        | 合同状态:0草稿、1.待签署，2.签署中，3.已完成，4.已过期，5.已解约，6.已拒签 |
| signers      | Signer[]   | 合同签署人                                                   |
| lastSignTime | date       | 最后签署时间                                                 |
| documents    | Document[] | 全部合同文件                                                 |

Signer签署人结构

| 名称       | 类型       | 描述                                                         |
| ---------- | ---------- | ------------------------------------------------------------ |
| userId     | String     | 签署人用户id                                                 |
| userName   | String     | 合同签署人姓名                                               |
| signStatus | Integer    | 合同签署人签署状态:1.待他人签署，2 待我签（.签署中），3.已签署，5.已解约，6.已拒签 |
| docList    | Document[] | 合同文档                                                     |

Document文档体结构

| 名称    | 类型   | 描述         |
| ------- | ------ | ------------ |
| docId   | Long   | 合同文件Id   |
| docName | String | 合同文件名称 |

返回实例：

```json
{
	"data":{
		"signers":[
			{
				"signerId":1427501237070725122,
				"docList":[
					{
						"docName":"测试文档名1",
						"docId":1427500840251817986
					},
					{
						"docName":"测试文档名2",
						"docId":1427500840314732545
					}
				],
				"signStatus":3,
				"userName":"userName",
				"userId":"L499q27vptjqww"
			},
			{
				"signerId":1427501237267857410,
				"docList":[
					{
						"docName":"测试文档名1",
						"docId":1427500840251817986
					},
					{
						"docName":"测试文档名2",
						"docId":1427500840314732545
					}
				],
				"signStatus":3,
				"enterpriseId":"L4902s",
				"userName":"userName",
				"userId":"L02bbnrbck8uf4"
			}
		],
		"lastSignTime":"2021-08-17 14:19:18",
		"code":"20201104000011145",
		"documents":[
			{
				"docName":"测试文档名2",
				"docId":1427500840314732545
			},
			{
				"docName":"测试文档名1",
				"docId":1427500840251817986
			}
		],
		"contractId":1427500840188903425,
		"contractName":"劳动合同1104000011145",
		"enterpriseId":"L4902s",
		"status":3
	},
	"message":"请求成功",
	"ok":true,
	"status":1
}

```

#### 70.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 70.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |

# 七十一、证书查询接口(v4.5.0新增)

### 71.1 接口地址

http://localhost:8080/apigate/contractapi/cert/query

### 71.2 请求参数

#### 71.2.1 请求方法

POST

#### 71.2.2 请求体

| 名称         | 类型    | 约束 | 描述                                               |
| ------------ | ------- | ---- | -------------------------------------------------- |
| userId       | String  | 选填 | 用户id                                             |
| enterpriseId | String  | 选填 | 企业id                                             |
| certType     | Integer | 选填 | 证书类型：1服务端证书、2客户端证书，不传查全部证书 |

用户id、企业id参数二选一

请求实例：

```json
{
    "userId":"dbsdf2345",
    "enterpriseId":"dbsdf2345"
}
```

### 71.3 返回结果

#### 71.3.1 正确响应

| 名称     | 类型       | 描述     |
| -------- | ---------- | -------- |
| certData | CertInfo[] | 证书数据 |

certInfo证书信息数据结构体

| 名称          | 类型    | 描述                                        |
| ------------- | ------- | ------------------------------------------- |
| certId        | Long    | 证书ID                                      |
| certType      | Integer | 证书类型：1服务端证书、2客户端证书          |
| certSn        | String  | 证书序列号                                  |
| certBuf       | String  | 证书Base64编码                              |
| issuer        | String  | 证书签发者                                  |
| subject       | String  | 证书主题                                    |
| notBefore     | String  | 证书生效时间，日期格式：yyyy-MM-dd HH:mm:ss |
| notAfter      | String  | 证书过期时间，日期格式：yyyy-MM-dd HH:mm:ss |
| privateKeyAlg | String  | 密钥算法                                    |
| status        | Long    | 证书状态 1:有效，2:无效                     |



返回实例：

```json
{
	"data":{
		"certData":[
			{
                "certId": 598559138802176161,
                "certSn": "45369AEA2F491D0F6FC14895FCEFEDFF8B09E12B",
                "certBuf": "MIICDzCCAbSgAwIBAgIURTaa6i9JHQ9vwUiV/O/t...",
                "certChain": "MIIHgQYJKoZIhvcNAQcCoIIHcjCCB24CAQE...",
                "issuer": "C=CN, O=天威诚信, OU=研发中心, CN=SM2颁发者",
                "subject": "C=CN, O=天威诚信, OU=研发中心, CN=SM2子证书",
                "notAfter": "2019-08-12 09:41:00",
                "notBefore": "2020-08-11 09:41:00",
                "privateKeyAlg": "SM2",
                "status": 1
            }
        ]
	},
	"message":"请求成功",
	"ok":true,
	"status":1
}

```

#### 71.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 71.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |



# 七十二、印章临时授权接口(v4.7.0新增)

### 72.1 接口地址

http://localhost:8080/apigate/contractapi/seal/tempAuth

### 72.2 请求参数

#### 72.2.1 请求方法

POST

#### 72.2.2 请求体

| 名称               | 类型                | 约束 | 描述                                                         |
| ------------------ | ------------------- | ---- | ------------------------------------------------------------ |
| contract_id        | Long                | 选填 | 授权合同id，不填授权所有合同                                 |
| sealIds            | Long[]              | 选填 | 印章id集合                                                   |
| sealBase64Map      | Map<String, String> | 选填 | 印章图片base64集合key/value，key为图片标识，value为图片base64；与印章id集合至少必须传一项，不能都为空 |
| toAuthUserId       | String              | 必填 | 被授权人用户id                                               |
| toAuthEnterpriseId | String              | 必填 | 被授权人所属企业id                                           |
| authUserId         | String              | 必填 | 授权人用户id                                                 |
| authEnterpriseId   | String              | 必填 | 授权人所属企业id                                             |
| expireTime         | String              | 选填 | 授权过期时间，格式（2021-11-25 10:00:00），不填默认授权后1小时过期 |

印章id、印章图片base64参数至少必须传一项

请求实例：

```json
{
    "contractId": 1438404874288939009,
    "sealIds": [
        598559138802176161,
        598559138802176162,
        5985591388021761613
    ],
    "sealBase64Map": {
        "pic1": "MIICDzCCAbSgAHQ9vwUiV/O/t...",
        "pic2": "MIICDzCCAbSgAwIBAg9vwUiV/O/t..."
    },
    "toAuthUserId": "dbsdf2345",
    "toAuthEnterpriseId": "dbsdf2345",
    "authUserId": "dbsdf23434",
    "authEnterpriseId": "dbsdf23434eweetr",
    "expireTime": "2021-11-26 10:00:00"
}
```

### 72.3 返回结果

#### 72.3.1 正确响应

| 名称               | 类型              | 描述                                                         |
| ------------------ | ----------------- | ------------------------------------------------------------ |
| toAuthUserId       | String            | 被授权人id                                                   |
| toAuthEnterpriseId | String            | 被授权人所属企业id                                           |
| sealIds            | Long[]            | 授权印章id集合                                               |
| base64FileIdMap    | Map<String, Long> | 授权base64图片文件id集合，key为图片标识，value为base64图片文件id； |
| expireTime         | String            | 授权过期时间，格式（2021-11-25 10:00:00），不填默认授权后1小时过期 |



返回实例：

```json
{
    "data": {
        "toAuthUserId": "dbsdf2345",
        "toAuthEnterpriseId": "dbsdf2345rtett",
        "sealIds": [
            598559138802176161,
            598559138802176162,
            5985591388021761613
        ],
        "base64FileIdMap": {
            "pic1": 598559138802176161,
            "pic2": 598559138802176162
        },
        "expireTime": "2021-11-26 10:00:00"
    },
    "message": "请求成功",
    "ok": true,
    "status": 1
}

```

#### 72.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 72.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |

# 七十三、OFD印章获取待签署hash(v4.7.0新增)

### 73.1 接口地址

http://localhost:8080/apigate/contractapi/ofdUkey/getOfdSealHash

### 73.2 请求参数

#### 73.2.1 请求方法

POST

#### 73.2.2 请求体

| 名称          | 类型    | 约束 | 描述                   |
| ------------- | ------- | ---- | ---------------------- |
| signatureId   | Long    | 必填 | 签章id                 |
| signatureType | Integer | 必填 | 签章类型 1 个人 2 企业 |
| certBase64    | String  | 必填 | 公钥证书的base64       |
| userId        | String  | 必填 | 用户id                 |
| enterpriseId  | String  | 选填 | 企业id                 |

请求实例：

```json
{
    "signatureId": 1438404874288939009,
    "signatureType": 2,
    "certBase64": "MIICDzCCAbSgAHQ9vwUiV",
    "userId": "dbsdf2345",
    "enterpriseId": "dbsdf2345"
}
```

### 73.3 返回结果

#### 73.3.1 正确响应

| 名称        | 类型    | 描述                                                         |
| ----------- | ------- | ------------------------------------------------------------ |
| status      | Integer | 状态<br>0 系统中存在此印章的ofd文件无需重新生成  <br>1 需要生成ofd签章同时会返回印章的hash需要使用ukey对此hash进行签名 |
| hash        | String  | 印章的hash                                                   |
| signatureId | Long    | 签章id                                                       |



返回实例：

```json
{
    "data": {
        "status": 0,
        "hash": "dbsdf2345rtett",
        "signatureId": 1438404874288939009
    },
    "message": "请求成功",
    "ok": true,
    "status": 1
}

```

#### 73.3.2 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 73.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |

# 七十四、OFD印章合成(v4.7.0新增)

### 74.1 接口地址

http://localhost:8080/apigate/contractapi/ofdUkey/buildOfdSeal

### 74.2 请求参数

#### 74.2.1 请求方法

POST

#### 74.2.2 请求体

| 名称        | 类型   | 约束 | 描述           |
| ----------- | ------ | ---- | -------------- |
| signatureId | Long   | 必填 | 签章id         |
| signedHash  | String | 必填 | 签署完成的hash |

请求实例：

```json
{
    "signatureId": 1438404874288939009,
    "signedHash": "MIICDzCCAbSgAHQ9vwUiV"
}
```

返回实例：

```json
{
    "data": {},
    "message": "请求成功",
    "ok": true,
    "status": 1
}

```

### 74.3 错误响应

```json
{
    "status": {错误响应码},
    "data": {  
        "{参数名}": "{参数错误消息}",
        ...
    },
    "message": "{错误响应描述}"
}
```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 74.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |

# 七十五、OFD合同获取待签名hash(v4.7.0新增)

### 75.1 接口地址

http://localhost:8080/apigate/contractapi/ofdUkey/getOfdContractHash

### 75.2 请求参数

#### 75.2.1 请求方法

POST

#### 75.2.2 请求体

| 名称        | 类型                  | 约束 | 描述               |
| ----------- | --------------------- | ---- | ------------------ |
| signatureId | Long                  | 必填 | 签章id             |
| certBase64  | String                | 必填 | 公钥证书的base64   |
| contractId  | Long                  | 必填 | 合同id             |
| signerId    | Long                  | 必填 | 签署人id           |
| signFiles   | OfdSignContractFile[] | 必填 | 签署人合同文件参数 |

OfdSignContractFile签署人合同文件参数数据结构体

| 名称        | 类型        | 约束 | 描述          |
| ----------- | ----------- | ---- | ------------- |
| docId       | Long        | 必填 | 文档id        |
| controlsKey | Set<String> | 必填 | 控件key的集合 |

请求实例：

```json
{
    "signatureId": 1438404874288939009,
    "certBase64": "MIICDzCCAbSgAHQ9vwUiV",
    "contractId": 1438404874288939009,
    "signerId": 1438404874288939009,
    signFiles:[
        {
            "docId":1438404874288939009,
            "controlsKey": ["1","2","3"]
        }
    ]
}
```

### 75.3 返回结果

#### 75.3.1 正确响应

| 名称         | 类型                 | 描述               |
| ------------ | -------------------- | ------------------ |
| ukeyHashList | UkeySignResponseVO[] | 需要签署的文件hash |

UkeySignResponseVO数据结构体

| 名称     | 类型            | 描述       |
| -------- | --------------- | ---------- |
| docId    | String          | 文档id     |
| ukeyHash | UkeySignHashDTO | 印章的hash |

UkeySignHashDTO数据结构体

| 名称 | 类型   | 描述         |
| ---- | ------ | ------------ |
| hash | String | 待签署的hash |

# 七十六、OFD合同合成(v4.7.0新增)

### 76.1 接口地址

http://localhost:8080/apigate/contractapi/ofdUkey/buildOfdContract

### 76.2 请求参数

#### 76.2.1 请求方法

POST

#### 76.2.2 请求体

| 名称         | 类型                  | 约束 | 描述               |
| ------------ | --------------------- | ---- | ------------------ |
| contractId   | Long                  | 必填 | 合同id             |
| signerId     | Long                  | 必填 | 签署人id           |
| ukeyHashList | OfdSignContractFile[] | 必填 | 签署人合同文件参数 |

UkeySignResponseVO数据结构体

| 名称     | 类型            | 约束 | 描述       |
| -------- | --------------- | ---- | ---------- |
| docId    | String          | 必填 | 文档id     |
| ukeyHash | UkeySignHashDTO | 必填 | 印章的hash |

UkeySignHashDTO数据结构体

| 名称       | 类型   | 约束 | 描述               |
| ---------- | ------ | ---- | ------------------ |
| hash       | String | 必填 | 待签署的hash       |
| signedHash | String | 必填 | 签署完成的hash数据 |

请求实例：

```json
{
    "contractId": 1438404874288939009,
    "signerId": 1438404874288939009,
    "ukeyHashList":[
        {
            "docId":"1438404874288939009",
            "ukeyHash": {
                "hash":"asdsadasd",
                "signedHash":"asdsadasd"
            }
        }
    ]
}
```

### 76.3 返回结果

#### 76.3.1 正确响应

| 名称         | 类型       | 描述                                                         |
| ------------ | ---------- | ------------------------------------------------------------ |
| code         | String     | 合同编号                                                     |
| contractId   | Long       | 合同id                                                       |
| contractName | String     | 合同主题                                                     |
| status       | int        | 合同状态:0草稿、1.待签署，2.签署中，3.已完成，4.已过期，5.已解约，6.已拒签 |
| signers      | Signer[]   | 合同签署人                                                   |
| lastSignTime | date       | 最后签署时间                                                 |
| documents    | Document[] | 全部合同文件                                                 |

Signer签署人结构

| 名称       | 类型       | 描述                                                         |
| ---------- | ---------- | ------------------------------------------------------------ |
| userId     | String     | 签署人用户id                                                 |
| userName   | String     | 合同签署人姓名                                               |
| signStatus | Integer    | 合同签署人签署状态:1.待他人签署，2 待我签（.签署中），3.已签署，5.已解约，6.已拒签 |
| docList    | Document[] | 合同文档                                                     |

Document文档体结构

| 名称    | 类型   | 描述         |
| ------- | ------ | ------------ |
| docId   | Long   | 合同文件Id   |
| docName | String | 合同文件名称 |

返回实例：

```json
{
    "status": 1,
    "data":{
        "code": "1020200620701056856",
        "contractId": 13000001,
        "contractName": "汽车购买交易合同",
        "status": 1,
        "lastSignTime": "2020-06-22",
        "documents": [
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    },
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    }
                ],
        "signers": [
            {
                "userId": "1100",
                "userName": "张三",
                "signStatus": 1,
                "docList": [
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    },
                    {
                        "docId": 11000001,
                        "docName":"汽车购买贷款协议"
                    }
                ]
            }]
    },
    "message": "成功"
}

```

#### 76.3.2 错误响应

除1之外的响应码,均为失败

返回实例：

```json
{
    "data": {
        "ukeyHashList":[
            {
                "docId":1438404874288939009,
                "ukeyHash":{
                    "hash":"MIICDzCCAbSgAHQ9vwUiV"
                }
            }
        ]
    },
    "message": "请求成功",
    "ok": true,
    "status": 1
}

```

注：当返回 <b>1000</b> 错误码时，data会携带具体参数和不为空的描述

### 76.4 响应码

| 编号 | 描述 |
| ---- | ---- |
| 1    | 成功 |
| 其他 | 失败 |



# 附录

###  证件类型

| 名称                   | 证件类型   | 类型   | 值   |
| ---------------------- | ---------- | ------ | ---- |
| 居民身份证             | 个人       | String | 0    |
| 护照                   | 个人       | String | 1    |
| 军人身份证             | 个人       | String | 2    |
| 港澳居民往来内地通行证 | 个人       | String | B    |
| 台湾居民来往大陆通行证 | 个人       | String | C    |
| 社会统一信用代码       | 企业       | String | N    |
| 组织机构代码证         | 企业       | String | 7    |
| 其他                   | 企业、个人 | String | Z    |

###  控件类型

| 类型值    | 名称                                                         | 控件值     |
| --------- | ------------------------------------------------------------ | ---------- |
| text      | 文本类型， value为要填写的文本内容，一般用于填写合同的变化内容，如金额，联系电话等。 | 纯文本     |
| autograph | 签名类型，个人控件                                           | 签名ID     |
| signet    | 印章类型，企业控件                                           | 印章ID     |
| date      | 日期类型，非必传， 系统会取当前系统时间来填写，传值的话，value为空即可。 | 系统日期   |
| pic       | 图片类型                                                     | 图片base64 |

企业用户支持：印章、日期、文本、图片

个人用户支持：签名、日期、文本、图片

###  网关统一错误码

| 编号   | 描述                                 |
| ------ | ------------------------------------ |
| 100002 | 提交的参数信息不完整                 |
| 100004 | 应用ip受限                           |
| 100004 | 没有此服务权限                       |
| 100004 | 没有此服务权限,product               |
| 100004 | 没有此服务权限,appserver             |
| 100005 | 服务密钥错误                         |
| 100006 | Hmac验证错误                         |
| 100008 | 接口调用异常                         |
| 100009 | 缺少服务配置                         |
| 100010 | 应用标识不存在                       |
| 100011 | 应用状态已关闭                       |
| 100012 | 此服务还未开始                       |
| 100015 | 您的服务已过期，请重新购买服务       |
| 100016 | 数量不足，请重新购买服务             |
| 100017 | 您当前服务不可用，如有问题请联系客服 |
| 100018 | 重复太多次没有得到处理               |
| 100019 | 访问超时，请重试                     |
| 100020 | appid或signature不能为空             |
| 100021 | 计费规则加载失败                     |
| 100022 | 此接口未找到                         |
| 100024 | 此服务未发布                         |
| 120001 | 主中心接口调用异常                   |
| 120002 | 从中心参数错误,cloudId,signature     |
| 120003 | 从中心签名验证失败                   |

